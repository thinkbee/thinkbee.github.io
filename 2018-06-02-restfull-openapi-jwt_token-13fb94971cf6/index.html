<!doctype html>
<html lang="ko"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Open API Web Token - IT Tech blogging</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="thinkbee blog"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="thinkbee blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Open api keyAPI keys는 사용자 인증, 요청 API 호출을 위해 필요하다. 보통 RESTFull API 호출시 API keys 와 인증 스킴을 사용한다. 주요 차이는:  API keys : 앱 혹은 사이트 호출을 식별해서 API 호출을 만다. Auth tokens : 앱 혹은 사이트 사용자를 식별한다."><meta property="og:type" content="article"><meta property="og:title" content="Open API Web Token"><meta property="og:url" content="https://thinkbee.github.io/2018-06-02-restfull-openapi-jwt_token-13fb94971cf6/"><meta property="og:site_name" content="IT Tech blogging"><meta property="og:description" content="Open api keyAPI keys는 사용자 인증, 요청 API 호출을 위해 필요하다. 보통 RESTFull API 호출시 API keys 와 인증 스킴을 사용한다. 주요 차이는:  API keys : 앱 혹은 사이트 호출을 식별해서 API 호출을 만다. Auth tokens : 앱 혹은 사이트 사용자를 식별한다."><meta property="og:locale" content="ko_KR"><meta property="og:image" content="https://thinkbee.github.io/images/nodejs/auth-jwt-signup-postman.png"><meta property="og:image" content="https://thinkbee.github.io/images/nodejs/auth-jwt-signup-db.png"><meta property="og:image" content="https://thinkbee.github.io/images/nodejs/auth-jwt-signin-postman.png"><meta property="article:published_time" content="2018-06-02T00:00:00.000Z"><meta property="article:modified_time" content="2023-01-13T16:53:06.000Z"><meta property="article:author" content="Gangtai Goh"><meta property="article:tag" content="nodejs"><meta property="article:tag" content="웹토큰"><meta property="article:tag" content="JWT Toekn"><meta property="article:tag" content="JSON Web Token"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://thinkbee.github.io/images/nodejs/auth-jwt-signup-postman.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://thinkbee.github.io/2018-06-02-restfull-openapi-jwt_token-13fb94971cf6/"},"headline":"Open API Web Token","image":["https://thinkbee.github.io/images/nodejs/auth-jwt-signup-postman.png","https://thinkbee.github.io/images/nodejs/auth-jwt-signup-db.png","https://thinkbee.github.io/images/nodejs/auth-jwt-signin-postman.png"],"datePublished":"2018-06-02T00:00:00.000Z","dateModified":"2023-01-13T16:53:06.000Z","author":{"@type":"Person","name":"Gangtai Goh"},"publisher":{"@type":"Organization","name":"IT Tech blogging","logo":{"@type":"ImageObject","url":"https://thinkbee.github.io/images/thinkbee_logo.png"}},"description":"Open api keyAPI keys는 사용자 인증, 요청 API 호출을 위해 필요하다. 보통 RESTFull API 호출시 API keys 와 인증 스킴을 사용한다. 주요 차이는:  API keys : 앱 혹은 사이트 호출을 식별해서 API 호출을 만다. Auth tokens : 앱 혹은 사이트 사용자를 식별한다."}</script><link rel="canonical" href="https://thinkbee.github.io/2018-06-02-restfull-openapi-jwt_token-13fb94971cf6/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/vs2015.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-5ZH90CZ414" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-5ZH90CZ414');</script><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><script data-ad-client="ca-pub-1465716454138955" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/images/thinkbee_logo.png" alt="IT Tech blogging" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Blog</a><a class="navbar-item" href="/documents">Doc</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/qkboo"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="카탈로그" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="검색" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-four-fifths-tablet is-four-fifths-desktop is-four-fifths-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2018-06-02T00:00:00.000Z" title="6/2/2018, 9:00:00 AM">2018-06-02</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2023-01-13T16:53:06.000Z" title="1/14/2023, 1:53:06 AM">2023-01-14</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Programming/">Programming</a><span> / </span><a class="link-muted" href="/categories/Programming/Nodejs/">Nodejs</a></span><span class="level-item">15분안에 읽기 (약 2195 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile">Open API Web Token</h1><div class="content"><h2 id="Open-api-key"><a href="#Open-api-key" class="headerlink" title="Open api key"></a>Open api key</h2><p>API keys는 사용자 인증, 요청 API 호출을 위해 필요하다.</p>
<p>보통 RESTFull API 호출시 API keys 와 인증 스킴을 사용한다. 주요 차이는:</p>
<ul>
<li>API keys : 앱 혹은 사이트 호출을 식별해서 API 호출을 만다.</li>
<li>Auth tokens : 앱 혹은 사이트 사용자를 식별한다.</li>
</ul>
<span id="more"></span>

<p>이런 인증에 두가지 방식을 사용한다.</p>
<ul>
<li>Session-based Authentication</li>
<li>Token-based Authentication</li>
</ul>
<h3 id="Token-based-Authentication"><a href="#Token-based-Authentication" class="headerlink" title="Token based Authentication"></a>Token based Authentication</h3><p>토큰 기반 인증은</p>
<ol>
<li>Stateless Authentication 이 큰 이유이다. 클라이언트 측 로컬 스토리지 (혹은 세션, 쿠키 가능)에 저장된다.</li>
<li>좋은 예는 싱글 페이지 앱, Web ApIs, IoT가 있다</li>
<li>앱이 확장성이 있고 분리되야 한다면, Token 기반이 좋은 사례가 된다.</li>
</ol>
<blockquote>
<p>Stateless Authentication: 인증에 대해 서버측이 인증 정보를 보존하지 않는다.</p>
</blockquote>
<h3 id="JWT"><a href="#JWT" class="headerlink" title="JWT"></a>JWT</h3><p><strong>JWT</strong>(JSON Web Tokens)는 REST API를 사용한 간단하고 보안이 적용된 인증 전략이다. 웹 인증을 위한 표준이고 JSON token 요청을 기반으로 한다. 인증 서버에서 발급한 토큰을 클라이언트가 요청시 마다 헤더에 토큰을 넣어 요구해야 한다.</p>
<p>MEAN 스택 앱에 빠르게 인증을 추가하는 것은 <a target="_blank" rel="noopener" href="http://jwt.io/">JSON Web Token</a> 을 사용할 수 있다.</p>
<h3 id="How-JWT-Works"><a href="#How-JWT-Works" class="headerlink" title="How JWT Works?"></a>How JWT Works?</h3><p><a target="_blank" rel="noopener" href="https://appdividend.com/2018/02/07/node-js-jwt-authentication-tutorial-scratch/">Node Js JWT Authentication Tutorial From Scratch</a></p>
<p>JSON Web Token is the token; we need to put the header in every request to verify the client. The Architecture of JWT Authentication is pretty darn simple.</p>
<ol>
<li>First user attempt to login with their credentials.</li>
<li>After server verifies the credentials, it sends JSON Web Token to the client.</li>
<li>A client then saves that token in local storage or any other storage mechanism.</li>
<li>Again if a client wants to request a protected route or resource, then it sends JWT in a request header.</li>
<li>The server verifies that JWT and if it is correct then return a 200 response with the information, client needs.</li>
<li>If the JWT is invalid, then it gives unauthorized access or any other restricted message.</li>
<li>Node js JWT Authentication</li>
</ol>
<p>In this tutorial, we are not using any front-end framework. We will use POSTMAN to request the server. We will check the auth using token. So let us get started.</p>
<h4 id="Step-1-Install-node-js-dependencies"><a href="#Step-1-Install-node-js-dependencies" class="headerlink" title="Step 1: Install node js dependencies."></a>Step 1: Install node js dependencies.</h4><p>Create one project folder and go into that folder. Type the following command.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init</span><br></pre></td></tr></table></figure>

<p>Now, install the following dependencies.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install express jsonwebtoken mongoose body-parser --save</span><br></pre></td></tr></table></figure>

<p>It will install the express web framework, jsonwebtoken package to authenticate the user, mongoose schema model, and body-parser middleware.</p>
<p>Also, we need to install the nodemon development server to prevent the stop and restart the server process. So let us do that first.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install nodemon --save-dev</span><br></pre></td></tr></table></figure>

<p>Rest dependencies we will install as our project grows.</p>
<h4 id="Step-2-Configure-the-Node-Server"><a href="#Step-2-Configure-the-Node-Server" class="headerlink" title="Step 2: Configure the Node Server."></a>Step 2: Configure the Node Server.</h4><p>In the package.json file, change this object to the following.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="string">&quot;nodemon server&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<p>So in the terminal when we type npm start command, we bootstrap the server.js file.<br>In the root folder, make one file called <em>server.js</em>. Configure the node server.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// server.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&quot;body-parser&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PORT</span> = <span class="number">3000</span>;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="variable constant_">PORT</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Server is running on Port&quot;</span>, <span class="variable constant_">PORT</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Now, go to terminal and hit the following instruction.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm start</span><br></pre></td></tr></table></figure>

<p>It will start the server, you can see it on a console. So it is ready to consume any request, either web or API.</p>
<h4 id="Step-3-Send-a-request-to-node-server-via-Postman"><a href="#Step-3-Send-a-request-to-node-server-via-Postman" class="headerlink" title="Step 3: Send a request to node server via Postman."></a>Step 3: Send a request to node server via Postman.</h4><p>First, we define one route and send the JSON response to the client.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// server.js</span></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/checking&quot;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">  res.<span class="title function_">json</span>(&#123;</span><br><span class="line">    <span class="title class_">Tutorial</span>: <span class="string">&quot;Welcome to the Node express JWT Tutorial&quot;</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Open the Postman and send the get request to <a target="_blank" rel="noopener" href="http://localhost:3000/checking">http://localhost:3000/checking</a>. Postman Tutorial</p>
<h4 id="Step-4-Configure-the-MongoDB-Database"><a href="#Step-4-Configure-the-MongoDB-Database" class="headerlink" title="Step 4: Configure the MongoDB Database."></a>Step 4: Configure the MongoDB Database.</h4><p>Write the following code to connect the Node.js application to the MongoDB database.</p>
<p>if below mongoose 3.x,</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// server.js</span></span><br><span class="line"><span class="keyword">const</span> mongoose = <span class="built_in">require</span>(<span class="string">&quot;mongoose&quot;</span>);</span><br><span class="line">mongoose.<span class="title function_">connect</span>(<span class="string">&quot;mongodb://localhost/jwtauth&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>Then use above mongoose 4.x, prepare <em>Promise</em> and connect().</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Mongodb</span></span><br><span class="line">mongoose.<span class="property">Promise</span> = <span class="variable language_">global</span>.<span class="property">Promise</span>;</span><br><span class="line"></span><br><span class="line">mongoose.<span class="title function_">connect</span>(<span class="string">&quot;mongodb://student:PW@localhost/students&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">useMongoClient</span>: <span class="literal">true</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Also, write the body-parser middleware to the application.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// server.js</span></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;));</span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">json</span>());</span><br></pre></td></tr></table></figure>

<h4 id="Step-5-Create-a-User-model"><a href="#Step-5-Create-a-User-model" class="headerlink" title="Step 5: Create a User model."></a>Step 5: Create a User model.</h4><p>Create one new folder inside root called models. In that, create one file called user.model.js file.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// user.model.js</span></span><br><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mongoose = <span class="built_in">require</span>(<span class="string">&quot;mongoose&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> user = mongoose.<span class="title class_">Schema</span>(&#123;</span><br><span class="line">  <span class="comment">//_id: mongoose.Schema.Types.ObjectId,</span></span><br><span class="line">  <span class="attr">email</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">  <span class="attr">password</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = mongoose.<span class="title function_">model</span>(<span class="string">&quot;User&quot;</span>, user);</span><br></pre></td></tr></table></figure>

<p>We have defined the schema for the User collection.</p>
<h4 id="Step-6-Create-the-routes-for-users"><a href="#Step-6-Create-the-routes-for-users" class="headerlink" title="Step 6: Create the routes for users."></a>Step 6: Create the routes for users.</h4><p>In the root, make one folder called routes. In that folder, create one file called user.route.js. Now we need to sign the user up for our application. So let us define the post route to signup the user. We also need a bcrypt module to hash the password. We can not store the plain password. So let us install bcrypt module first.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i bcrypt</span><br></pre></td></tr></table></figure>

<p>Next, write the following code into the <em>user.route.js</em> file.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// user.route.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line"><span class="keyword">const</span> mongoose = <span class="built_in">require</span>(<span class="string">&quot;mongoose&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> bcrypt = <span class="built_in">require</span>(<span class="string">&quot;bcrypt&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">User</span> = <span class="built_in">require</span>(<span class="string">&quot;../models/user.model&quot;</span>);</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&quot;/signup&quot;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">  bcrypt.<span class="title function_">hash</span>(req.<span class="property">body</span>.<span class="property">password</span>, <span class="number">10</span>, <span class="keyword">function</span> (<span class="params">err, hash</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">json</span>(&#123;</span><br><span class="line">        <span class="attr">error</span>: err,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// const user = new User(req.body);</span></span><br><span class="line">      <span class="keyword">const</span> user = <span class="keyword">new</span> <span class="title class_">User</span>(&#123;</span><br><span class="line">        <span class="comment">// _id: new  mongoose.Types.ObjectId(),</span></span><br><span class="line">        <span class="attr">email</span>: req.<span class="property">body</span>.<span class="property">email</span>,</span><br><span class="line">        <span class="attr">password</span>: hash,</span><br><span class="line">      &#125;);</span><br><span class="line">      user</span><br><span class="line">        .<span class="title function_">save</span>()</span><br><span class="line">        .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">result</span>) &#123;</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line">          res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">json</span>(&#123;</span><br><span class="line">            <span class="attr">success</span>: <span class="string">&quot;New user has been created&quot;</span>,</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">          res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">json</span>(&#123;</span><br><span class="line">            <span class="attr">error</span>: err,</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br></pre></td></tr></table></figure>

<p>What it does is that it tries to hash the incoming request’s password property. If it fails to do so then returns a response with an error in json format. If it successes then it will create a new user and add that to the MongoDB database. Now include this user.route.js file in the server.js file. I am writing the whole file now.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// server.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&quot;body-parser&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> user = <span class="built_in">require</span>(<span class="string">&quot;./routes/user.route&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> mongoose = <span class="built_in">require</span>(<span class="string">&quot;mongoose&quot;</span>);</span><br><span class="line"></span><br><span class="line">mongoose.<span class="title function_">connect</span>(<span class="string">&quot;mongodb://localhost/jwtauth&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PORT</span> = <span class="number">3000</span>;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;));</span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">json</span>());</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/checking&quot;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">  res.<span class="title function_">json</span>(&#123;</span><br><span class="line">    <span class="title class_">Tutorial</span>: <span class="string">&quot;Welcome to the Node express JWT Tutorial&quot;</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&quot;/user&quot;</span>, user);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="variable constant_">PORT</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Server is running on Port&quot;</span>, <span class="variable constant_">PORT</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="Step-7-Send-a-post-request-from-the-Postman"><a href="#Step-7-Send-a-post-request-from-the-Postman" class="headerlink" title="Step 7: Send a post request from the Postman."></a>Step 7: Send a post request from the Postman.</h4><p>postman 에서 POST 방식으로 새 사용자를 추가해 보자, POST에서 Body를 Raw 이고 형식은 <strong>json(application&#x2F;json)</strong> 를 선택하고 작성한다.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;firstName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;lastName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;email&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><img src="/images/nodejs/auth-jwt-signup-postman.png">{:width&#x3D;”500”}</p>
<figcaption>[그림. Postman에서 JSON 포스트]</figcaption>

<p>You can see here, I have created user successfully. Now, I am using Studio 3T for MongoDB. So here is the newly created user in the database.</p>
<p>이제 실제 암호화된 비밀번호로 생성된 사용자 정보를 확인할 수 있다.</p>
<p><img src="/images/nodejs/auth-jwt-signup-db.png">{:width&#x3D;”500”}</p>
<figcaption>[그림. 새 사용자 정보]</figcaption>

<p>MongoDB Tutorial With An Example</p>
<h4 id="Step-8-Sign-In-the-User"><a href="#Step-8-Sign-In-the-User" class="headerlink" title="Step 8: Sign In the User."></a>Step 8: Sign In the User.</h4><p>사용자가 생성되고 비밀번호로 bcryp로 비밀번호가 생성되면 <code>bcrypt.compare()</code> 를 사용해 사용자 비밀번호를 인증할 수 있다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// user.route.js</span></span><br><span class="line"></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&quot;/signin&quot;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">  <span class="title class_">User</span>.<span class="title function_">findOne</span>(&#123; <span class="attr">email</span>: req.<span class="property">body</span>.<span class="property">email</span> &#125;)</span><br><span class="line">    .<span class="title function_">exec</span>()</span><br><span class="line">    .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">user</span>) &#123;</span><br><span class="line">      bcrypt.<span class="title function_">compare</span>(req.<span class="property">body</span>.<span class="property">password</span>, user.<span class="property">password</span>, <span class="keyword">function</span> (<span class="params">err, result</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">          <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">401</span>).<span class="title function_">json</span>(&#123;</span><br><span class="line">            <span class="attr">failed</span>: <span class="string">&quot;Unauthorized Access&quot;</span>,</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (result) &#123;</span><br><span class="line">          <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">json</span>(&#123;</span><br><span class="line">            <span class="attr">success</span>: <span class="string">&quot;Welcome to the JWT Auth&quot;</span>,</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">401</span>).<span class="title function_">json</span>(&#123;</span><br><span class="line">          <span class="attr">failed</span>: <span class="string">&quot;Unauthorized Access&quot;</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">      res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">json</span>(&#123;</span><br><span class="line">        <span class="attr">error</span>: error,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>사용자 이메일로 허가된 사용자인지 인증하는데, 이메일이 존재하지 않으면 <strong>401 unauthorized access</strong> 에러를 출력한다.</p>
<p><img src="/images/nodejs/auth-jwt-signin-postman.png">{:width&#x3D;”500”}</p>
<figcaption>[그림. Postman에서 Sign 포스트]</figcaption>

<p>First, I have checked if the user’s email exists or not. If not then return 401 unauthorized access. If email is there then check the password with bcrypted database password if match found then welcome to the JWT auth else 401 unauthorized access.</p>
<p>이메일로 사용자 검색이 되고 비밀번호 인증이 되면 환영 JWT auth를 반환하고 아니면 <strong>401 unauthorized access</strong> 를 반환하게 한다.</p>
<h4 id="Step-9-Return-the-JWT-if-auth-attempt-successful"><a href="#Step-9-Return-the-JWT-if-auth-attempt-successful" class="headerlink" title="Step 9: Return the JWT, if auth attempt successful."></a>Step 9: Return the JWT, if auth attempt successful.</h4><p>사용자 증명인 이메일과 패스워드가 유효하면 JWT token을 반환하도록 하자, <code>jwt.sign()</code> 함수는 기본으로 HMAC SHA256 해시 코드를 발생한다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">jwt.<span class="title function_">sign</span>(&#123;</span><br><span class="line">  <span class="attr">email</span>: user.<span class="property">email</span>,</span><br><span class="line">  <span class="attr">_id</span>: user.<span class="property">_id</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>다른 알고리즘이 필요하면 <em>algorighm</em> 속성을 제시해 준다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">jwt.<span class="title function_">sign</span>(&#123;</span><br><span class="line">  <span class="attr">email</span>: user.<span class="property">email</span>,</span><br><span class="line">  <span class="attr">_id</span>: user.<span class="property">_id</span>,</span><br><span class="line">  &#123; <span class="attr">algorithm</span>: <span class="string">&#x27;RS256&#x27;</span>&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>If the user’s credentials email and password are valid then in response, we need to return a JWT token. So let us generate the token and return to the user.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// user.route.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&quot;jsonwebtoken&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (result) &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="title class_">JWTToken</span> = jwt.<span class="title function_">sign</span>(</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">email</span>: user.<span class="property">email</span>,</span><br><span class="line">      <span class="attr">_id</span>: user.<span class="property">_id</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;secret&quot;</span>,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">expiresIn</span>: <span class="string">&quot;2h&quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  );</span><br><span class="line">  <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">json</span>(&#123;</span><br><span class="line">    <span class="attr">success</span>: <span class="string">&quot;Welcome to the JWT Auth&quot;</span>,</span><br><span class="line">    <span class="attr">token</span>: <span class="title class_">JWTToken</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>JWT Token의 형식은 HEADER, PAYLOAD, SECRETKEY 조합으로 아래 같다:</p>
<p>The format of JWT Token is as following.</p>
<p><strong>HEADER: ALGORITHM &amp; TOKEN TYPE</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">“alg”<span class="punctuation">:</span> “HS256”<span class="punctuation">,</span></span><br><span class="line">“typ”<span class="punctuation">:</span> “JWT”</span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>PAYLOAD:DATA</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">“email”<span class="punctuation">:</span> “krunallathiya10@gmail.com”<span class="punctuation">,</span></span><br><span class="line">“_id”<span class="punctuation">:</span> “<span class="number">5</span>a7c9bd8fc3e501c94aa6035”<span class="punctuation">,</span></span><br><span class="line">“iat”<span class="punctuation">:</span> <span class="number">1518120124</span><span class="punctuation">,</span></span><br><span class="line">“exp”<span class="punctuation">:</span> <span class="number">1518127324</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>VERIFY SIGNATURE</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">HMACSHA256(</span><br><span class="line">  base64UrlEncode(header) + <span class="string">&quot;.&quot;</span> +</span><br><span class="line">  base64UrlEncode(payload)<span class="punctuation">,</span></span><br><span class="line">  secret</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>조합으로 생성한 JWT는 아래 같은 JWT Token을 반환한다.</p>
<p>So it is a combination of header, payload, and secretkey, we are providing. Remember, You need to define your secret key in your environment variable file. I have just shown here for the demo purpose. So it will produce the following JWT token.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6ImtydW5hbGxhdGhpeWExMEBnbWFpbC5jb20iLCJfaWQiOiI1YTdjOWJkOGZjM2U1MDFjOTRhYTYwMzUiLCJpYXQiOjE1MTgxMjAxMjQsImV4cCI6MTUxODEyNzMyNH0._6qVGQV_KYlonawnaTHG-OhOJLV4tgD-Eob5iRz89AM</span><br></pre></td></tr></table></figure>

<p>이 토큰을 제한된 자원에 접근하는 앱에 사용할 수 있다.</p>
<p>Now use this token to access the protected resources to your application and we are done here. So this is how you can generate the JWT Auth Token.</p>
<h4 id="JWT-Token-verifying"><a href="#JWT-Token-verifying" class="headerlink" title="JWT Token verifying"></a>JWT Token verifying</h4><p><code>jwt.verify()</code>를 사용해 발급한 토큰이 허용되는지 검증할 수 있다.</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/auth0/node-jsonwebtoken#jwtverifytoken-secretorpublickey-options-callback">jwt.verify(token, secretOrPublicKey, [options, callback])</a></p>
<ul>
<li><code>token</code>: 발행된 Json Web Token</li>
<li><code>secretOrPublicKey</code>: 토큰 발행시 제공한 시크릿 키</li>
</ul>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">post</span>(<span class="string">&quot;/verify&quot;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> user = <span class="title class_">User</span>.<span class="title function_">findOne</span>(&#123; <span class="attr">email</span>: req.<span class="property">body</span>.<span class="property">email</span> &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// check expired?</span></span><br><span class="line">  jwt.<span class="title function_">verify</span>(req.<span class="property">body</span>.<span class="property">token</span>, user.<span class="property">secret_key</span>, <span class="keyword">function</span> (<span class="params">err, decoded</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">      <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">json</span>(err);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="참조"><a href="#참조" class="headerlink" title="참조"></a>참조</h2><ul>
<li><p><a target="_blank" rel="noopener" href="https://www.npmjs.com/package/jsonwebtoken">npm:JSONWebToken</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://appdividend.com/2018/02/07/node-js-jwt-authentication-tutorial-scratch/">Node Js JWT Authentication Tutorial From Scratch</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://cloud.google.com/endpoints/docs/openapi/when-why-api-key">Why and When to Use API Keys</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://appdividend.com/2018/02/07/node-js-jwt-authentication-tutorial-scratch/">https://appdividend.com/2018/02/07/node-js-jwt-authentication-tutorial-scratch/</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://medium.freecodecamp.org/securing-node-js-restful-apis-with-json-web-tokens-9f811a92bb52">Securing Node.js RESTful APIs with JSON Web Tokens</a></p>
</li>
</ul>
</div><div class="article-licensing box"><div class="licensing-title"><p>Open API Web Token</p><p><a href="https://thinkbee.github.io/2018-06-02-restfull-openapi-jwt_token-13fb94971cf6/">https://thinkbee.github.io/2018-06-02-restfull-openapi-jwt_token-13fb94971cf6/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Gangtai Goh</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2018-06-02</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2023-01-14</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/nodejs/">nodejs</a><a class="link-muted mr-2" rel="tag" href="/tags/%EC%9B%B9%ED%86%A0%ED%81%B0/">웹토큰</a><a class="link-muted mr-2" rel="tag" href="/tags/JWT-Toekn/">JWT Toekn</a><a class="link-muted mr-2" rel="tag" href="/tags/JSON-Web-Token/">JSON Web Token</a></div><div class="sharethis-inline-share-buttons"></div><script src="https://platform-api.sharethis.com/js/sharethis.js#property=63bf627f1bc5280019aabbcc&amp;product=sop" defer></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">이 글이 마음에 드시나요? 다음을 통해 후원하실 수 있습니다: </h3><div class="buttons is-centered"><a class="button donate" href="https://www.buymeacoffee.com/gangtaigoh" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>커피 한 잔 사주기</span></a><a class="button donate" href="/patreon.com/user?u=86716526" target="_blank" rel="noopener" data-type="patreon"><span class="icon is-small"><i class="fab fa-patreon"></i></span><span>Patreon</span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/restfull-openapi-4fd2d5982df7/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">[Open API] REST Architecture 요약</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/mac-hammerspoon-fd545099c24f/"><span class="level-item">Hammerspoon 사용해 데스크탑 자동화</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">댓글</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'https://thinkbee.github.io/2018-06-02-restfull-openapi-jwt_token-13fb94971cf6/';
            this.page.identifier = '2018-06-02-restfull-openapi-jwt_token-13fb94971cf6/';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + 'qkboo-github-io' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div></div><!--!--><div class="column column-right is-4-tablet is-4-desktop is-4-widescreen  order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">카탈로그</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Open-api-key"><span class="level-left"><span class="level-item">1</span><span class="level-item">Open api key</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Token-based-Authentication"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">Token based Authentication</span></span></a></li><li><a class="level is-mobile" href="#JWT"><span class="level-left"><span class="level-item">1.2</span><span class="level-item">JWT</span></span></a></li><li><a class="level is-mobile" href="#How-JWT-Works"><span class="level-left"><span class="level-item">1.3</span><span class="level-item">How JWT Works?</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Step-1-Install-node-js-dependencies"><span class="level-left"><span class="level-item">1.3.1</span><span class="level-item">Step 1: Install node js dependencies.</span></span></a></li><li><a class="level is-mobile" href="#Step-2-Configure-the-Node-Server"><span class="level-left"><span class="level-item">1.3.2</span><span class="level-item">Step 2: Configure the Node Server.</span></span></a></li><li><a class="level is-mobile" href="#Step-3-Send-a-request-to-node-server-via-Postman"><span class="level-left"><span class="level-item">1.3.3</span><span class="level-item">Step 3: Send a request to node server via Postman.</span></span></a></li><li><a class="level is-mobile" href="#Step-4-Configure-the-MongoDB-Database"><span class="level-left"><span class="level-item">1.3.4</span><span class="level-item">Step 4: Configure the MongoDB Database.</span></span></a></li><li><a class="level is-mobile" href="#Step-5-Create-a-User-model"><span class="level-left"><span class="level-item">1.3.5</span><span class="level-item">Step 5: Create a User model.</span></span></a></li><li><a class="level is-mobile" href="#Step-6-Create-the-routes-for-users"><span class="level-left"><span class="level-item">1.3.6</span><span class="level-item">Step 6: Create the routes for users.</span></span></a></li><li><a class="level is-mobile" href="#Step-7-Send-a-post-request-from-the-Postman"><span class="level-left"><span class="level-item">1.3.7</span><span class="level-item">Step 7: Send a post request from the Postman.</span></span></a></li><li><a class="level is-mobile" href="#Step-8-Sign-In-the-User"><span class="level-left"><span class="level-item">1.3.8</span><span class="level-item">Step 8: Sign In the User.</span></span></a></li><li><a class="level is-mobile" href="#Step-9-Return-the-JWT-if-auth-attempt-successful"><span class="level-left"><span class="level-item">1.3.9</span><span class="level-item">Step 9: Return the JWT, if auth attempt successful.</span></span></a></li><li><a class="level is-mobile" href="#JWT-Token-verifying"><span class="level-left"><span class="level-item">1.3.10</span><span class="level-item">JWT Token verifying</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="#참조"><span class="level-left"><span class="level-item">2</span><span class="level-item">참조</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">최근 글</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-06-24T23:00:00.000Z">2025-06-25</time></p><p class="title"><a href="/WSL-%EC%99%B8%EB%B6%80%EB%94%94%EC%8A%A4%ED%81%AC-a38220eecf9e/">WSL 외부디스크 마운트</a></p><p class="categories"><a href="/categories/OS/">OS</a> / <a href="/categories/OS/Windows/">Windows</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-03-25T00:00:00.000Z">2025-03-25</time></p><p class="title"><a href="/pyenv-doctor-ea932b0ee5ca/">pyenv-doctor</a></p><p class="categories"><a href="/categories/Programming/">Programming</a> / <a href="/categories/Programming/Python/">Python</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-03-19T00:00:00.000Z">2025-03-19</time></p><p class="title"><a href="/jupyter-kernelspec-394edf611c5b/">jupyterlab - kernel 관리</a></p><p class="categories"><a href="/categories/Programming/">Programming</a> / <a href="/categories/Programming/Python/">Python</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-03-11T00:00:00.000Z">2025-03-11</time></p><p class="title"><a href="/python-mamba-micromamba-install-135c207e8538/">mamba / micromamba 요약 정리</a></p><p class="categories"><a href="/categories/Programming-Python/">Programming, Python</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-02-02T01:00:00.000Z">2025-02-02</time></p><p class="title"><a href="/llama-model-bench-rtx3080ti-e1cdcf8d9cee/">Local LLM 실험: RTX 3080Ti 에서 bench mark 결과</a></p><p class="categories"><a href="/categories/AI/">AI</a> / <a href="/categories/AI/LLM/">LLM</a></p></div></article></div></div><div class="card widget" data-type="adsense"><div class="card-content"><div class="menu"><h3 class="menu-label">광고</h3><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-1465716454138955" data-ad-slot="4441624809" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></div><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/images/qkboo_400.png" alt="Gangtai"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Gangtai</p><p class="is-size-6 is-block">Your title</p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">포스트</p><a href="/archives"><p class="title">174</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">카테고리</p><a href="/categories"><p class="title">19</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">태그</p><a href="/tags"><p class="title">253</p></a></div></div></nav></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/images/thinkbee_logo.png" alt="IT Tech blogging" height="28"></a><p class="is-size-7"><span>&copy; 2025 Gangtai Goh</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("ko");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="맨 위로" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-right",
        content: {
          message: "이 웹 사이트는 귀하의 경험을 향상시키기 위해 Cookie를 사용합니다.",
          dismiss: "무시",
          allow: "허용",
          deny: "거부",
          link: "더 알아보기",
          policy: "Cookie 정책",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="입력 하세요..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"입력 하세요...","untitled":"(제목 없음)","posts":"포스트","pages":"페이지","categories":"카테고리","tags":"태그"});
        });</script></body></html>