<!doctype html>
<html lang="ko"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta><title>태그: jupyterlab - IT Tech blogging</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="thinkbee blog"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="thinkbee blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Machine learning, Deep learning, Python, Data science and Mobile Programming like Android"><meta property="og:type" content="website"><meta property="og:title" content="IT Tech blogging"><meta property="og:url" content="https://blog.thinkbee.kr/"><meta property="og:site_name" content="IT Tech blogging"><meta property="og:description" content="Machine learning, Deep learning, Python, Data science and Mobile Programming like Android"><meta property="og:locale" content="ko_KR"><meta property="og:image" content="https://blog.thinkbee.kr/img/og_image.png"><meta property="article:author" content="Gangtai Goh"><meta property="article:tag" content="Machine learning, Deep learning, Python, Data science, Android, Ubuntu, Linux, macOS"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://blog.thinkbee.kr/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.thinkbee.kr"},"headline":"IT Tech blogging","image":["https://blog.thinkbee.kr/img/og_image.png"],"author":{"@type":"Person","name":"Gangtai Goh"},"publisher":{"@type":"Organization","name":"IT Tech blogging","logo":{"@type":"ImageObject","url":"https://blog.thinkbee.kr/images/thinkbee_logo.png"}},"description":"Machine learning, Deep learning, Python, Data science and Mobile Programming like Android"}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/vs2015.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-5ZH90CZ414" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-5ZH90CZ414');</script><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><script data-ad-client="ca-pub-1465716454138955" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/images/thinkbee_logo.png" alt="IT Tech blogging" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Blog</a><a class="navbar-item" href="/documents">Doc</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/thinkbee"><i class="fab fa-github"></i></a><a class="navbar-item search" title="검색" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-four-fifths-tablet is-four-fifths-desktop is-four-fifths-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/tags">태그</a></li><li class="is-active"><a href="#" aria-current="page">jupyterlab</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-07-27T12:00:00.000Z" title="7/27/2023, 9:00:00 PM">2023-07-27</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2023-08-04T22:17:06.063Z" title="8/5/2023, 7:17:06 AM">2023-08-05</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Programming/">Programming</a><span> / </span><a class="link-muted" href="/categories/Programming/Python/">Python</a></span><span class="level-item">1분안에 읽기 (약 211 단어)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/jupyterlab_upgrade_3_to_4-10265c5617ef/">Jupyterlab 4 업그레이드 주의 사항.</a></p><div class="content"><p>Jupyter 3.x 를 사용중에 Jupyter 4.0 출시를 했다고 해서 가상환경을 만들고 jupyterlab 4.0 을 설치했었다. 조금 더 UI 가 명확해 보이고 괜잖았는데 한글 입력시 글가가 깨져서 입력되거나 혹은 현재 편집중인 Cell 의 위치가 달라져 보이는 이상한 증상이 있어서 4.0 업그레이드 버전 사용을 안했는데 이유는 Node.js 버전 문제로 보인다.</p>
<h1 id="Node-js-버전"><a href="#Node-js-버전" class="headerlink" title="Node.js 버전"></a>Node.js 버전</h1><p>기존에 jupyterlab 3.6 에서 Node.js 14 버전을 사용하고 있었다. Jupyterlab 4.x 버전의 주피터 확장 모듈 빌드도 문제가 없었는데 위에 언급한 이상한 현상이 발생해서 Jupyterlab 4.x 가상환경에서 Node.Js 버전을 18버전으로 업그레이후 후에는 문제없이 사용중이다.</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-07-14T07:00:00.000Z" title="7/14/2023, 4:00:00 PM">2023-07-14</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2023-07-15T08:17:32.478Z" title="7/15/2023, 5:17:32 PM">2023-07-15</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Programming/">Programming</a><span> / </span><a class="link-muted" href="/categories/Programming/Python/">Python</a></span><span class="level-item">7분안에 읽기 (약 1001 단어)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/jupyterlab-multiprocess_print-483b37e7a2c3/">Jupyter 기반 환경에서 Multiprocess 실행시 print 출력 차이.</a></p><div class="content"><p>jupyter notebook에서 실행하면 차일드 프로세스로 실행한 print() 로 출력하는 결과를 확인할 수 업다. print 는 std out 에 출력하도록 되어 있다. 자식 프로세스에서 print 를 호출하면 <code>spawn</code> 을 사용해서 호출되어서 출력되지 않는다.  </p>
<h1 id="차일드-프로세스-print-문제"><a href="#차일드-프로세스-print-문제" class="headerlink" title="차일드 프로세스 print 문제"></a>차일드 프로세스 print 문제</h1><p>아래 코드는 아주 간단하게 메인 프로세스에서 새 프로세스를 생성하고 실행한다. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">msg</span>):</span><br><span class="line">    <span class="built_in">print</span>(msg)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    proc = Process(target=func, args=(<span class="string">&#x27;Hello multiproess&#x27;</span>,))</span><br><span class="line">    proc.start()</span><br><span class="line">    proc.join()</span><br></pre></td></tr></table></figure>

<p>이 코드는 소스로 쉘에서 실행하거나 Web 기반의 jupyterlab 에서 실행하면 아무 문제이 print 문이 잘 작동하고 출력 결과가 나온다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>! python mutiprocess1.py</span><br><span class="line">Hello multiproess</span><br></pre></td></tr></table></figure>

<blockquote>
<p>print 의 Multiprocessing 에서 문제는 링크 <a href="#footnote1">참고1</a> 을 읽어보기를 권한다. 이 글에서는 테스트한 내용을 정리만 했다.</p>
</blockquote>
<h1 id="원인"><a href="#원인" class="headerlink" title="원인"></a>원인</h1><p>아래 링크 <a href="#footnote1">참고1</a> 기사에서 설명을 자세히 하고 있다. 보통 파이썬에서 차일드 프로세스를 시작할 때는 <code>&#39;fork&#39;, &#39;spawn&#39;, &#39;forkserver&#39;</code> 방법이 있다고 한다. 그런데 spawn 으로 차일드 프로세스를 실행하면 std io 출력 버퍼가 자동으로 비워지지 않는다(print는 기본으로 flush가 되지 않는다). 그러다 보니 차일드 프로세스가 종료 하면서 자동으로 gabage collection에 의해  버퍼에 남아 있는 메시지가 사라지는 것이다.</p>
<h1 id="해결-방법"><a href="#해결-방법" class="headerlink" title="해결 방법"></a>해결 방법</h1><ol>
<li>메시지 버퍼가 사라지기 전에 flush 를 한다.</li>
<li>fork 기반의 프로세스를 생성한다.</li>
</ol>
<h2 id="1-flush-사용"><a href="#1-flush-사용" class="headerlink" title="1. flush 사용"></a>1. flush 사용</h2><ol>
<li>메시지 버퍼가 사라지기 전에 flush 를 한다.</li>
</ol>
<p>이를 해결하기 위해 모든 print 의 출력은 즉시 flush 되도록 flush&#x3D;True 옵션을 사용할 수 있다고 한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">msg</span>):</span><br><span class="line">    <span class="built_in">print</span>(msg, flush=Yes)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>이 방법은 VS code 현재 jupyter 확장에서는 효과가 없다.</p>
</blockquote>
<h3 id="flush-란"><a href="#flush-란" class="headerlink" title="flush 란?"></a>flush 란?</h3><p>std io 의 버퍼 처리 흐름은 글 <a target="_blank" rel="noopener" href="https://velog.io/@jinh2352/%ED%8C%8C%EC%9D%BC-IO-%EB%B2%84%ED%8D%BC%EB%A7%81">파일 I&#x2F;O 버퍼링</a> 을 살펴보고,</p>
<img src='https://images.velog.io/images/jinh2352/post/f7beb0b1-fb84-4f74-adcf-5956f80833ab/image.png' width=550>


<p>python에서 print 같은 표준 출력의 flush에 대해서 이글 <a target="_blank" rel="noopener" href="https://www.msdotnet.co.in/2020/04/print-function-in-python-language-with.html"></a> 의 그림을 참고한다.</p>
<img src='https://1.bp.blogspot.com/-UrjeTkA4kVA/XpcsMVPBIHI/AAAAAAAAHRg/EDERNZm9L4MIEWEtyIiJ42par-sIChx3wCLcBGAsYHQ/s640/FLUSH%2BIN%2BPYTHON.JPG' width=550>


<h2 id="2-fork-기반의-프로세스를-생성한다"><a href="#2-fork-기반의-프로세스를-생성한다" class="headerlink" title="2. fork 기반의 프로세스를 생성한다."></a>2. fork 기반의 프로세스를 생성한다.</h2><p>지원되는 프로세스 시작 방법은 아래 같이 확인이 가능하다. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> multiprocessing <span class="keyword">as</span> mp</span><br><span class="line"></span><br><span class="line">mp.get_start_method()       <span class="comment"># 현재 start 메서드</span></span><br><span class="line">mp.get_all_start_methods()  <span class="comment"># 모든 start 메서드</span></span><br></pre></td></tr></table></figure>

<p>아래 같이 start method 를 <code>fork</code> 로 강제 사용할 수 있다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> multiprocessing <span class="keyword">as</span> mp</span><br><span class="line"></span><br><span class="line">mp.set_start_method(<span class="string">&#x27;fork&#x27;</span>)       <span class="comment"># 현재 start 메서드</span></span><br></pre></td></tr></table></figure>

<p>브라우저 기반의 jupyter 실행환경은  <code>&#39;fork&#39;, &#39;spawn&#39;, &#39;forkserver&#39;</code> 를 모두 가능하다. 하지만 현재 VS code 의 jupyter 확장은 에서는 <code>spawn</code> 만 지원하고 있다.</p>
<h2 id="fork-spawn"><a href="#fork-spawn" class="headerlink" title="fork, spawn"></a>fork, spawn</h2><p>링크 <a href="#footnote2">침고2</a> 에 있는 글에서 Fork, Spawn 에 대한 설명을 읽어보자.</p>
<p>Forking</p>
<ul>
<li>포크한 부모 프로세스의 이미지를 그래도 사용한다.</li>
</ul>
<img src='https://d33wubrfki0l68.cloudfront.net/8c3a4605e6d501f6a448faafd71cd2047d9d2e07/b9b18/blog/assets/2019-11-13-python-forkserver-preload/python-forkserver-0.png' width=550>


<p>Spwaning</p>
<ul>
<li>포크한 부모 프로세스와 다르게 새 이미지로 갱신한다.</li>
</ul>
<img src='https://d33wubrfki0l68.cloudfront.net/8d5e9dd98d91090aeecb72cf9e956b3afe679fd6/3b168/blog/assets/2019-11-13-python-forkserver-preload/python-forkserver-1.png' width=500>


<h1 id="sleep-으로-지연하면"><a href="#sleep-으로-지연하면" class="headerlink" title="sleep 으로 지연하면?"></a>sleep 으로 지연하면?</h1><p>VS code 환경에서 아래 같이 sleep 으로 지연을 주어 봤지만 해결이 안된다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">msg</span>):</span><br><span class="line">    <span class="built_in">print</span>(msg, flush=<span class="literal">True</span>)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    proc = mp.Process(target=func, args=(<span class="string">&#x27;Hello multiproess&#x27;</span>,))</span><br><span class="line">    proc.start()</span><br><span class="line">    proc.join()</span><br></pre></td></tr></table></figure>

<p>아래 같이 join 전에 sleep 으로 지연</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">msg</span>):</span><br><span class="line">    <span class="built_in">print</span>(msg, flush=<span class="literal">True</span>)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    proc = mp.Process(target=func, args=(<span class="string">&#x27;Hello multiproess&#x27;</span>,))</span><br><span class="line">    proc.start()</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    proc.join()</span><br></pre></td></tr></table></figure>


<h1 id="결론"><a href="#결론" class="headerlink" title="결론"></a>결론</h1><p>현재 테스트한 VS Code 의 jupyter 확장 버전은 아래 같다.</p>
<ul>
<li>Windows VS code, Jupyter Extension<ul>
<li>v2023.6.1101941928</li>
<li>v2023.7.1001901100</li>
</ul>
</li>
</ul>
<p>만약 VS code 에서 Multiprocess 디버깅시 다른 logger 라이브러리 등을 이용해야 할 것 같다.</p>
<hr>
<h1 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h1><p><a name='footnote1'>참고1</a> :  <a target="_blank" rel="noopener" href="https://superfastpython.com/multiprocessing-print/">How to print() from a Child Process in Python</a></p>
<p><a name='footnote2'>참고2</a> : <a target="_blank" rel="noopener" href="https://sunyzero.tistory.com/191">fork, vfork 그리고 posix_spawn 이야기</a></p>
<p><a name='footnote2'>참고3</a> : <a target="_blank" rel="noopener" href="https://bnikolic.co.uk/blog/python/parallelism/2019/11/13/python-forkserver-preload.html">foring, spawning 이미지</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-07-12T10:00:00.000Z" title="7/12/2023, 7:00:00 PM">2023-07-12</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2023-07-12T17:37:18.317Z" title="7/13/2023, 2:37:18 AM">2023-07-13</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Programming/">Programming</a><span> / </span><a class="link-muted" href="/categories/Programming/Python/">Python</a></span><span class="level-item">2분안에 읽기 (약 354 단어)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/vscode-language-server-24eec7ce2732/">VSCode 에서 languageserver 확인</a></p><div class="content"><p>VS Code에서 Jupyterlab 3.x를 사용하는데 classic jupyter notebook 에서 가능하던 content assistance 기능이 작동을 하지 않았다. </p>
<h1 id="상황"><a href="#상황" class="headerlink" title="상황"></a>상황</h1><p>Jupyterlab, classic jupyter notebook 에서 가능하던 content assistance 기능으로 속성&#x2F;모듈&#x2F;함수&#x2F;도움말 등의 지원이 가능했다.</p>
<ul>
<li>Jupyterlab에서 노트북 셀의 tab &amp; shift tab</li>
</ul>
<img src="/images/python/vs-jupyter-assistance1.png">
그림>


<p>그런데 Visual studio code 에서 <code>.ipynb</code> 노트북 파일을 열어 사용하면 이런 기능이 안되고 있어서 궁금했다.</p>
<p>구글 검색으로 스택오버플로우에 올라온 기사를 보니 <code>settings.json</code> 을 보면 python language server 설정을 해야 한다고 한다. 현재는 Default 상태로 선택되어 있어서 그렇다고 한다. 그래서 Pylance 를 지정했다.</p>
<img src="/images/python/vs-jupyter-assistance2.png">

<p>languageserver 를 지정하고 재시작한 후 살펴보니 잘 된다.</p>
<img src="/images/python/vs-jupyter-assistance3.png">

<h2 id="Language-Server-extension-이란"><a href="#Language-Server-extension-이란" class="headerlink" title="Language Server extension 이란?"></a>Language Server extension 이란?</h2><p><a target="_blank" rel="noopener" href="https://code.visualstudio.com/api/language-extensions/language-server-extension-guide">language-server-extension-guide</a> 에서 설명한 바로는</p>
<blockquote>
<p>여러 프로그래밍 언어에 대해서 강력한 편집 경험을 제공하고자 한다.</p>
</blockquote>
<p>아래 그림에서 languageserver 의 효과를 설명하고 있다. 왼쪽 같이 LSP 가 없으면 각 편집기에서 직접 언어 엔진을 가동해야 한다. 그런데 오른쪽 깥이 LSP를 사용하면 하나의 서버를 통해서 여러 편집기에서 언어의 특성을 활용할 수 있다는 설명 이다.</p>
<img src='https://code.visualstudio.com/assets/api/language-extensions/language-server-extension-guide/lsp-languages-editors.png' backgrounds="#FFFFFF">
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-05-14T12:00:00.000Z" title="5/14/2023, 9:00:00 PM">2023-05-14</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2023-06-20T02:39:28.664Z" title="6/20/2023, 11:39:28 AM">2023-06-20</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Programming/">Programming</a><span> / </span><a class="link-muted" href="/categories/Programming/Python/">Python</a></span><span class="level-item">1분안에 읽기 (약 223 단어)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/jupyterlab_extension_build_npm_error-1b7523ac01f3/">Jupyterlab 의 extension 을 설치하고 build 시 npm 에러.</a></p><div class="content"><p>jupyterlab 의 확장 모듈을 다운받아 설치시 nodejs 실행 환경이 제공되야 한다.</p>
<h1 id="jupyterlab-확장-build-error"><a href="#jupyterlab-확장-build-error" class="headerlink" title="jupyterlab 확장 build error"></a>jupyterlab 확장 build error</h1><p>jupyterlab 의 확장 모듈을 다운받아 설치하다 보면 npm 과 연계한 프로그램이 많다. 아래 같은 nodejs 관련 에러를 발생한다.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">daddy&gt; jupyter lab build</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">An error occurred.</span><br><span class="line">RuntimeError: npm dependencies failed to install</span><br><span class="line">See the log file <span class="keyword">for</span> details:  C:\Users\USERID\AppData\Local\Temp\jupyterlab<span class="literal">-debug-4kr1lkn1</span>.log</span><br></pre></td></tr></table></figure>

<p>결론으로 현재 jupyterlab 을 실행하는 환경에서</p>
<ol>
<li>nodejs 버전이 설치되어 있고</li>
<li>jupyterlab extensions가 활성화 되어 있다면</li>
</ol>
<p>해당 로그 파일을 확인해 보면 대부분 nodejs 버전이 일치하지 않아서 아래 같은 로그를 기록하고 있어 보인다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">error readable-stream@4.3.0: The engine &quot;node&quot; is incompatible with this module. Expected version &quot;^12.22.0 || ^14.17.0 || &gt;=16.0.0&quot;. Got &quot;14.15.0&quot;</span><br><span class="line">error Found incompatible module.</span><br></pre></td></tr></table></figure>

<p><u>nodejs 버전을 업그레이드</u> 하고 빌드를 수행하니 잘 된다.</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-05-11T00:00:00.000Z" title="5/11/2023, 9:00:00 AM">2023-05-11</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2023-05-12T07:39:47.811Z" title="5/12/2023, 4:39:47 PM">2023-05-12</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Programming/">Programming</a><span> / </span><a class="link-muted" href="/categories/Programming/Python/">Python</a></span><span class="level-item">2분안에 읽기 (약 296 단어)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/python_secret_file-bfd5b37c220c/">Python 에서 secret 키 값 이용하기 - json</a></p><div class="content"><p>크롤링, 데이터 베이스 연결등에 사용자 인증번호를 사용하는데 코드 자체에 아이디&#x2F;비밀번호를 입력해서 사용하면 유출의 염려가 있으므로 이를 외부 파일에 두고 관리하고자 한다.</p>
<p>여러가지 방법이 있겠지만 여기서는 json 을 사용한다.</p>
<blockquote>
<p><code>key:value</code> 형식의 properties, 윈도우 ini  같은 형식을 지원하는 configparser 모듈도 좋은 선택 같다.</p>
</blockquote>
<h1 id="json-이용-키-관리"><a href="#json-이용-키-관리" class="headerlink" title="json 이용 키 관리"></a>json 이용 키 관리</h1><p>외부에 아래 형식의 secret 파일을 생성한다. </p>
<ul>
<li>디렉토리: <code>.api_keys/</code> 폴더 사용</li>
<li>파일: <code>secret_keys.json</code></li>
</ul>
<h2 id="secret-keys-json"><a href="#secret-keys-json" class="headerlink" title="secret_keys.json"></a>secret_keys.json</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>   <span class="attr">&quot;naver.com&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;userid&quot;</span><span class="punctuation">:</span> <span class="string">&quot;UR_ID&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;password&quot;</span> <span class="punctuation">:</span><span class="string">&quot;votmdnjem&quot;</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;apple.net&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;userid&quot;</span><span class="punctuation">:</span> <span class="string">&quot;UR_ID&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;password&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;votmdnjem&quot;</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;api.twitter.com&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;CONSUMER_KEY&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;unJgTOc0aZkk7NoX4LlD5g&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;CONSUMER_SECRET&quot;</span><span class="punctuation">:</span><span class="string">&quot;uHdmctDcPM66s9OasrKnr2x3pu88&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;ACCESS_TOKEN&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;98948674-J9auHiBiOGoWUJOzRafp&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;ACCESS_TOKEN_SECRET&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;kKgT9tlSY2rCIAbWJrCEEiTsR37&quot;</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;my_database&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;userid&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;UR_ID&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;password&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;votmdnjem&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="파일-사용"><a href="#파일-사용" class="headerlink" title="파일 사용"></a>파일 사용</h2><p>json 모듈을 사용해서 해당 파일을 읽으면 키:값 형식으로 참조해서 사용할 수 있다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;../../.api_keys/secret_keys.json&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    secrets = json.loads(f.read())</span><br></pre></td></tr></table></figure>

<p>이렇게 읽어들인 json 은 dict 같이 사용할 수 있다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DB_USER, DB_PW = secrets[<span class="string">&#x27;my_database&#x27;</span>][<span class="string">&#x27;userid&#x27;</span>], secrets[<span class="string">&#x27;my_database&#x27;</span>][<span class="string">&#x27;password&#x27;</span>]</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-05-10T00:00:00.000Z" title="5/10/2021, 9:00:00 AM">2021-05-10</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2023-05-12T07:39:00.451Z" title="5/12/2023, 4:39:00 PM">2023-05-12</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Programming/">Programming</a><span> / </span><a class="link-muted" href="/categories/Programming/Python/">Python</a></span><span class="level-item">8분안에 읽기 (약 1251 단어)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/JupyterLab_password_systemd-8a92e2396833/">Jupyterlab 에서 password 생성해 systemd 서비스 이용</a></p><div class="content"><h1 id="Jupyter-Lab-systemd-운영"><a href="#Jupyter-Lab-systemd-운영" class="headerlink" title="Jupyter Lab - systemd 운영"></a>Jupyter Lab - systemd 운영</h1><p>jupyterlab 을 Itel 기반의 Ubuntu 시스템에 설치하고 시스템 서비스로 등록하는 과정.</p>
<ol>
<li>Ubuntu 18.04</li>
<li>node.js</li>
<li>Anaconda 2020</li>
</ol>
<p>Restart your shell so the path changes take effect. You can now begin using pyenv.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec &quot;$SHELL&quot;</span><br></pre></td></tr></table></figure>

<h2 id="Anaconda-배포본-설치-Ubuntu"><a href="#Anaconda-배포본-설치-Ubuntu" class="headerlink" title="Anaconda 배포본 설치 (Ubuntu)"></a>Anaconda 배포본 설치 (Ubuntu)</h2><p>우분투용 다운로드</p>
<p><a target="_blank" rel="noopener" href="https://www.anaconda.com/products/individual#linux">https://www.anaconda.com/products/individual#linux</a></p>
<p>다움로드안 쉘 스크립트를 시작한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash ~/Downloads/Anaconda3-2020.02-Linux-x86_64.sh</span><br></pre></td></tr></table></figure>

<p>To control whether or not each shell session has the base environment activated or not, run conda config –set auto_activate_base False or True. To run conda from anywhere without having the base environment activated by default, use conda config –set auto_activate_base False. This only works if you have run conda init first.</p>
<p>Anaconda 를 설치하면 대부분의 패키지가 내장되어 있다.</p>
<p>설치후 최신 conda 환경 base를 갱신해 준다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda update -n base -c defaults conda</span><br></pre></td></tr></table></figure>

<h1 id="nvm으로-Node-js-설치"><a href="#nvm으로-Node-js-설치" class="headerlink" title="nvm으로 Node.js 설치"></a>nvm으로 Node.js 설치</h1><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/nvm-sh/nvm#installing-and-updating">https://github.com/nvm-sh/nvm#installing-and-updating</a></li>
</ul>
<p>nvm 설치</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.37.0/install.sh | bash</span><br></pre></td></tr></table></figure>

<p>스크립트로 설치를 완료하면 쉘 시작시 nvm 환경을 구성하기 위해서아래 스크립이 자동으로 현재 쉘 스크립트 파일 끝에 추가된다.</p>
<blockquote>
<p>만약 아래 스크립이 추가 안되면 아래 스크립트를 (~&#x2F;.bash_profile, ~&#x2F;.zshrc, ~&#x2F;.profile, or ~&#x2F;.bashrc).)에 추가한다.</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export NVM_DIR=&quot;$([ -z &quot;$&#123;XDG_CONFIG_HOME-&#125;&quot; ] &amp;&amp; printf %s &quot;$&#123;HOME&#125;/.nvm&quot; || printf %s &quot;$&#123;XDG_CONFIG_HOME&#125;/nvm&quot;)&quot;</span><br><span class="line">[ -s &quot;$NVM_DIR/nvm.sh&quot; ] &amp;&amp; \. &quot;$NVM_DIR/nvm.sh&quot; # This loads nvm</span><br></pre></td></tr></table></figure>

<p>node.js 설치</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">~$ nvm ls-remote</span><br><span class="line">        v14.0.0</span><br><span class="line">        v14.1.0</span><br><span class="line">       v14.14.0</span><br><span class="line">       v14.15.0   (LTS: Fermium)</span><br><span class="line">       v14.15.1   (Latest LTS: Fermium)</span><br></pre></td></tr></table></figure>

<p>lts 최신 버전 14.0을 설치한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">~$ nvm install --lts 14.15.1</span><br><span class="line">Downloading and installing node v14.15.1...</span><br><span class="line">Downloading https://nodejs.org/dist/v14.15.1/node-v14.15.1-linux-x64.tar.xz...</span><br><span class="line"><span class="comment">######################################################################### 100.0%</span></span><br><span class="line">Computing checksum with <span class="built_in">sha256sum</span></span><br><span class="line">Checksums matched!</span><br><span class="line">Now using node v14.15.1 (npm v6.14.8)</span><br><span class="line">Creating default <span class="built_in">alias</span>: default -&gt; lts/* (-&gt; v14.15.1)</span><br></pre></td></tr></table></figure>

<p>node 버전을 확인</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~$ node --version</span><br><span class="line">v14.15.1</span><br></pre></td></tr></table></figure>

<h2 id="Conda-에서-jupyterlab-설치"><a href="#Conda-에서-jupyterlab-설치" class="headerlink" title="Conda 에서 jupyterlab 설치"></a>Conda 에서 jupyterlab 설치</h2><p>Anaconda 나 Miniconda 를 설치하고 가상환경을 하나 생성한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ conda create -n tf2 jupyterlab numpy scipy matplotlib tensorflow</span><br><span class="line"></span><br><span class="line">$ conda activate tf2</span><br><span class="line">(tf2) ~$</span><br></pre></td></tr></table></figure>

<h1 id="JupyterLab-실행"><a href="#JupyterLab-실행" class="headerlink" title="JupyterLab 실행"></a>JupyterLab 실행</h1><p>가상환경에서 jupyterlab 을 외부에서 접속 가능하도록 실행하자.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(base) $ jupyter-lab --no-browser --ip=* --port=8888 ~/Jupyter-Notebook/</span><br></pre></td></tr></table></figure>

<h4 id="LabConfig-디렉토리"><a href="#LabConfig-디렉토리" class="headerlink" title="LabConfig 디렉토리"></a>LabConfig 디렉토리</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ jupyter --paths</span><br><span class="line">config:</span><br><span class="line">    /home/qkboo/.jupyter</span><br><span class="line">    /home/qkboo/anaconda3/envs/py3/etc/jupyter</span><br><span class="line">    /usr/local/etc/jupyter</span><br><span class="line">    /etc/jupyter</span><br><span class="line">data:</span><br><span class="line">    /home/qkboo/.local/share/jupyter</span><br><span class="line">    /home/qkboo/anaconda3/envs/py3/share/jupyter</span><br><span class="line">    /usr/local/share/jupyter</span><br><span class="line">    /usr/share/jupyter</span><br><span class="line">runtime:</span><br><span class="line">    /home/qkboo/.local/share/jupyter/runtime</span><br></pre></td></tr></table></figure>

<h1 id="JupyterLab-환경-설정"><a href="#JupyterLab-환경-설정" class="headerlink" title="JupyterLab 환경 설정"></a>JupyterLab 환경 설정</h1><p>jupyter 의 config 파일을 통해서 인증과 구성을 하자.</p>
<ul>
<li>jupyterlab 3.x 버전: jupyter_server_config.py</li>
<li>jupyterlab 2.x 버전: jupyter_notebook_config.py</li>
</ul>
<p>Jupyter Lab 에서 설정 파일을 생성한다. 다음 명령으로 각각 <code>$HOME/.jupyter/</code> 위치에 jupyter_server_config.py 파일이 생성된다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(tf2)$ jupyter lab --generate-config</span><br><span class="line">Writing default config to: /home/qkboo/.jupyter/jupyter_server_config.py</span><br></pre></td></tr></table></figure>

<h3 id="패스워드-사용"><a href="#패스워드-사용" class="headerlink" title="패스워드 사용"></a>패스워드 사용</h3><p>jupyter_notebook_config.py 설정 파일에 비밀번호를 추가하려면 비밀번호를 생성해야 한다. 아래 명령으로 생성한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(tf2)$ jupyter lab password</span><br><span class="line">Enter password:</span><br><span class="line">Verify password:</span><br><span class="line">[NotebookPasswordApp] Wrote hashed password to <span class="variable">$HOME</span>\.jupyter\jupyter_server_config.json</span><br></pre></td></tr></table></figure>

<p><code>jupyter_server_config.json</code> 파일로 암호가 생성된다. 생성한 암호를 <code>jupyter_server_config.py</code> 파일의 <strong><em>c.ServerApp.password</em></strong> 항목에 입력해 준다</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[jupyter_server_config.py]</span><br><span class="line"></span><br><span class="line">c.ServerApp.password = <span class="string">&#x27;sha1:*********&#x27;</span>    <span class="comment"># 외부 접속시 사용할 비밀번호</span></span><br><span class="line">c.ServerApp.ip = <span class="string">&#x27;*&#x27;</span>                       <span class="comment"># 어디서든 접속 가능</span></span><br><span class="line">c.ServerApp.port = 8888                       <span class="comment"># 접속에 사용할 포트</span></span><br></pre></td></tr></table></figure>

<p>Jupyter Lab 3.x 버전</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">c.ServerApp.base_url = <span class="string">&#x27;/notebook&#x27;</span></span><br><span class="line">c.ServerApp.enable_mathjax = <span class="literal">True</span></span><br><span class="line">c.ServerApp.password = <span class="string">&#x27;&#x27;</span></span><br><span class="line">c.ServerApp.ip = <span class="string">&#x27;*&#x27;</span></span><br><span class="line">c.ServerApp.port = <span class="number">8888</span></span><br><span class="line">c.ServerApp.port_retries = <span class="number">10</span></span><br><span class="line">c.ServerApp.open_browser = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">c.ServerApp.tornado_settings = &#123;<span class="string">&quot;websocket_max_message_size&quot;</span>: <span class="number">400</span> * <span class="number">1024</span> * <span class="number">1024</span>&#125;</span><br></pre></td></tr></table></figure>

<p>Jupyter Notebook, Jupyterlab 2.x 버전:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">c.NotebookApp.base_url = <span class="string">&#x27;/notebook&#x27;</span></span><br><span class="line">c.NotebookApp.enable_mathjax = <span class="literal">True</span></span><br><span class="line">c.NotebookApp.password = <span class="string">&#x27;&#x27;</span></span><br><span class="line">c.NotebookApp.ip = <span class="string">&#x27;*&#x27;</span></span><br><span class="line">c.NotebookApp.port = <span class="number">8888</span></span><br><span class="line">c.NotebookApp.port_retries = <span class="number">10</span></span><br><span class="line">c.NotebookApp.open_browser = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">c.NotebookApp.tornado_settings = &#123;<span class="string">&quot;websocket_max_message_size&quot;</span>: <span class="number">400</span> * <span class="number">1024</span> * <span class="number">1024</span>&#125;</span><br></pre></td></tr></table></figure>

<h1 id="systemd-구성"><a href="#systemd-구성" class="headerlink" title="systemd 구성"></a>systemd 구성</h1><p>nodejs, jupyter lab 을 시스템 시작 서비스로 등록한다. node.js 경로, jupyterlab 을 위한 시작 환경이 필요하다.</p>
<blockquote>
<p>systemd의 unit 위치는 OS 마다 조금 다른 것 같다. </p>
</blockquote>
<p>여기서는 &#x2F;etc&#x2F;systemd&#x2F;system 밑에 jupyter.service 라는 유닛 파일에 아래 같이 파이썬 환경을 포함해 작성한다.</p>
<p>가상환경을 사용하고 있으므로 systemd unit의 ExecStart 의 python도 가상환경 위치로 지정해 주어야 한다.</p>
<p>유닛 파일: <code>/etc/systemd/system/jupyter.service</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=My Jupyter-Notebook</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line">PIDFile=/run/jupyter-notebook.pid</span><br><span class="line"># nodejs path</span><br><span class="line">Environment=<span class="string">&quot;PATH=/home/qkboo/.nvm/versions/node/v12.18.0/bin/:/usr/local/bin:/ usr/local/sbin:/usr/bin:/bin:/usr/sbin:/sbin&quot;</span></span><br><span class="line"></span><br><span class="line"># anaconda: tf2</span><br><span class="line">ExecStart=/home/qkboo/anaconda3/envs/tf2/bin/jupyter-lab --config /home/qkboo/Home/mybook_config.py</span><br><span class="line">User=qkboo</span><br><span class="line">Group=qkboo</span><br><span class="line">WorkingDirectory=/home/qkboo/Home/Jupyter-Notebook/</span><br><span class="line">Restart=always</span><br><span class="line">RestartSec=<span class="number">10</span></span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>

<h2 id="유닛-파일-등록과-시작"><a href="#유닛-파일-등록과-시작" class="headerlink" title="유닛 파일 등록과 시작"></a>유닛 파일 등록과 시작</h2><p>jupyter.service 파일을 등록한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl <span class="built_in">enable</span> jupyter</span><br></pre></td></tr></table></figure>

<p>등록한 유닛 파일을 확인해 보자.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl list-unit-files | grep jupyter</span><br><span class="line">jupyter_book.service                disabled        enabled</span><br><span class="line">jupyter.service                     enabled         enabled</span><br></pre></td></tr></table></figure>

<p>그리고 데몬을 리로드 한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl daemon-reload</span><br><span class="line">$ sudo systemctl start jupyter</span><br></pre></td></tr></table></figure>

<p>실행한 서비스를 종료하려면</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl stop jupyter</span><br></pre></td></tr></table></figure>


<p>실행 상태를 확인한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl status jupyter</span><br></pre></td></tr></table></figure>


<h2 id="유닛-파일-등록-해지"><a href="#유닛-파일-등록-해지" class="headerlink" title="유닛 파일 등록 해지"></a>유닛 파일 등록 해지</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl <span class="built_in">disable</span> jupyter</span><br><span class="line">Removed /etc/systemd/system/multi-user.target.wants/jupyter.service.</span><br></pre></td></tr></table></figure>

<h2 id="서비스-상태"><a href="#서비스-상태" class="headerlink" title="서비스 상태"></a>서비스 상태</h2><p>해당 서비스 상태 확인</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl status jupyter</span><br></pre></td></tr></table></figure>

<p>구동에 실패한 서비스 보기</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl list-units --state=failed</span><br></pre></td></tr></table></figure>

<p>enabled 상태인 서비스 목록</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl list-units --state=enabled</span><br></pre></td></tr></table></figure>


<hr>
</div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/images/qkboo_400.png" alt="Gangtai"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Gangtai</p><p class="is-size-6 is-block">Your title</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Paju, South Korea</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">포스트</p><a href="/archives"><p class="title">154</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">카테고리</p><a href="/categories"><p class="title">17</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">태그</p><a href="/tags"><p class="title">235</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/thinkbee" target="_blank" rel="noopener">팔로우</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/thinkbee"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/gangtaigoh"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">최근 글</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-10-04T05:00:00.000Z">2023-10-04</time></p><p class="title"><a href="/understranding_unicode-f121f811ea9f/">유니코드 이해하기</a></p><p class="categories"><a href="/categories/Programming/">Programming</a> / <a href="/categories/Programming/Python/">Python</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-07-27T12:00:00.000Z">2023-07-27</time></p><p class="title"><a href="/jupyterlab_upgrade_3_to_4-10265c5617ef/">Jupyterlab 4 업그레이드 주의 사항.</a></p><p class="categories"><a href="/categories/Programming/">Programming</a> / <a href="/categories/Programming/Python/">Python</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-07-18T04:00:00.000Z">2023-07-18</time></p><p class="title"><a href="/2022-03-01-oracle_xe_installation-b90fe1d48548/">Oracle XE Database 설치 - Windows</a></p><p class="categories"><a href="/categories/Programming/">Programming</a> / <a href="/categories/Programming/Database/">Database</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-07-17T18:00:00.000Z">2023-07-18</time></p><p class="title"><a href="/ubuntu-20.04-cheat_sheet-230a7dc631bf/">Ubuntu 20.04 - Cheat sheet</a></p><p class="categories"><a href="/categories/OS/">OS</a> / <a href="/categories/OS/Linux/">Linux</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-07-17T10:00:00.000Z">2023-07-17</time></p><p class="title"><a href="/hexo04-modification1-e97f98e3fc30/">hexo 의 icarus theme 수정하기</a></p><p class="categories"><a href="/categories/ETC/">ETC</a></p></div></article></div></div><div class="card widget" data-type="adsense"><div class="card-content"><div class="menu"><h3 class="menu-label">광고</h3><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-1465716454138955" data-ad-slot="4441624809" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">카테고리</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/AI/"><span class="level-start"><span class="level-item">AI</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/ETC/"><span class="level-start"><span class="level-item">ETC</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/IT/"><span class="level-start"><span class="level-item">IT</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/OS/"><span class="level-start"><span class="level-item">OS</span></span><span class="level-end"><span class="level-item tag">52</span></span></a><ul><li><a class="level is-mobile" href="/categories/OS/Linux/"><span class="level-start"><span class="level-item">Linux</span></span><span class="level-end"><span class="level-item tag">28</span></span></a></li><li><a class="level is-mobile" href="/categories/OS/Raspberry-Pi/"><span class="level-start"><span class="level-item">Raspberry Pi</span></span><span class="level-end"><span class="level-item tag">21</span></span></a></li><li><a class="level is-mobile" href="/categories/OS/Windows/"><span class="level-start"><span class="level-item">Windows</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Programming/"><span class="level-start"><span class="level-item">Programming</span></span><span class="level-end"><span class="level-item tag">81</span></span></a><ul><li><a class="level is-mobile" href="/categories/Programming/Android/"><span class="level-start"><span class="level-item">Android</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/Angularjs/"><span class="level-start"><span class="level-item">Angularjs</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/C-C/"><span class="level-start"><span class="level-item">C/C++</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/Database/"><span class="level-start"><span class="level-item">Database</span></span><span class="level-end"><span class="level-item tag">17</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/Nodejs/"><span class="level-start"><span class="level-item">Nodejs</span></span><span class="level-end"><span class="level-item tag">20</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/Python/"><span class="level-start"><span class="level-item">Python</span></span><span class="level-end"><span class="level-item tag">27</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/R/"><span class="level-start"><span class="level-item">R</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/git/"><span class="level-start"><span class="level-item">git</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/github/"><span class="level-start"><span class="level-item">github</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li></ul></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/images/thinkbee_logo.png" alt="IT Tech blogging" height="28"></a><p class="is-size-7"><span>&copy; 2023 Gangtai Goh</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("ko");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="맨 위로" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-right",
        content: {
          message: "이 웹 사이트는 귀하의 경험을 향상시키기 위해 Cookie를 사용합니다.",
          dismiss: "무시",
          allow: "허용",
          deny: "거부",
          link: "더 알아보기",
          policy: "Cookie 정책",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="입력 하세요..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"입력 하세요...","untitled":"(제목 없음)","posts":"포스트","pages":"페이지","categories":"카테고리","tags":"태그"});
        });</script></body></html>