<!doctype html>
<html lang="ko"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta><title>카테고리: Raspberry Pi - Blogging through Programming</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="thinkbee blog"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="thinkbee blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="Blogging through Programming"><meta property="og:url" content="http://example.com/"><meta property="og:site_name" content="Blogging through Programming"><meta property="og:locale" content="ko_KR"><meta property="og:image" content="http://example.com/img/og_image.png"><meta property="article:author" content="John Doe"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com"},"headline":"Blogging through Programming","image":["http://example.com/img/og_image.png"],"author":{"@type":"Person","name":"John Doe"},"publisher":{"@type":"Organization","name":"Blogging through Programming","logo":{"@type":"ImageObject","url":"http://example.com/images/thinkbee_logo.png"}},"description":""}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><script data-ad-client="ca-pub-1465716454138955" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script><meta name="generator" content="Hexo 6.0.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/images/thinkbee_logo.png" alt="Blogging through Programming" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/thinkbee"><i class="fab fa-github"></i></a><a class="navbar-item search" title="검색" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/categories">카테고리</a></li><li class="is-active"><a href="#" aria-current="page">Raspberry Pi</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2018-07-13T16:00:00.000Z" title="2018-7-14 1:00:00">2018-07-14</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2022-02-24T16:16:51.971Z" title="2022-2-25 1:16:51">2022-02-25</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Raspberry-Pi/">Raspberry Pi</a><span> / </span><a class="link-muted" href="/categories/Raspberry-Pi/Linux/">Linux</a></span><span class="level-item">6분안에 읽기 (약 895 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/07/14/raspberrypi-2018-07-14-opensuse-firewalld-start/">Getting Started `firewalld`</a></h1><div class="content"><p>RedHat, CentOS, Fedora 배포본 등에서 표준 방화벽 인터페이스로 제공되는 최신 <strong>FirewallD</strong> 사용을 시작해 보자. <code>firewalld</code> 패키지 설치는 각 배포본의 방법으로 설치하면 된다.</p>
<p>여기서는 OpenSUSE, Armbian 배포본을 설치한 시스템에서 <code>firewalld</code> 방화벽을 구성하고 설정하는 과정을 요약 정리했다.</p>
<h2 id="Getting-Started-FirewallD"><a href="#Getting-Started-FirewallD" class="headerlink" title="Getting Started - FirewallD"></a>Getting Started - FirewallD</h2><p>sudo systemctl enable firewalld<br>sudo reboot</p>
<p>We can verify that the service is running and reachable by typing:</p>
<p>sudo firewall-cmd –state</p>
<p>firewalld는 Zone 을 기반으로 서비스, 포트, IP 주소 등을 다양한 규칙으로 혼합해 사용할 수 있다.</p>
<p>기본으로 지원하는 zone은 다음 같다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo firewall-cmd --get-zones</span><br><span class="line">block dmz drop external home internal public trusted work</span><br></pre></td></tr></table></figure>

<p>그리고 permanent로 활성화된 Zone은</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sudo firewall-cmd --get-active-zones</span><br><span class="line">drop</span><br><span class="line">  sources: ipset:blacklist</span><br><span class="line">trusted</span><br><span class="line">  sources: 192.168.0.0/24 220.121.170.0/24</span><br></pre></td></tr></table></figure>


<h3 id="Public-Zone에-Http-Ssh-서비스"><a href="#Public-Zone에-Http-Ssh-서비스" class="headerlink" title="Public Zone에 Http, Ssh 서비스"></a>Public Zone에 Http, Ssh 서비스</h3><p>http, https 를 공개 서비스를 지원하는 기본 public zone에 추가한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo firewall-cmd --add-service=ssh</span><br><span class="line">$ sudo firewall-cmd --add-service=http</span><br><span class="line">$ sudo firewall-cmd --add-service=https</span><br></pre></td></tr></table></figure>


<p>혹은 zone을 지정해서 서비스를 추가할 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo firewall-cmd --zone=public --add-service=ssh</span><br><span class="line">$ sudo firewall-cmd --zone=public --add-service=http</span><br><span class="line">$ sudo firewall-cmd --zone=public --add-service=https</span><br></pre></td></tr></table></figure>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo firewall-cmd --zone=public --remove-service=ssh</span><br></pre></td></tr></table></figure>

<p>public zone에 대한 정보를 출력한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ sudo firewall-cmd --list-all</span><br><span class="line">public</span><br><span class="line">  target: default</span><br><span class="line">  icmp-block-inversion: no</span><br><span class="line">  interfaces:</span><br><span class="line">  sources:</span><br><span class="line">  services: ssh dhcpv6-client http https</span><br><span class="line">  ports:</span><br><span class="line">  protocols:</span><br><span class="line">  masquerade: no</span><br><span class="line">  forward-ports:</span><br><span class="line">  source-ports:</span><br><span class="line">  icmp-blocks:</span><br><span class="line">  rich rules:</span><br></pre></td></tr></table></figure>


<h3 id="Trusted-Zone-관리"><a href="#Trusted-Zone-관리" class="headerlink" title="Trusted Zone 관리"></a>Trusted Zone 관리</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo firewall-cmd --zone=trusted --add-service=ssh </span><br></pre></td></tr></table></figure>


<p>trusted zone의 IP 범위를 소스로 지정할 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo firewall-cmd --zone=trusted --add-service=dns</span><br><span class="line">$ sudo firewall-cmd --zone=trusted --add-source=192.168.1.0/24</span><br></pre></td></tr></table></figure>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=zone-name --remove-source=&lt;source&gt;</span><br></pre></td></tr></table></figure>


<p>Trusted Zone의 정보를 출력한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo firewall-cmd --zone=trusted --list-all</span><br></pre></td></tr></table></figure>


<h3 id="Port"><a href="#Port" class="headerlink" title="Port"></a>Port</h3><p>포트에 따라 는 프로토콜을 지정해 줄 수 있다. 지정되지 않으면 기본 TCP 포트가 구성된다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --remove-port=port-number/port-type</span><br></pre></td></tr></table></figure>

<p>대체 http 포트인 8080을 추가해 보자.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo firewall-cmd --zone=public --add-port=8080/tcp</span><br></pre></td></tr></table></figure>

<p>mongodb 같은 내부 데이터베이스 포트를 <em>trusted</em> zone에 추가해 준다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo firewall-cmd --zone=trusted --add-port=27017/tcp</span><br></pre></td></tr></table></figure>

<p>포트 범위를 지정해 구성할 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo firewall-cmd --zone=public --add-port=4990-4999/udp</span><br></pre></td></tr></table></figure>

<p>포트를 제거할 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo firewall-cmd --zone=zone-name --remove-source-port=&lt;port-name&gt;/&lt;tcp|udp|sctp|dccp&gt;</span><br></pre></td></tr></table></figure>


<p>Zone에 구성된 포트 정보를 출력할 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo firewall-cmd --zone=public --list-ports</span><br><span class="line">sudo firewall-cmd --zone=trusted --list-ports</span><br></pre></td></tr></table></figure>

<p>여기까지 <code>firewall-cmd</code> 로 설정한 내용은 실행중(런타임) 방화벽으로 구성되어 사용된다. 재시동 등의 이벤트가 발생하면 내용이 사라지게 된다. 영구적으로 보존하기 위해서는 <code>--permanent</code> 옵션을 사용해야 한다.</p>
<h3 id="Permenent"><a href="#Permenent" class="headerlink" title="Permenent"></a>Permenent</h3><p>Zone 에 구성한 서비스, 포트, 소스, 프로토콜 등에 대한 설정을 영구적으로 보존해려면 <code>--permanent</code> 옵션을 사용해야 한다. 영구적인 구성을 설정을 보존하려면 아래 두가지 방법을 사용한다.</p>
<p>먼저 <code>firewall-cmd</code> 로 실행중 제한 내용을 구성하고, <code>--runtime-to-permanent</code> 를 실행해 준다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --runtime-to-permanent</span><br></pre></td></tr></table></figure>

<p>다른 방법을 <code>firewall-cmd</code> 에 <code>--permanent</code> 옵션을 주고 실행하면 영구 보존되어 저장된다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --permanent &lt;other options&gt;</span><br></pre></td></tr></table></figure>


<h3 id="reload"><a href="#reload" class="headerlink" title="reload"></a>reload</h3><p>방화벽을 갱신한다</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --reload</span><br><span class="line">firewall-cmd --state</span><br><span class="line">firewall-cmd --list-all                #public</span><br><span class="line">firewall-cmd --permanent --list-all    #permanent</span><br></pre></td></tr></table></figure>


<br>


<h2 id="참조"><a href="#참조" class="headerlink" title="참조"></a>참조</h2><p><a target="_blank" rel="noopener" href="https://www.hogarthuk.com/?q=node/9">Firewalld configuration and usage</a></p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/security_guide/sec-using_firewalls#sec-Getting_started_with_firewalld">RedHat: Getting started with firewalld</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-firewall-using-firewalld-on-centos-7">How to set up firewalld on CentOS 7</a></p>
</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2018-07-10T00:00:00.000Z" title="2018-7-10 9:00:00">2018-07-10</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2022-02-24T16:16:51.970Z" title="2022-2-25 1:16:51">2022-02-25</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Raspberry-Pi/">Raspberry Pi</a><span> / </span><a class="link-muted" href="/categories/Raspberry-Pi/Linux/">Linux</a></span><span class="level-item">9분안에 읽기 (약 1392 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/07/10/raspberrypi-2018-07-10-opensuse-upgrade-42-2-to-42-3/">Raspberry Pi : Upgrade OpenSUSE LEAP 42.2 to 42.3</a></h1><div class="content"><p>Raspberry Pi 3 에 설치해 사용중이던 openSUSE LEAP 42.2의 지원이 종료되어, 2019년가지 지원하는 LEAP 42.3으로 업그레이드하는 과정을 정리했다. </p>
<blockquote>
<p>openSUSE는 LEAP 15.0으로 최신 버전으로 배포하고 있다. 42.2에서 15.0으로 바로 업그레이드시 내가 해결 못하는 문제가 생겨서 42.3으로 업그레이드 했다.</p>
</blockquote>
<h2 id="Upgrade-OpenSUSE-LEAP-42-2-to-42-3"><a href="#Upgrade-OpenSUSE-LEAP-42-2-to-42-3" class="headerlink" title="Upgrade OpenSUSE LEAP 42.2 to 42.3"></a>Upgrade OpenSUSE LEAP 42.2 to 42.3</h2><p>OpenSUSE LEAP 42.2 는 지원이 종료되어 42.3으로 업그레이드를 한다.</p>
<p><img src="/images/opensuse/opensuse-discontinued-201807.png">{: width&#x3D;”600”}</p>
<figcaption>[그림. 지원 중단 배포본 (OpenSUSE.com)]</figcaption>
<br>
업그레이드에 대한 과정은 [OpenSUSE System Upgrade](https://en.opensuse.org/SDB:System_upgrade) 에 나와있는데 42.3을 15.0으로 배포본 업그레이드 하는 과정과 일반 배포본에서 배포본 업그레이드가 설명되어 있어서 직접 시도하면서 정리했다.


<h3 id="Upgrade-시작"><a href="#Upgrade-시작" class="headerlink" title="Upgrade 시작"></a>Upgrade 시작</h3><p>먼저 42.2 저장소 URI를 42.3 으로 변경한다.</p>
<h4 id="42-3-Repository-Uri"><a href="#42-3-Repository-Uri" class="headerlink" title="42.3 Repository Uri"></a>42.3 Repository Uri</h4><p>현재 시스템의 Repository Uri를 확인해 보고</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$sudo zypper repos --uri</span><br><span class="line"></span><br><span class="line">Repository priorities are without effect. All enabled repositories share the same priority.</span><br><span class="line"></span><br><span class="line"># | Alias                             | Name                              | Enabled | GPG Check | Refresh | URI</span><br><span class="line">--+-----------------------------------+-----------------------------------+---------+-----------+---------+----------------------------------------------------------------------------</span><br><span class="line">1 | openSUSE-Ports-Leap-42.2-Update   | openSUSE-Ports-Leap-42.2-Update   | Yes     | (r ) Yes  | Yes     | http://download.opensuse.org/ports/update/42.2/</span><br><span class="line">2 | openSUSE-Ports-Leap-42.2-repo-oss | openSUSE-Ports-Leap-42.2-repo-oss | Yes     | (r ) Yes  | Yes     | http://download.opensuse.org/ports/aarch64/distribution/leap/42.2/repo/oss/</span><br></pre></td></tr></table></figure>

<p>다른 저장소를 추가하지 않고 사용했다면 LEAP 42.2 배포본 저장소는 위와 같을 것이다. 현재 Uri인 저장소 백업하고,</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sudo cp -Rv /etc/zypp/repos.d /etc/zypp/repos.d.Old</span><br></pre></td></tr></table></figure>


<p>위 목록에서 <em>openSUSE-Ports-Leap-42.2-repo-oss</em>를 제거한다. 목록 번호로 제거할 수 있어서 <code>rr 2</code> 명령으로 제거한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sudo zypper rr 2</span><br></pre></td></tr></table></figure>


<p>저장소 문자열 42.2 를 42.3 문자열로 치환한다</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sudo sed -i s/42.2/42.3/ /etc/zypp/repos.d/*</span><br></pre></td></tr></table></figure>

<p>여기에 앞에서 제거한 repo-oss 저장소를 LEAP 42.3을 위한 <strong>openSUSE-Leap-42.3-repo-oss</strong> 를 추가해 준다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sudo zypper addrepo --check --refresh --name &#x27;openSUSE-Leap-42.3-repo-oss&#x27; http://download.opensuse.org/ports/aarch64/distribution/leap/42.3/repo/oss/ repo-oss</span><br></pre></td></tr></table></figure>

<p>새 저장소 Uri를 추가하고 배포본의 Repository Url를 출력해서 Enabled 컬럼이 활성화 되어 있는지 확인한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$sudo zypper repos --uri</span><br><span class="line"># | Alias       | Name                        | Enabled | GPG Check | Refresh | URI</span><br><span class="line">--+-------------+-----------------------------+---------+-----------+---------+----------------------------------------------------------------------------</span><br><span class="line">1 | repo-oss    | openSUSE-Leap-42.3-repo-oss | Yes     | (r ) Yes  | Yes     | http://download.opensuse.org/ports/aarch64/distribution/leap/42.3/repo/oss/</span><br><span class="line">2 | repo-update | openSUSE-Leap-42.3-Update   | Yes     | (r ) Yes  | Yes     | http://download.opensuse.org/update/leap/42.3/oss/</span><br></pre></td></tr></table></figure>

<p>만약 출력한 저장소 목록에서 Enabled 컬럼이 No 라면 다음 명령으로 활성화 한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sudo zypper modifyrepo --enable openSUSE-Leap-42.3-repo-oss</span><br></pre></td></tr></table></figure>

<p>이제 42.3을 위한 저장소 Uri가 정리되었다.</p>
<p>실제 배포본 버전을 업그레이드 하기 위해서는 <code>dup</code> 명령을 내려 실행해야 하지만 역시 42.2를 15.0으로 직접 배포본 업그레이드 했을 때 문제가 발생해서 설치된 패키지를 업르레이드하고 배포본 업그레이드를 진행했다.</p>
<h4 id="Distribution-Upgrade"><a href="#Distribution-Upgrade" class="headerlink" title="Distribution Upgrade"></a>Distribution Upgrade</h4><p>먼저 저장소에서 패키지 목록을 최신으로 갱신하고, package upgrade를 진행해 준다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">zypper ref</span><br><span class="line">zypper up</span><br></pre></td></tr></table></figure>

<p>오에스에서 사용하는 패키지가 많기 때문에 패키지 업그레이드 과정은 꽤 긴 시간이 필요하다. </p>
<p>과정중에 펌웨어 버전 충돌이 나오면 Yes 해준다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Checking for file conflicts: ............................................[error]</span><br><span class="line">Detected 1 file conflict:</span><br><span class="line"></span><br><span class="line">File /lib/firmware/brcm/brcmfmac43430-sdio.bin</span><br><span class="line">  from install of</span><br><span class="line">     kernel-firmware-20170530-20.1.noarch (openSUSE-Leap-42.3-Update)</span><br><span class="line">  conflicts with file from package</span><br><span class="line">     bcm43xx-firmware-20160301-2.1.noarch (@System)</span><br><span class="line"></span><br><span class="line">File conflicts happen when two packages attempt to install files with the same name but different contents. If you continue, conflicting files will be replaced losing the previous content.</span><br><span class="line">Continue? [yes/no] (no): yes</span><br></pre></td></tr></table></figure>

<p>그리고 재시동을 해준다.</p>
<p>package upgrade를 완료한 후에 Distribution upgrade를 수행하자</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zypper dup</span><br></pre></td></tr></table></figure>



<h4 id="재시동"><a href="#재시동" class="headerlink" title="재시동"></a>재시동</h4><p>업그레이드를 설치한 후에 재시동 하면 약 5분 정도 펌웨어 등을 설치하는 과정을 거친다. 로그인 프롬프트에서 <em>openSUSE Leap 42.3</em> 이 보이면 성공한 것이다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Welcome to openSUSE Leap 42.3 - Kernel 4.4.104-18.44-default (ttyS0).</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">homepi64 login:</span><br></pre></td></tr></table></figure>


<h4 id="보안-패치"><a href="#보안-패치" class="headerlink" title="보안 패치"></a>보안 패치</h4><p>openSUSE는 upgrade와 patch 를 분리해서 제공한다. 패치는 보안 사항에 관련한 것을 제공하고 있다. <code>lp</code> 로 다운로드 가능한 패치를 확인할 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># zypper lp</span><br><span class="line">Retrieving repository &#x27;openSUSE-Leap-42.3-Update&#x27; metadata ..................[done]</span><br><span class="line">Building repository &#x27;openSUSE-Leap-42.3-Update&#x27; cache .......................[done]</span><br><span class="line">Loading repository data...</span><br><span class="line">Reading installed packages...</span><br><span class="line"></span><br><span class="line">Repository                | Name               | Category    | Severity  | Interactive | Status | Summary</span><br><span class="line">--------------------------+--------------------+-------------+-----------+-------------+--------+-----------------------------------------------------------------------</span><br><span class="line">openSUSE-Leap-42.3-Update | openSUSE-2017-1268 | security    | important | ---         | needed | Security update for webkit2gtk3</span><br><span class="line">openSUSE-Leap-42.3-Update | openSUSE-2017-1425 | recommended | low       | ---         | needed | Recommended update for grub2</span><br><span class="line">openSUSE-Leap-42.3-Update | openSUSE-2017-940  | security    | important | ---         | needed | Security update for subversion</span><br><span class="line">openSUSE-Leap-42.3-Update | openSUSE-2018-118  | security    | important | ---         | needed | Security update for webkit2gtk3</span><br><span class="line">openSUSE-Leap-42.3-Update | openSUSE-2018-234  | recommended | low       | ---         | needed | Recommended update for grub2</span><br><span class="line">openSUSE-Leap-42.3-Update | openSUSE-2018-241  | recommended | moderate  | ---         | needed | Recommended update for yast2, yast2-nfs-client, yast2-services-manager</span><br><span class="line">openSUSE-Leap-42.3-Update | openSUSE-2018-586  | recommended | low       | ---         | needed | Recommended update for grub2</span><br><span class="line"></span><br><span class="line">Found 7 applicable patches:</span><br><span class="line">7 patches needed (3 security patches)</span><br></pre></td></tr></table></figure>

<p>패치는 보안 이슈에 대한 것으로 해당 보안 이슈 정보 혹은 분류 등을 확인할 수 있다. 목록에서 Name 컬럼이 발생한 보안 사항 번호로 이 번호로 조회할 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zypper info openSUSE-2017-462</span><br></pre></td></tr></table></figure>

<p>패키지 내용은 CVE(Common Vulnerabilities and Exposures)로 보고된 보안 사항을 적용한 내용을 자세히 보여주고 있다.</p>
<p>패치 중에서 Category로 검색할 수 있다. 다음 같이 security 분류만 검색할 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">zypper lp --category security</span><br><span class="line">Loading repository data...</span><br><span class="line">Reading installed packages...</span><br><span class="line"></span><br><span class="line">Repository                | Name               | Category | Severity  | Interactive | Status | Summary</span><br><span class="line">--------------------------+--------------------+----------+-----------+-------------+--------+--------------------------------</span><br><span class="line">openSUSE-Leap-42.3-Update | openSUSE-2017-1268 | security | important | ---         | needed | Security update for webkit2gtk3</span><br><span class="line">openSUSE-Leap-42.3-Update | openSUSE-2017-940  | security | important | ---         | needed | Security update for subversion</span><br><span class="line">openSUSE-Leap-42.3-Update | openSUSE-2018-118  | security | important | ---         | needed | Security update for webkit2gtk3</span><br><span class="line"></span><br><span class="line">Considering 3 out of 7 applicable patches:</span><br><span class="line">3 patches needed (3 security patches)</span><br></pre></td></tr></table></figure>

<p>패치를 전체를 설치하려면</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo zypper patch</span><br></pre></td></tr></table></figure>

<p>혹은 패치 중에서 특정 패치만 설치할 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo zypper install patch:openSUSE-2017-1268</span><br></pre></td></tr></table></figure>


<h2 id="참조"><a href="#참조" class="headerlink" title="참조"></a>참조</h2><ul>
<li><a target="_blank" rel="noopener" href="https://en.opensuse.org/SDB:System_upgrade">OpenSUSE System Upgrade</a></li>
<li><a target="_blank" rel="noopener" href="https://lukerawlins.com/opensuse-patch-vs-update/">openSUSE Update &amp; Patch</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2018-06-22T00:10:00.000Z" title="2018-6-22 9:10:00">2018-06-22</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2022-02-24T16:16:51.968Z" title="2022-2-25 1:16:51">2022-02-25</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Raspberry-Pi/">Raspberry Pi</a><span> / </span><a class="link-muted" href="/categories/Raspberry-Pi/Linux/">Linux</a></span><span class="level-item">5분안에 읽기 (약 784 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/06/22/raspberrypi-2018-06-22-raspbian-1-prepare/">Raspberry Pi : Raspbian 설치준비</a></h1><div class="content"><p>이 글은 Raspberry Pi Programming 과정을 진행하며 강의한 자료를 바탕으로 공개강의를 위한 텍스트로 <em>슬라이드쉐어</em>, <em>blog.thinkbee.kr</em> 그리고 실제 과정을 영상 <em>youtube</em> 채널에 공개할 목적으로 작성한다.</p>
<p>Install Rasbperry Pi 글타래는 아래 같이 구성되며 간단한 소개, Serial console, OS 설치,  Service 구성 및 사용에 대해 작성했다.</p>
<ol>
<li><strong>Raspberry Pi 설치준비</strong></li>
<li><strong><a href="!--swig%EF%BF%BC0--">Install Raspbian OS</a></strong></li>
<li>Managing Service daemon</li>
<li>Basic OS Security for Server</li>
<li><a href="!--swig%EF%BF%BC1--">Install &amp; Configuration - Nginx, Node JS, Jupyter</a></li>
</ol>
<blockquote>
<p>2017-10-30: swap 추가, timezone 수정<br>{:.right-history}</p>
</blockquote>
<h2 id="Raspbery-Pi-OS-설치준비"><a href="#Raspbery-Pi-OS-설치준비" class="headerlink" title="Raspbery Pi OS 설치준비"></a>Raspbery Pi OS 설치준비</h2><p>*Raspberry Pi(라즈베리파이)*에 <em>Serial Console</em> 을 연결하고, Raspbian, Ubuntu 등을 설치한 후에 라즈베리파이를 처음 설정하고 <em>SSH</em> 구성을 활성화 하겠다.</p>
<p>라즈베리파이에 OS를 설치하기 위해서는 <strong>NOOBS</strong>를 사용하거나 <strong>오에스 이미지</strong>를 다운받아 SD Card에 구워서 사용한다. 라즈베리파이는 다음과 같은 OS 배포본을 사용할 수 있다. </p>
<table>
<thead>
<tr>
<th>운영체제</th>
<th>특징</th>
</tr>
</thead>
<tbody><tr>
<td>Raspbian (Debian)</td>
<td>Raspberry Pi + Debian의 합성어, 가장 범용 OS.</td>
</tr>
<tr>
<td>Arch Linux (A non-Linux Distribution)</td>
<td>ARM 프로세서를 지원하는 Arch Linux</td>
</tr>
<tr>
<td>RISC OS</td>
<td>ARM 프로세서를 위한 실시가(RTOS) 운영체제</td>
</tr>
<tr>
<td>OpenElec</td>
<td>XBMC 미디어 센터 지원을 위한 운영체제</td>
</tr>
<tr>
<td>RaspBMC</td>
<td>XBMC 미디어 센터 지원을 위한 운영체제</td>
</tr>
<tr>
<td>Pidora</td>
<td>Pi + Fedora 운영체제</td>
</tr>
</tbody></table>
<p>**Raspbian(라즈비안)**은 라즈베리파이를 위한 데비안 리눅스로 가장 대중적인 데비안 리눅스, 우분투와 같은 사용자 경험을 제공해 주고 있다.</p>
<h3 id="Raspberry-Pi-설치-준비"><a href="#Raspberry-Pi-설치-준비" class="headerlink" title="Raspberry Pi 설치 준비"></a>Raspberry Pi 설치 준비</h3><p>Raspberry Pi의 GPIO에 배치된 UART Rx, Tx 포트와 시리얼 케이블의 Tx, Rx로 크로스 연결하면 시리얼 콘솔로 작동한다.</p>
<p>설치에 앞서 준비해야 할 것이 있다. </p>
<ul>
<li>Raspberry Pi 1, 2, 3</li>
<li>SD Memory Card: 8GB 이상, Class6 이상</li>
<li>USB to Serial Cable</li>
</ul>
<h4 id="Raspberry-Pi"><a href="#Raspberry-Pi" class="headerlink" title="Raspberry Pi"></a>Raspberry Pi</h4><p>Raspberry Pi의 GPIO에 배치된 UART Rx, Tx 포트와 시리얼 케이블의 Tx, Rx로 크로스 연결하면 시리얼 콘솔로 작동한다.</p>
<p><img src="/images/raspberrypi/rapi_config-serial.png">{:with&#x3D;”500”}</p>
<h4 id="SD-Memory-Card"><a href="#SD-Memory-Card" class="headerlink" title="SD Memory Card"></a>SD Memory Card</h4><p>라즈베리파이는 SD Meory Card 카드에서 부팅 및 운영 하도록 되어 있다. </p>
<ul>
<li><strong>NOOBS</strong>를 이용한다면 최소 8GB</li>
<li>다른 버전은 최소 4GB</li>
<li>Class 4는 4MB&#x2F;s 쓰기 속도, Class 10은 10MB&#x2F;s 쓰기가 가능하지만 Class 10이 Class 4를 앞선다는 것을 보장하진 않는다. 라즈베리파이는 Class 6의 8GB 사용을 권장하고 있다.</li>
</ul>
<figure>그림.</figure>

<p>SDCardFormatter</p>
<p><a target="_blank" rel="noopener" href="http://v.media.daum.net/v/20180630101105544">PCIe 지원 SD Card 규격 7.0</a></p>
<h4 id="USB-to-Serial-Cable"><a href="#USB-to-Serial-Cable" class="headerlink" title="USB to Serial Cable"></a>USB to Serial Cable</h4><p>USB 주변기기가 대중화 되면 컴퓨터에 Serial port가 사라진 후에 <em>USB to TTL</em> 혹은 <em>USB to Serial</em> 로 Serial 케이블을 사용해야 한다. </p>
<p>구글 검색을 해보면 DB-9 포트 형태, 보드 형태 및 Raspberry Pi 같은 SBC 보드의 GPIO 포트에 사용하기 좋은 Adarfruit 판매하는 핀 형태의 제품도 있다.</p>
<p><img src="/images/raspberrypi/usb-serial-cables.png">{: width&#x3D;”600” }</p>
<figure>그림.USB to Serial Cable(구글 이미지 검색 캡쳐)</figure>



</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2018-06-22T00:10:00.000Z" title="2018-6-22 9:10:00">2018-06-22</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2022-02-24T16:16:51.969Z" title="2022-2-25 1:16:51">2022-02-25</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Raspberry-Pi/">Raspberry Pi</a><span> / </span><a class="link-muted" href="/categories/Raspberry-Pi/Linux/">Linux</a></span><span class="level-item">23분안에 읽기 (약 3456 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/06/22/raspberrypi-2018-06-22-raspbian-2-os-install/">Raspberry Pi : Install Raspbian</a></h1><div class="content"><p>Install Rasbperry Pi OS 글타래는 아래 같이 구성되며 OS 설치, Service 구성 및 사용에 대해 작성한다.</p>
<ol>
<li><strong><a href="!--swig%EF%BF%BC30--">Raspberry Pi 설치준비</a></strong></li>
<li><strong>Install Raspbian OS</strong></li>
<li>Managing Service daemon</li>
<li>Basic OS Security for Server</li>
<li><a href="!--swig%EF%BF%BC31--">Install &amp; Configuration - Nginx, Node JS, Jupyter</a></li>
</ol>
<blockquote>
<p>2017-10-30: swap 추가, timezone 수정<br>{:.right-history}</p>
</blockquote>
<h2 id="Install-Raspbian-OS"><a href="#Install-Raspbian-OS" class="headerlink" title="Install Raspbian OS"></a>Install Raspbian OS</h2><p>Raspberry Pi(라즈베리파이)에 Raspbian, Ubuntu 등을 설치하고 <em>Serial Console</em> 을 이용해서, 라즈베리파이를 처음 설정하고 <em>SSH</em> 구성을 활성화 하겠다.</p>
<p>라즈베리파이에 OS를 설치하기 위해서는 <strong>NOOBS</strong>를 사용하거나 <strong>오에스 이미지</strong>를 다운받아 SD Card에 구워서 사용한다. 라즈베리파이는 다음과 같은 OS 배포본을 사용할 수 있다. </p>
<table>
<thead>
<tr>
<th>운영체제</th>
<th>특징</th>
</tr>
</thead>
<tbody><tr>
<td>Raspbian (Debian)</td>
<td>Raspberry Pi + Debian의 합성어, 가장 범용 OS.</td>
</tr>
<tr>
<td>Arch Linux (A non-Linux Distribution)</td>
<td>ARM 프로세서를 지원하는 Arch Linux</td>
</tr>
<tr>
<td>RISC OS</td>
<td>ARM 프로세서를 위한 실시가(RTOS) 운영체제</td>
</tr>
<tr>
<td>OpenElec</td>
<td>XBMC 미디어 센터 지원을 위한 운영체제</td>
</tr>
<tr>
<td>RaspBMC</td>
<td>XBMC 미디어 센터 지원을 위한 운영체제</td>
</tr>
<tr>
<td>Pidora</td>
<td>Pi + Fedora 운영체제</td>
</tr>
</tbody></table>
<p>**Raspbian(라즈비안)**은 라즈베리파이를 위한 데비안 리눅스로 가장 대중적인 데비안 리눅스, 우분투와 같은 사용자 경험을 제공해 주고 있다.</p>
<h3 id="Raspberry-Pi-준비"><a href="#Raspberry-Pi-준비" class="headerlink" title="Raspberry Pi 준비"></a>Raspberry Pi 준비</h3><p>설치에 앞서 준비해야 할 것 이 있습니다.</p>
<ul>
<li>Raspberry Pi 1, 2, 3</li>
<li>OS 설치 SD Memory Card: 8GB 이상, Class6 이상</li>
<li>USB to Serial Cable</li>
</ul>
<h4 id="SDCard에-대해"><a href="#SDCard에-대해" class="headerlink" title="SDCard에 대해"></a>SDCard에 대해</h4><p>라즈베리파이는 SD 호환 카드에서 작동하도록 되어 있다. </p>
<ul>
<li><p>NOOBS를 이용한다면 최소 8GB</p>
</li>
<li><p>다른 버전은 최소 4GB</p>
</li>
<li><p>Class 4는 4MB&#x2F;s 쓰기 속도, Class 10은 10MB&#x2F;s 쓰기가 가능하지만 Class 10이 Class 4를 앞선다는 것을 보장하진 않는다. 라즈베리파이는 Class 6의 8GB 사용을 권장하고 있다.</p>
</li>
<li><p>Mac: SDCardFormatter</p>
</li>
</ul>
<h4 id="SDCard-사용시-주의"><a href="#SDCard-사용시-주의" class="headerlink" title="SDCard 사용시 주의"></a>SDCard 사용시 주의</h4><ul>
<li>정품 SD Card 사용을 권장</li>
<li>전원은 품질이 좋아야. 라즈베리파이 보드의 TP1, TP2 전력을 측정해서 4.75v 이하면 품질이 좋은 전원으로 바꾸길.</li>
<li>더불어 좋은 품질의 USB 케이블을 사용해야 한다.</li>
<li>종료시 <strong>sudo halt</strong> 를 이용하도록</li>
<li>오버클록은 지양하도록</li>
</ul>
<br>
### Download and Install

<p>OS 설치와 서비스 설치는 크게 아래 과정을 거친다.</p>
<ul>
<li>(1). Download OS Image, Etcher, sdFormatter</li>
<li>(2). OS image 파일을 SD Card에 쓴다.</li>
</ul>
<p>SD Card로 부팅후에</p>
<ul>
<li>(1). 모니터 혹은 시리얼 콘솔에서 <code>raspi-conifg</code> 로 시스템 구성을 마무리</li>
<li>(2). 서비스 설치</li>
</ul>
<h4 id="1-Download-OS-Image-Etcher-sdFormatter"><a href="#1-Download-OS-Image-Etcher-sdFormatter" class="headerlink" title="(1). Download OS Image, Etcher, sdFormatter"></a>(1). Download OS Image, Etcher, sdFormatter</h4><p>라즈베리안 OS를 다운로드,</p>
<p><a target="_blank" rel="noopener" href="https://www.raspberrypi.org/downloads/raspbian/">Raspberry Pi Raspbian Download</a> 링크에서 다운 받을 수 있다. </p>
<blockquote>
<p>토렌트와 zip 형식으로 다운 받을 수 있습니다.</p>
</blockquote>
<p>다운로드된 파일은 <em>yyyy-mm-dd-raspbian-wheezy.zip</em> 형식으로 다운로드가 된다. 디스크 이미지 파일 <em>yyyy-mm-dd-raspbian-wheezy.img</em> 이 zip으로 압축되어 있는데,이 이미지 파일을 SD Card에 복사해야 한다.</p>
<p>디스크 이미지를 쓰기위한 프로그램으로 오에스 이미지를 SD Card, Disk 등에 쓴다. 보통 아래 프로그램을 이용한다.</p>
<ul>
<li>Windows : Win32DiskImager</li>
<li>Linux: ImageWriter</li>
<li>macOS: <code>dd</code> 명령</li>
<li>모든 플랫폼: Etcher</li>
<li>SD Memory Card Formatter 5.0 for SD&#x2F;SDHC&#x2F;SDXC</li>
</ul>
<p>이 글에서는 디스크 이미지 쓰기<a target="_blank" rel="noopener" href="http://etcher.io/">Etcher</a> 프로그램을 이용해서 오에스 이미지 파일을 SD Card에 쓰겠다.</p>
<blockquote>
<p>macOS, Windows, Linux 지원 </p>
</blockquote>
<p>여기까지 필요한 준비 사항은:</p>
<ul>
<li>Raspbian OS Image</li>
<li>SD Card Formatter</li>
</ul>
<h4 id="OS-image-파일을-SD-Card-쓰기"><a href="#OS-image-파일을-SD-Card-쓰기" class="headerlink" title="OS image 파일을 SD Card 쓰기"></a>OS image 파일을 SD Card 쓰기</h4><p>Etcher를 실행하고 </p>
<p><img src="/images/opensuse/etcher-image-writing.png">{:width&#x3D;”640”}</p>
<h5 id="dd-를-사용한다면"><a href="#dd-를-사용한다면" class="headerlink" title="dd 를 사용한다면,"></a><code>dd</code> 를 사용한다면,</h5><p>다운받은 <code>.zip</code> 파일을  <code>unzip</code>으로 풀어 dd&#96;로 SD Card에 이미지를 쓴다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unzip -p 2017-06-21-raspbian-stretch-lite.zip | sudo dd of=/dev/rdisk1 bs=4M; sync</span><br></pre></td></tr></table></figure>

<blockquote>
<p>MacOS는 dd의 bs 옵션이 소문자로 받는다: <code>bs=4m</code></p>
</blockquote>
<p>다쓴 SD Card를 마운트 한다. </p>
<h4 id="ssh-활성화"><a href="#ssh-활성화" class="headerlink" title="ssh 활성화"></a>ssh 활성화</h4><p>Raspbian 2016-11-25일 릴리즈 이후 기본으로 ssh가 비활성화 되어 있다. 그래서 처음 부팅후 ssh 접속이 필요하다면 부트 파티션에 <code>ssh</code> 파일을 생성해 주면된다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cd /boot</span><br><span class="line">$ touch ssh</span><br></pre></td></tr></table></figure>


<br>
#### Serial console

<p>여기서는 <strong>Serial console</strong>에서 네트워크 확인 및 초기 설정을 하고 <strong>ssh</strong> 로 서버에 로그인해서 시스템 구성을 진행한다.</p>
<blockquote>
<p>SD Card를 라즈베리파이에 꽃고 HDMI, Keyboard 및 Mouse 가 별도로 준비되어 있으면 직접 모니터를 보고 작업을 진행하면 좋다. </p>
</blockquote>
<p>USB to Serial 케이블을 사용해서 Raspberry Pi의 Serial Console에 연결한다.</p>
<p><img src="/images/raspberrypi/rpi-usb-serial.png">{:width&#x3D;”640”}</p>
<p>그리고 시리얼 포트를 통해 tty 연결을 위해 터미널 프로그램에서 baud rate 115200 으로 연결한다. 아래는 macOS의 <code>screen</code> CLI 명령으로 usb serial 포트에 연결하고 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ screen /dev/cu.usbserial 115200</span><br></pre></td></tr></table></figure>

<p>이제 SD Card를 넣고 부팅을 하면, 터미널에 부트 단계가 진행되고 처음 5분 정도 소요된다. </p>
<p><img src="/images/opensuse/opensuse-boot33.png">{:width&#x3D;”640”}</p>
<p>Raspberry Pi를 위한 이미지는 처음 계정은 <code>root/linux</code> 이다. </p>
<p>터미널에서 uname 은 <strong>aarch64</strong> 임을 확인 할 수 있다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root<span class="comment"># uname -a</span></span><br><span class="line">Linux homepi 4.4.90-18.32-default <span class="comment">#1 SMP Fri Oct 6 13:30:08 UTC 2017 (465b410) aarch64 aarch64 aarch64 GNU/Linux</span></span><br></pre></td></tr></table></figure>

<p>처음으로 라즈베리파이에서 64bit 환경으로 운영해 볼 수 있게 됐다.</p>
<h4 id="Raspbian-OS-Image-복사"><a href="#Raspbian-OS-Image-복사" class="headerlink" title="Raspbian OS Image 복사"></a>Raspbian OS Image 복사</h4><p>맥&#x2F;리눅스에서 dd 명령을 이용해서 이미지를 복사할 수 있습니다. </p>
<blockquote>
<p>sudo dd bs&#x3D;1m if&#x3D;path_of_your_image.img of&#x3D;&#x2F;dev&#x2F;diskn</p>
<ul>
<li>bs: 한번에 읽어들일 사이즈를 의미</li>
</ul>
</blockquote>
<p>마지막 옵션인 ‘diskn’의 n은 SD Card의 번호로 SDCard Formater에서 기억하란 번호입니다. 여기서 번호가 2로 가정합니다.<br>그리고 Mac OSX는 디스크가 &#x2F;dev 경로에 두 가지 종류가 있습니다.</p>
<ul>
<li>&#x2F;dev&#x2F;disk# 버퍼 디바이스로 데이터가 부가적인 처리를 통해 사용합니다.</li>
<li>&#x2F;dev&#x2F;rdisk# 저수준 경로로 빠르고 dd 명령을 사용할 때 완벽합니다.</li>
</ul>
<blockquote>
<p>Class 4 SD card는 rdisk 경로를 사용할 때 20배 빠릅니다.</p>
</blockquote>
<p>먼저 포맷터로 포맷한 디스크 마운트를 해제합니다. 맥의 디스크유틸리티를 이용해서 마운트를 해제합니다.<br><img src="/images/mac-diskutility.png"></p>
<p>이미지가 있는 곳에서 dd 명령으로 라즈비안을 복사합니다.3.2GB 크기를 복사해서 9분~15분 정도의 시간이 소요됩니다.</p>
<p>zip 압축 파일을 입력으로 다음 같이 dd 명령으로 sd card에 쓴다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ unzip -p 2016-05-27-raspbian-jessie.zip | sudo dd of=/dev/rdisk1 bs=1m</span><br></pre></td></tr></table></figure>

<p>압축을 푼후</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$sudo dd bs=1m if=2015-02-16-raspbian-wheezy.img of=/dev/rdisk2</span><br><span class="line">3125+0 records in</span><br><span class="line">3125+0 records out</span><br><span class="line">3276800000 bytes transferred i</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n 551.608702 secs (5940443 bytes/sec)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>rdisk 이용시 에러가 발생하면 disk를 사용합니다.</p>
</blockquote>
<p>다음 링크에 설명한 방법을 바탕으로 설명해보겠습니다.<br>참조: <a target="_blank" rel="noopener" href="http://elinux.org/RPi_Easy_SD_Card_Setup">http://elinux.org/RPi_Easy_SD_Card_Setup</a></p>
<h5 id="Mac-diskutil-과-dd-이용"><a href="#Mac-diskutil-과-dd-이용" class="headerlink" title="Mac diskutil 과 dd 이용"></a>Mac diskutil 과 dd 이용</h5><p>diskutil로 디스크 목록 확인해 SD카드 번호 확인</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">diskutil list</span><br></pre></td></tr></table></figure>


<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">diskutil unmountDisk /dev/disk1</span><br></pre></td></tr></table></figure>

<p>이미지 쓰기</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo dd bs=1m if=image.img of=/dev/rdisk[n] conv=noerror,sync</span><br></pre></td></tr></table></figure>

<blockquote>
<p>위 명령으로도 ‘Permission Denied’ 가 나오면, 이것은 SD 카드의 파티션 테이블이 덮어쓰기를 막고 있다는 의미로 이 경우 파티션 테이블을 제거해야 한다. 다음 같이 zero로 SDCard를 덮어쓰면 all partitions, master boot records, and data를 지운다.</p>
</blockquote>
<p>진행 상황을 보려면 <em>status&#x3D;progress</em> 로 알 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo dd bs=1m if=image.img of=/dev/rdisk[n] conv=noerror,sync status=progress</span><br></pre></td></tr></table></figure>

<p>SD card를 포맷하려면</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sudo dd if=/dev/zero of=/dev/rdisk1 bs=4k count=1</span><br></pre></td></tr></table></figure>
<ul>
<li>bs: 한번에 읽어들일 byte를 의미</li>
<li>count: block 수 입니다.</li>
</ul>
<p>혹은 랜덤 데이터로 지우려면</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$dd if=/dev/urandom of=/dev/sda bs=4k</span><br></pre></td></tr></table></figure>

<p>Mac의 diskutil을 사용하면</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo diskutil partitionDisk /dev/disk3 1 MBR &quot;Free Space&quot; &quot;%noformat%&quot; 100%</span><br></pre></td></tr></table></figure>


<p>다운로드한 이미지는 zip 압축 파일로 저장된다. 다음 같이 명령 파이프를 이용하면 압축 파일을 풀지않고 디스크에 이미지를 쓸 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ unzip -p 2016-09-23-raspbian-jessie.zip* | sudo dd of=/dev/rdisk1 bs=4m</span><br><span class="line">password: ****</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>이미지를 <em>dd</em>  명령으로 작성한 후에 카드를 추출한다:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo diskutil eject /dev/rdisk3</span><br></pre></td></tr></table></figure>


<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.raspberrypi.org/documentation/installation/installing-images/mac.md">https://www.raspberrypi.org/documentation/installation/installing-images/mac.md</a></p>
</blockquote>
<h5 id="clone-disk"><a href="#clone-disk" class="headerlink" title="clone disk"></a>clone disk</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo dd if=/dev/diskX conv=sync,noerror bs=4m | gzip -c  &gt; /path/to/backup.img.gz</span><br></pre></td></tr></table></figure>


<blockquote>
<p>반대로 디스크를 디스크이미지로 만들려면 다음 같이 dd 를 사용할 수 있습니다.<br>쓰기 전에 sd card의 마운트한 파티션을 마운트를 해제해야 합니다.</p>
<p>$sudo dd bs&#x3D;1m if&#x3D;2015-02-16-raspbian-wheezy.img of&#x3D;&#x2F;dev&#x2F;rdisk2</p>
</blockquote>
<h4 id="SDFormatter-이용"><a href="#SDFormatter-이용" class="headerlink" title="SDFormatter 이용"></a>SDFormatter 이용</h4><p>SDCard Formatter 를 이용해서 SD Card를 포맷할 수 있습니다. 윈도우즈, 리눅스 및 맥을 지원합니다.</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.sdcard.org/downloads/formatter_4/">https://www.sdcard.org/downloads/formatter_4/</a></li>
</ul>
<ol>
<li>오에스에 맞는 버전을 다운로드하고 실행하면 설치를 합니다. </li>
<li>SD Card를 컴퓨터에 삽입합니다.</li>
<li>SDFormatter를 실행하고 다음 화면 처럼 SD card를 포맷할 수 있습니다.</li>
</ol>
<ul>
<li>SDFormatter 라는 프로그램을 설치하여, 옵션의 FORMAT SIZE ADJUSTMENT 설정을 ON 으로 하여 SD카드를 포맷</li>
</ul>
<p><img src="/images/raspberrypi/sdcardformatter-main.png" alt="SDCard Formatter 실행"></p>
<blockquote>
<p>SDCard Formatter에서 디스크 선택시 디스크 번호를 잘 기억해 두세요.</p>
</blockquote>
<h3 id="윈도우즈에서-라즈비안-복사하기"><a href="#윈도우즈에서-라즈비안-복사하기" class="headerlink" title="윈도우즈에서 라즈비안 복사하기"></a>윈도우즈에서 라즈비안 복사하기</h3><p>윈도우XP&#x2F;7&#x2F;8 에서 다운로드한 라즈비안 OS를 SD카드로 복사하겠습니다. 아래 링크에서 ‘Win32 Disk Imager’를 다운받아 사용해야 합니다.</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://sourceforge.net/projects/win32diskimager/">Win32 Disk Imager</a></li>
</ul>
<p>win32diskimager를 실행하고 다운받은 ‘2015-03-15-raspbian-wheezy.zip’ 파일을 선택하고 SD카드 위치를 선택해 주면 됩니다.</p>
<p><img src="/images/win32diskimager.png"></p>
<p>그리고 Write버튼을 눌러주고 기다리면 복사를 시작합니다.</p>
<h2 id="부팅"><a href="#부팅" class="headerlink" title="부팅"></a>부팅</h2><h3 id="IP-강제-지정"><a href="#IP-강제-지정" class="headerlink" title="IP 강제 지정"></a>IP 강제 지정</h3><p>CD Card를 마운트 하면 boot 파티션이 마운트 된다. boot 파티션에 있는 <em>cmdline.txt</em> 에 <code>ip=</code> 옵션을 추가해 강제로 IP 주소를 지정할 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dwc_otg.lpm_enable=0 console=ttyAMA0,115200 console=tty1 root=/dev/mmcblk0p2 rootfstype=ext4 elevator=deadline rootwait **ip=192.168.0.203**</span><br></pre></td></tr></table></figure>


<h3 id="Serial-Console"><a href="#Serial-Console" class="headerlink" title="Serial Console"></a>Serial Console</h3><p><img src="/images/raspberypi/rpi-usb-serial.png"></p>
<p>Raspbian 은 boot 파티션에 있는 <em>cmdline.txt</em> 옵션으로 기본적으로 serial console을 사용하도록 하고 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dwc_otg.lpm_enable=0 console=ttyAMA0,115200 console=tty1 root=/dev/mmcblk0p2 rootfstype=ext4 elevator=deadline rootwait</span><br></pre></td></tr></table></figure>

<h4 id="Mac-Serial"><a href="#Mac-Serial" class="headerlink" title="Mac Serial"></a>Mac Serial</h4><p>보통 FTDI USB 케이브을 다음 두 제품이 대부분이다.</p>
<ul>
<li>Prolific PL2303:   <a target="_blank" rel="noopener" href="http://www.prolific.com.tw/us/showproduct.aspx?p_id=229&pcid=41">PL2303 MacOSX</a></li>
<li>FTDI USB Serial:   FTDIUSBSerialDriver_v2_3.zip</li>
</ul>
<blockquote>
<p>macOS Maverick 이후 FTDI 드라이버가 포함되어 있다.<br>혹시 새 버전을 설치하거나 이전 버전이 설치되어 삭제하려면 [^6]<br> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ cd /Library/Extensions/</span><br><span class="line">$ sudo rm -r PL2303.kext</span><br><span class="line">$ sudo rm -r ProlificUsbSerial.kext</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>FTDI 케이블을 사용한다고 가정하고 맥에 USB to Serial 케이블을 연결하면 <em>&#x2F;dev</em> 장치에 <em>cu.</em>, <em>tty.</em> 장치 드라이버가 생성된다. 두 장치는 다른 점이 있다.[^5]</p>
<ul>
<li>&#x2F;dev&#x2F;tty.* 장치는 DCD (data-carrier-detect) 신호를 대기한다, 이것은 누군가 호출해 온다는 의미이다.</li>
<li>&#x2F;dev&#x2F;cu.* 장치는 DCD를 추정하지 않고 항상 즉시 연결한다(응답 혹은 성공)</li>
</ul>
<p>FTDI 로 시리얼을 사용시는 <em>cu.</em> 장치를 사용하면 된다.</p>
<blockquote>
<p>일반적으로 </p>
</blockquote>
<h4 id="screen"><a href="#screen" class="headerlink" title="screen"></a>screen</h4><p>Mac에서 <code>screen</code> 사용시</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">screen /dev/cu.usbserial-XXXXXXXX 115200</span><br></pre></td></tr></table></figure>

<p>시리얼 터미널에서 빠져나오려면  ‘ctrl-a, ctrl-&#39; 를  순서데로 입력</p>
<h3 id="Linux-Serial-terminal"><a href="#Linux-Serial-terminal" class="headerlink" title="Linux Serial terminal"></a>Linux Serial terminal</h3><p>Linux machine에서 Usb to serial 케이블을 사용할 수 있는지 콘솔 메시지에서 Serial console이 있는 지 확인한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ dmesg | egrep --color &#x27;serial&#x27;</span><br><span class="line">[ 1969.914088] usbcore: registered new interface driver usbserial</span><br><span class="line">[ 1969.914139] usbcore: registered new interface driver usbserial_generic</span><br><span class="line">[ 1969.914175] usbserial: USB Serial support registered for generic</span><br><span class="line">[ 1969.918325] usbserial: USB Serial support registered for pl2303</span><br></pre></td></tr></table></figure>

<p>장치 드라이버는 보통 <em>&#x2F;dev&#x2F;ttyUSB0</em> 장치로 연결된다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ls /dev/ttyUSB*</span><br><span class="line">/dev/ttyUSB0</span><br></pre></td></tr></table></figure>


<h4 id="dterm"><a href="#dterm" class="headerlink" title="dterm"></a>dterm</h4><p>dtermAUR is a tiny serial communication program. If you invoke it without parameters, it will connect to &#x2F;dev&#x2F;ttyS0 at 9600 baud by default. The following example connect to &#x2F;dev&#x2F;ttyS0 at 115200 baud, with 8 data bits, no parity bit and 1 stop bit-times:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ dterm 115200 8 n 1</span><br></pre></td></tr></table></figure>

<p>See its homepage[1] for more examples.</p>
<h4 id="Minicom"><a href="#Minicom" class="headerlink" title="Minicom"></a>Minicom</h4><p>minicom can be obtained from the official repositories. Start Minicom in setup mode:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ minicom -s</span><br></pre></td></tr></table></figure>

<p>Using the textual navigation menu, change the serial port settings to the following:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Serial Device: /dev/ttyS0</span><br><span class="line">Bps/Par/Bits: 9600 8N1</span><br></pre></td></tr></table></figure>

<p>Press Enter to exit the menus (pressing Esc will not save changes). Remove the modem Init and Reset strings, as we are not connecting to a modem. To do this, under the Modem and Dialing menu, delete the Init and Reset strings. Optionally save the configuration by choosing save setup as dfl from the main menu. Restart minicom with the serial cable connected to the target machine. To end the session, press Ctrl+A followed by Ctrl+X.</p>
<h4 id="picocom"><a href="#picocom" class="headerlink" title="picocom"></a>picocom</h4><p>picocom is a tiny dumb-terminal emulation program that is very like minicom, but instead of mini, it is pico. The following example connect to ttyS0 at 9600 bps:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ picocom -b 9600 /dev/ttyS0</span><br></pre></td></tr></table></figure>

<p>Note: if the backspace key won’t work properly try out this option: ‘–omap delbs’<br>See its manual for detailed usage.</p>
<h4 id="Screen"><a href="#Screen" class="headerlink" title="Screen"></a>Screen</h4><p>screen is able to connect to a serial port. It will connect at 9600 baud by default:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ screen /dev/ttyS0 115200</span><br></pre></td></tr></table></figure>

<p>To end the session, press Ctrl+a followed by k.</p>
<p>여러 사용자로 열려면 <strong>-R</strong> 옵션을 주고 다시 연다</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">screen -R /dev/tty.usbserial-XXXXXXXX 115200</span><br></pre></td></tr></table></figure>

<p>screen 명령 사용중 어떤 상황에서 세션이 멈춘 경우 종료 명령이 안된다. 이 경우 screen 세션을 찾고 가제 종료를 시도해 본다.</p>
<p>Type screen -list to identify the detached screen session.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">~$ screen -list  </span><br><span class="line">    There are screens on:  </span><br><span class="line">         20751.Melvin_Peter_V42  (Detached)  </span><br><span class="line">Note: 20751.Melvin_Peter_V42 is your session id.</span><br></pre></td></tr></table></figure>

<p>Get attached to the detached screen session<br>screen -r 20751.Melvin_Peter_V42<br>Once connected to the session press Ctrl + A then type :quit</p>
<p>Attached session 종료</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ screen -ls</span><br><span class="line">There is a screen on:</span><br><span class="line">  2667.ttys003.gogangtaeui-MacBook-Pro  (Attached)</span><br><span class="line">1 Socket in /var/folders/02/4qk5tfw527b9zqx92gtv4m980000gn/T/.screen.</span><br></pre></td></tr></table></figure>

<p>screen -S sessionname -p 0 -X quit</p>
<h2 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h2><p><a target="_blank" rel="noopener" href="http://www.mostlynetworks.com/2014/11/os-x-yosemite-prolific-usb-drivers/">http://www.mostlynetworks.com/2014/11/os-x-yosemite-prolific-usb-drivers/</a><br><a target="_blank" rel="noopener" href="http://www.mostlynetworks.com/2015/01/fixing-prolific-driver-os-x/">http://www.mostlynetworks.com/2015/01/fixing-prolific-driver-os-x/</a><br><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/disk_cloning">https://wiki.archlinux.org/index.php/disk_cloning</a></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/working_with_the_serial_console">Archlinux-Working with serial console</a></li>
</ul>
<p>[^5]: <a target="_blank" rel="noopener" href="https://pbxbook.com/other/mac-tty.html">Mac tty</a><br>[^6]: <a target="_blank" rel="noopener" href="http://sewellsupport.com/Uninstall-Pl-2303-on-Mac-OSX.aspx">Uninstall PL-2303 on macOS X</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2017-10-30T00:00:00.000Z" title="2017-10-30 9:00:00">2017-10-30</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2022-02-24T16:45:45.946Z" title="2022-2-25 1:45:45">2022-02-25</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Raspberry-Pi/">Raspberry Pi</a><span> / </span><a class="link-muted" href="/categories/Raspberry-Pi/Linux/">Linux</a><span> / </span><a class="link-muted" href="/categories/Raspberry-Pi/Linux/Database/">Database</a></span><span class="level-item">15분안에 읽기 (약 2238 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2017/10/30/raspberrypi-2017-10-30-opensuse-jeos-mongodb/">Raspberry Pi 3 64bit OS openSUSE: Build MongoDB 3.4</a></h1><div class="content"><p><strong>Raspberry Pi 3 64bit OS openSUSE</strong> 는 이글은 4개 글타래로 구성되며, openSUSE 설치 및 사용에 대해 작성한다.</p>
<p>Opensuse 에서 Raspberry Pi 3를 위한 64bit OS openSESE Leap 42.2 을 제공하고 있다.</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://en.opensuse.org/HCL:Raspberry_Pi3">https://en.opensuse.org/HCL:Raspberry_Pi3</a></li>
</ul>
<ol>
<li><a href="!--swig%EF%BF%BC32--">Install 64bit openSUSE Leap 42.2 &#x2F; JeOS</a></li>
<li>openSUSE: Managing Service daemon</li>
<li>openSUSE: Basic OS Security for Server</li>
<li>Install &amp; Configuration - Nginx, Node JS</li>
<li>Build MongoDB 3.4.x</li>
</ol>
<h2 id="MongoDB-Community-Edition-설치"><a href="#MongoDB-Community-Edition-설치" class="headerlink" title="MongoDB Community Edition 설치"></a>MongoDB Community Edition 설치</h2><p>Opensuse 용 MongoDB가 제공되지만 AMD64, X64 관련한 플랫폼에 지원될 뿐이다. Raspberry Pi 3에 JeOS를 설치하고 네이티브로 빌드해보기로 했다.</p>
<h3 id="준비"><a href="#준비" class="headerlink" title="준비"></a>준비</h3><p>MongoDB 빌드를 위해서 git, gcc 등, Scons 가 필요하다.</p>
<h4 id="컴파일-환경-준비"><a href="#컴파일-환경-준비" class="headerlink" title="컴파일 환경 준비"></a>컴파일 환경 준비</h4><p>최신 <strong>master branch</strong>는,</p>
<ul>
<li>최신 C++11 compiler:<ul>
<li>VS2015 Update 2 or newer</li>
<li>GCC 5.3.0</li>
<li>Clang 3.4 (or Apple XCode 5.1.1 Clang) or newer</li>
</ul>
</li>
<li>Python 2.7</li>
<li>SCons 2.3.5 or newer (for MSVC 2015 support)</li>
</ul>
<p><strong>branch 3.2, 3.0</strong> 는</p>
<ul>
<li>C++11 compiler:<ul>
<li>VS2013 Update 4 or newer. Note that VS2015 is currently not compatible with the 3.0 and 3.2 branches. You must use VS2013.</li>
<li>GCC 4.8.2 or newer. Note that versions of GCC newer than 4.8.2 may produce warnings when building these branches, which are promoted to errors. Please use the –disable-warnings-as-errors build option if necessary to allow the build to succeed despite the warnings.</li>
</ul>
</li>
<li>Python 2.7</li>
<li>SCons 2.3.0 or newer</li>
</ul>
<h3 id="필요한-패키지"><a href="#필요한-패키지" class="headerlink" title="필요한 패키지"></a>필요한 패키지</h3><p>여기서는 터미널에서 openSUSE <code>yast</code> 사용해 관련 패키지를 설치한다. <code>yast</code>를 시작한다.<br><em>YaST -&gt; Software -&gt; Software Management</em> 를 선택한다.</p>
<p>![][&#x2F;images&#x2F;opensuse&#x2F;yast-sw2.png]</p>
<h4 id="gcc"><a href="#gcc" class="headerlink" title="gcc"></a>gcc</h4><p>gcc 을 선택한다. gcc를 선택하면 gcc-4.8 을 기본으로 설치한다.</p>
<p>![][&#x2F;images&#x2F;opensuse&#x2F;yast-sw-gcc.png]</p>
<p>여러 버전을 설치하면 gcc 를 선택하기 위해 <code>update-alternatives</code>을 사용한다. 링크 <a href="/linux/linux-update-alternatives/">update-alternatives</a> 에서 설명을 볼 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ sudo update-alternatives --install /usr/bin/gcc gcc \</span><br><span class="line">/usr/bin/gcc-4.8 10 --slave /usr/bin/g++ g++ /usr/bin/g++-4.8</span><br><span class="line">$ sudo update-alternatives --install /usr/bin/gcc gcc \</span><br><span class="line">/usr/bin/gcc-6 30 --slave /usr/bin/g++ g++ /usr/bin/g++-6</span><br></pre></td></tr></table></figure>

<h4 id="python"><a href="#python" class="headerlink" title="python"></a>python</h4><p>검색어에 다음 패키지를 넣고 찾아 하나씩 <strong>+</strong> 키로 패키지를 선택한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git python python-pip python-devel python3 python3-pip python3-devel</span><br></pre></td></tr></table></figure>

<p><em>Search Phrase</em>에 다음 패키지를 찾아 개발관련 라이브러리를 설치한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">build-essential libboost-filesystem-dev libboost-program-options-dev</span><br><span class="line"> libboost-system-dev libboost-thread-dev -y</span><br></pre></td></tr></table></figure>

<p><em>yast-sw-devel_basis</em> 패키지를 찾아 설치한다.</p>
<p><img src="/images/opensuse/yast-sw-devel_basis.png">{:width&#x3D;”640”}</p>
<p><em>Search Phrase</em> 에 gcc 를 넣고 적절한 버전을 선택한다.</p>
<p><img src="/images/opensuse/yast-sw-gcc.png">{:width&#x3D;”640”}</p>
<p>그리고 Action 탭에서 설치를 실행한다.</p>
<p><img src="/images/opensuse/yast-sw-gcc3.png">{:width&#x3D;”640”}</p>
<p>ssl 지원을 위해서 Debian과 Ubuntu systems에서 SSL 지원을 위해서 <strong>libssl-dev</strong> 가 필요하다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo zypper install libopenssl-devel</span><br></pre></td></tr></table></figure>

<!--

#### zypper 로 설치



zypper in devel_basis

Opensuse for Ubuntu/Debian users
>
개발관련 라이브러리를 설치한다.
>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git python python-pip python-dev python3 python3-pip python3-dev</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">build-essential libboost-filesystem-dev libboost-program-options-dev libboost-system-dev libboost-thread-dev -y</span><br></pre></td></tr></table></figure>

<p>–&gt;</p>
<h4 id="SCons"><a href="#SCons" class="headerlink" title="SCons"></a>SCons</h4><p>mongodb 3.x는 scons를 최신버전으로 요구한다. Suse LEAP은 <code>scons</code> 가 2.3 버전이지만, 여기서 최신 버전 2.5.1 버전을 다운로드해서 설치했다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wget http://prdownloads.sourceforge.net/scons/scons-2.5.1.tar.gz</span><br><span class="line">tar xvf scons-2.5.1.tar.gz</span><br><span class="line"><span class="built_in">cd</span> scons-2.5.1</span><br><span class="line">sudo python setup.py install</span><br><span class="line">scons --version</span><br><span class="line">SCons by Steven Knight et al.:</span><br><span class="line">  script: v2.5.1.rel_2.5.1:3735:9dc6cee5c168[MODIFIED], 2016/11/03 14:02:02, by bdbaddog on mongodog</span><br></pre></td></tr></table></figure>

<h3 id="Build-시작"><a href="#Build-시작" class="headerlink" title="Build 시작"></a>Build 시작</h3><p><a target="_blank" rel="noopener" href="https://github.com/mongodb">github mongodb</a> 소스를 사용하고, 라즈베리파이세 Fan을 달라</p>
<blockquote>
<p>혹시, 이 글을 보고, 또 필요해서 꼭 라즈베리파이에서 MongoDB를 빌드하고자 하면<br>필자는 빌드를 시작해서 9일이 걸렸다.</p>
</blockquote>
<h4 id="소스-다운로드"><a href="#소스-다운로드" class="headerlink" title="소스 다운로드"></a>소스 다운로드</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/mongodb/mongo.git mongodb-src</span><br><span class="line">git checkout v3.4.9</span><br></pre></td></tr></table></figure>

<p>pip 패키지 설치</p>
<p>opensuse에서 배포하는 pip는 7.x 버전으로 최신버전으로 업그레이드한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pip install --upgrade pip</span><br></pre></td></tr></table></figure>

<p>최신 3.4 master 브랜치를 설치하려면 소스를 다운로드한 후에 pip로 설치한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -r buildscripts/requirements.txt</span><br></pre></td></tr></table></figure>

<p>그리고 scons에서 에러코드 점검에 사용하는 다음 패키지를 설치한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install --user regex</span><br></pre></td></tr></table></figure>

<p>swap이 필요하다. 다음은 block size 1G 크기 파일을 4회에 걸쳐 만들기 때문에 4G 파일이 생성된다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo dd if=/dev/zero of=/data/swap4G bs=1G count=4</span><br><span class="line">sudo chmod 600 /swapfile</span><br><span class="line">sudo mkswap /swapfile</span><br><span class="line">sudo swapon /swapfile</span><br><span class="line">sudo swapon -s</span><br></pre></td></tr></table></figure>

<h4 id="Build-시작-1"><a href="#Build-시작-1" class="headerlink" title="Build 시작"></a>Build 시작</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">~&gt; w</span><br><span class="line"> 11:14:58 up 1 day,  2:26,  2 users,  load average: 7.27, 7.30, 7.52</span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">qkboo    pts/0    192.168.11.102   10:30    2.00s  1.56s  0.07s w</span><br><span class="line">qkboo    pts/1    tmux(9980).%0    05:08    6:06m  4:48   0.72s /usr/lib64/gcc/</span><br><span class="line"></span><br><span class="line">~&gt; free</span><br><span class="line">             total       used       free     shared    buffers     cached</span><br><span class="line">Mem:        803988     771156      32832          0       6528     355580</span><br><span class="line">-/+ buffers/cache:     409048     394940</span><br><span class="line">Swap:      2594940    1158396    1436544</span><br></pre></td></tr></table></figure>

<p>그리고 드디어, 빌드가 끝나고 나니 <strong>9일</strong>이 걸렸다 Bravo!!!</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Linking build/opt/mongo/mongod</span><br><span class="line">Install file: <span class="string">&quot;build/opt/mongo/mongod&quot;</span> as <span class="string">&quot;mongod&quot;</span></span><br><span class="line">scons: <span class="keyword">done</span> building targets.</span><br><span class="line"></span><br><span class="line">real    13514m39.223s</span><br><span class="line">user    751m26.374s</span><br><span class="line">sys     180m32.031s</span><br></pre></td></tr></table></figure>

<p>빌드한 바이너리는 build&#x2F;opt&#x2F;mongo 밑에 생성된다. 이 바이너리에는 디버깅용 심볼 정보가 포함되어 있다. 이 부분을 제거하기 위해서 <code>strip</code> 명령을 사용한다. 여기서는 <code>mongod</code> 만 빌드해서</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~&gt; <span class="built_in">cd</span> build/opt/mongo</span><br><span class="line">~&gt; strip -s mongod</span><br></pre></td></tr></table></figure>

<h3 id="MongoDB-설치"><a href="#MongoDB-설치" class="headerlink" title="MongoDB 설치"></a>MongoDB 설치</h3><p>소스를 빌드한 바이너리를 설치한다. 먼저 <code>mongod</code> 를 복사한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~&gt; sudo <span class="built_in">cp</span> mongo mongod mongos /usr/local/bin/</span><br><span class="line">~&gt; sudo <span class="built_in">chown</span> root:root /usr/local/bin/mongo*</span><br><span class="line">~&gt; sudo <span class="built_in">chmod</span> 755 /usr/local/bin/mongo*</span><br></pre></td></tr></table></figure>

<h4 id="User-mongodb"><a href="#User-mongodb" class="headerlink" title="User mongodb"></a>User mongodb</h4><p>사용자를 추가하기 openSUSE <code>yast</code>라는 시스템 도구로 할 수 있지만 여기선 <code>adduser</code> 명령을 사용해서 사용자 추가한다. 자세한 것은 <a target="_blank" rel="noopener" href="http://www.tecmint.com/add-users-in-linux/">useradd 명령</a>을 참조한다.</p>
<p><code>useradd</code> 는 홈 디렉토리, 쉘 등에 대한 옵션을 주고 사용자를 등록하는데, 사용자 아이디를 <em>&#x2F;etc&#x2F;passwd</em>, <em>&#x2F;etc&#x2F;shadow</em>, <em>&#x2F;etc&#x2F;group</em>과 <em>&#x2F;etc&#x2F;gshadow</em>에 추가해준다.</p>
<p>로그인이 필요없는 사용자므로, 로그인, 패스워드, 홈디렉토리를 비활성화한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~&gt; sudo useradd -M -N -s /dev/zero -g nogroup mongodb</span><br></pre></td></tr></table></figure>

<h4 id="디렉토리와-설정"><a href="#디렉토리와-설정" class="headerlink" title="디렉토리와 설정"></a>디렉토리와 설정</h4><p>mongod 가 사용하는 로그 디렉토리,</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~&gt; sudo <span class="built_in">mkdir</span> /var/log/mongodb</span><br><span class="line">~&gt; sudo <span class="built_in">chown</span> mongodb:nogroup /var/log/mongodb</span><br></pre></td></tr></table></figure>

<p>데이터 디렉토리</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~&gt; sudo <span class="built_in">mkdir</span> /var/lib/mongodb</span><br><span class="line">~&gt; sudo <span class="built_in">chown</span> mongodb:root /var/lib/mongodb</span><br><span class="line">~&gt; sudo <span class="built_in">chmod</span> 775 /var/lib/mongodb</span><br></pre></td></tr></table></figure>

<p>이제 <code>mongod</code> 데몬을 시작해 보자, 먼저 다음 같이 명령을 입력해 시작한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~&gt; sudo /usr/local/bin/mongod --dbpath /var/lib/mongodb</span><br></pre></td></tr></table></figure>

<p>데이터베이스 엔진에서 발생하는 로그가 화면에 출력되는 것을 확인할 수 있다.</p>
<p><code>mongo</code> 클라이언트 혹은 mongobooster 같은 클라이언트에서 데이터베이스에 접속해 보고 잘 동작하는지 확인한다.</p>
<p>확인후 log 파일을 지정해 확인한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~&gt; sudo /usr/local/bin/mongod --dbpath /var/lib/mongodb/ --logpath /var/log/mongodb/mongod.log</span><br></pre></td></tr></table></figure>

<h4 id="mongod-conf"><a href="#mongod-conf" class="headerlink" title="mongod.conf"></a>mongod.conf</h4><p>보통 MongoDB는 데이터베이스 엔진 실행시 필요한 설정으로 로그 파일, 데이터 디렉토리 등의 내용을 <em>&#x2F;etc&#x2F;mongod.conf</em> 설정 파일에 선언해서 사용한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~&gt; sudo vi /etc/mongod.conf</span><br></pre></td></tr></table></figure>

<p>다음 내용으로 작성한다. 설정 파일 내용에 대해서는 <a target="_blank" rel="noopener" href="https://docs.mongodb.com/manual/reference/configuration-options">mongodb.conf</a>를 참조한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">storage:</span><br><span class="line">  dbPath: /data/mongodata</span><br><span class="line">  journal:</span><br><span class="line">    enabled: true</span><br><span class="line">#  engine: mmapv1</span><br><span class="line">#  mmapv1:</span><br><span class="line">  wiredTiger:</span><br><span class="line">    engineConfig:</span><br><span class="line">      cacheSizeGB: 0.5</span><br><span class="line"></span><br><span class="line">systemLog:</span><br><span class="line">  destination: file</span><br><span class="line">  logAppend: true</span><br><span class="line">  path: /var/log/mongodb/mongod.log</span><br><span class="line"></span><br><span class="line"># network interfaces</span><br><span class="line">net:</span><br><span class="line">  port: 27017</span><br><span class="line">  bindIp: 0.0.0.0</span><br><span class="line"></span><br><span class="line">security:</span><br><span class="line">  authorization: disabled</span><br></pre></td></tr></table></figure>

<p>설정 파일을 주고 시작해 본다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~&gt; sudo /usr/local/bin/mongod --config /etc/mongod.conf</span><br></pre></td></tr></table></figure>

<p>잘 동작한다.</p>
<h3 id="create-systemd-x2F-service-entry"><a href="#create-systemd-x2F-service-entry" class="headerlink" title="create systemd &#x2F; service entry"></a>create systemd &#x2F; service entry</h3><p>이제 systemd unit 파일 <code>mongod.service</code> 를 생성해서 데몬으로 등록해 보자. <em>&#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system</em> 디렉토리는 서비스 유닛 파일이 설치되는 곳으로, 활성화 되면 <em>&#x2F;etc&#x2F;systemd&#x2F;system&#x2F;</em> 밑에 설치된다.</p>
<blockquote>
<p>Ubuntu&#x2F;Debian 계열은 <em>&#x2F;lib&#x2F;systemd&#x2F;system</em> 이다</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~&gt; <span class="built_in">cd</span> /usr/lib/systemd/system</span><br><span class="line">~&gt; sudo vi mongod.service</span><br></pre></td></tr></table></figure>

<p>다음 내용을 입력한다:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=High-performance, schema-free document-oriented database</span><br><span class="line">After=network.target</span><br><span class="line">Documentation=https://docs.mongodb.org/manual</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">#User=mongodb</span><br><span class="line">#Group=nogroup</span><br><span class="line">ExecStart=/usr/local/bin/mongod --config /etc/mongod.conf</span><br><span class="line"># file size</span><br><span class="line">LimitFSIZE=infinity</span><br><span class="line"># cpu time</span><br><span class="line">LimitCPU=infinity</span><br><span class="line"># virtual memory size</span><br><span class="line">LimitAS=infinity</span><br><span class="line"># open files</span><br><span class="line">LimitNOFILE=64000</span><br><span class="line"># processes/threads</span><br><span class="line">LimitNPROC=64000</span><br><span class="line"># total threads (user+kernel)</span><br><span class="line">TasksMax=infinity</span><br><span class="line">TasksAccounting=false</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>

<p><code>mongod</code> 에 대한 제약은 <a target="_blank" rel="noopener" href="http://docs.mongodb.org/manual/reference/ulimit/#recommended-settings">Recommended limits for for mongod</a> 를 참조한다.</p>
<p>서비스 유닛 파일이 제대로 위치하는지 검증하기 위해 다음 명령으로 확인한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl list-unit-files --<span class="built_in">type</span>=service  |grep mongod</span><br><span class="line">mongodb.service             disabled</span><br></pre></td></tr></table></figure>

<p>이제 <code>mongod.service</code> 를 할성화 한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl <span class="built_in">enable</span> mongod.service</span><br></pre></td></tr></table></figure>

<p>활성화 되면 <em>&#x2F;etc&#x2F;systemd&#x2F;system&#x2F;multi-user.target</em> 밑에 설치된다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl status mongod.service</span><br><span class="line">● mongod.service - High-performance, schema-free document-oriented database</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/mongodb.service; enabled; vendor preset: disabled)</span><br><span class="line">   Active: inactive (dead)</span><br><span class="line">     Docs: https://docs.mongodb.org/manual</span><br></pre></td></tr></table></figure>

<p>이제 mongodb 를 시작한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl start mongod.service</span><br></pre></td></tr></table></figure>

<p>중지는,</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl stop mongod.service</span><br><span class="line">sudo systemctl restart mongod.service</span><br></pre></td></tr></table></figure>

<p>그리고 <em>mongod.service</em> 내용을 수정하면 다시 로딩을 해야 한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl daemon-reload</span><br></pre></td></tr></table></figure>

<p>일단 여기까지 데몬으로 잘 실행된다. 다만 사용자가 아닌 <code>root</code> 에서만… ㅠ.ㅜ</p>
<!--

#### Data disk

MLC를 지원하는 USB memory 를 장착하고, 2017-04-03-odroid-lvm2 에서 설명한데로 디렉토리를 구성해서 데이터 파일시스템으로 사용하고 있다.
-->

<h3 id="기념사진"><a href="#기념사진" class="headerlink" title="기념사진"></a>기념사진</h3><p>우분투&#x2F;데비안 계열에 익숙해 있다가 Raspberry Pi 3 에 openSUSE 를 개발자용 패키지들을 설치하고, 맘 먹고 빌드를 시작해서 9일이 걸렸다. <em>9일 동안 꿋꿋이 버텨준</em> <strong>Raspberry Pi 3&#x2F;openSUSE</strong> machine!!!</p>
<p><img src="/images/opensuse/rpi3-opensuse-machine.JPG">{:width&#x3D;”550”}</p>
<h2 id="참조"><a href="#참조" class="headerlink" title="참조"></a>참조</h2><p>[^1]: <a target="_blank" rel="noopener" href="http://koenaerts.ca/compile-and-install-mongodb-on-raspberry-pi/">Mongodb on Raspberry pi</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2017-10-21T00:00:00.000Z" title="2017-10-21 9:00:00">2017-10-21</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2022-02-24T16:45:06.575Z" title="2022-2-25 1:45:06">2022-02-25</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Raspberry-Pi/">Raspberry Pi</a><span> / </span><a class="link-muted" href="/categories/Raspberry-Pi/Linux/">Linux</a></span><span class="level-item">17분안에 읽기 (약 2493 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2017/10/21/raspberrypi-2017-10-21-opensuse-jeos-nginxjupyter/">Raspberry Pi 3 64bit OS openSUSE: Nginx, Node JS, Jupyter </a></h1><div class="content"><p><strong>Raspberry Pi 3 64bit OS openSUSE</strong> 는 이글은 5개 글타래로 구성되며, openSUSE 설치, 개발도구 구성 및 서버 구축 사용에 대해 작성한다.</p>
<p>Opensuse 에서 Raspberry Pi 3를 위한 64bit OS openSESE Leap 42.2 을 제공하고 있다.</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://en.opensuse.org/HCL:Raspberry_Pi3">https://en.opensuse.org/HCL:Raspberry_Pi3</a></li>
</ul>
<ol>
<li><a href="!--swig%EF%BF%BC37--">Install 64bit openSUSE Leap 42.3 &#x2F; JeOS</a></li>
<li>openSUSE: Managing Service daemon</li>
<li>openSUSE: Basic OS Security for Server</li>
<li><strong>Install &amp; Configuration - Nginx, Node JS, Jupyter</strong></li>
<li>Build MongoDB 3.4.x</li>
</ol>
<h2 id="Nginx-Node-JS-Jupyter-Notebook"><a href="#Nginx-Node-JS-Jupyter-Notebook" class="headerlink" title="Nginx, Node JS, Jupyter Notebook"></a>Nginx, Node JS, Jupyter Notebook</h2><ul>
<li>Raspberry Pi 3</li>
<li>openSUSE LEAP 42.2 &#x2F; JeOS</li>
</ul>
<p>Target services</p>
<ul>
<li>Nginx</li>
<li>Nginx Proxy<ul>
<li>www app : nodejs (PORT 50000)</li>
<li>jupyter notebook: PORT 8585</li>
</ul>
</li>
<li>Node.js with nvm</li>
<li>Python and virtualenv, jupyter notebook</li>
</ul>
<h3 id="nginx"><a href="#nginx" class="headerlink" title="nginx"></a>nginx</h3><p>nginx는 1.8 버전으로 당연히 사용하던 데비안 계열과 설정 파일 구성이 조금 다르다.</p>
<ul>
<li>nginx 사용자: nginx</li>
<li>&#x2F;etc&#x2F;nginx&#x2F;nginx.conf 가 sites-_ 폴더가 아닌 vhost_ 폴더를 가르킨다.<ul>
<li>여기서는 sites-* 폴더를 그대로 사용한다.</li>
</ul>
</li>
<li>기존 데비안 계열 형식 <code>sites-*</code> 폴더를 사용하고 사용자먄 <code>nginx</code> 사용.</li>
</ul>
<h4 id="설치"><a href="#설치" class="headerlink" title="설치"></a>설치</h4><p>zypper 로 nginx 배포본을 설치한다. 현재는 1.8.1-10.5.1 버전이다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo zypper <span class="keyword">in</span> nginx</span><br></pre></td></tr></table></figure>

<p>설치하면 사용자 <em>nginx:nginx</em> 가 추가된다.</p>
<h4 id="nginx-conf"><a href="#nginx-conf" class="headerlink" title="nginx.conf"></a>nginx.conf</h4><p>nginx 설정은 <a href="!--swig%EF%BF%BC38--">Nginx - Install, WebDAV, Proxy on Ubuntu&#x2F;Debian</a> 에 설명되어 있다. 이 구성을 기초로 우분투&#x2F;데비안 계열 같이 <code>site-*</code> 폴더를 구성해서 사용한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /etc/nginx</span><br><span class="line"><span class="built_in">mv</span> nginx.conf nginx.orig</span><br></pre></td></tr></table></figure>

<p>nginx.conf 에 include 지시자를 사용해 <em>sites-enabled</em> 를 추가한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">include /etc/nginx/conf.d/*.conf;</span><br><span class="line">include /etc/nginx/sites-enabled/*;</span><br></pre></td></tr></table></figure>

<p>그리고 <code>sites-available</code>, <code>sites-enabled</code> 폴더를 생성하고 사이트 파일을 만든다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /etc/nginx</span><br><span class="line">sudo <span class="built_in">mkdir</span> sites-available sites-enabled</span><br><span class="line">sudo <span class="built_in">touch</span> sites-available/my-site</span><br></pre></td></tr></table></figure>

<p>my-site 가상호스트 파일은 [my-site](&#x2F;2017&#x2F;04&#x2F;03&#x2F;ubuntu-nginx#my-site) 내용의 파일을 site-available 에 작성하고, 그 링크를 site-enabled에 링크를 걸어 준다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /etc/nginx</span><br><span class="line">sudo -s /etc/nginx/sites-available/my-site /etc/nginx/sites-enabled/my-site</span><br></pre></td></tr></table></figure>

<br>
<br>
### node.js

<p>nvm을 설치한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.6/install.sh | bash</span><br></pre></td></tr></table></figure>

<p>Node.js 설치와 개발환경 설치에 대해서는 <a href="!--swig%EF%BF%BC40--">NodeJS &#x2F; nvm 기반 개발환경 설치</a> 글을 참조할 수 있다.</p>
<h4 id="node-js-설치"><a href="#node-js-설치" class="headerlink" title="node.js 설치"></a>node.js 설치</h4><p>최신 v8 버전을 설치한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; nvm install v8</span><br><span class="line">Downloading and installing node v8.8.1...</span><br><span class="line">Creating default alias: default -&gt; v8 (-&gt; v8.8.1)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; which node</span><br><span class="line">/home/qkboo/.nvm/versions/node/v8.8.1/bin/node</span><br></pre></td></tr></table></figure>

<h4 id="pm2-설치"><a href="#pm2-설치" class="headerlink" title="pm2 설치"></a>pm2 설치</h4><p>node.js 앱을 시스템 서비스로 등록하기 위해서 <strong>pm2</strong> 를 설치한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -g pm2</span><br></pre></td></tr></table></figure>

<p>예를 들어 express 앱이 있으면 다음 같이 pm2로 시작한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd www-app</span><br><span class="line">pm2 start -n &quot;www-app&quot; bin/www</span><br></pre></td></tr></table></figure>

<h4 id="pm2-startup"><a href="#pm2-startup" class="headerlink" title="pm2 startup"></a>pm2 startup</h4><p>startup 시 pm2 start 로 생성되는 .pm2 디렉토리의 pid 와 app.js 파일을 실행해 준다.</p>
<p>pm2 startup systemd 로 스타트를 하면 2개의 프로세스가 만들어 진다.</p>
<p>방법은,,,</p>
<ol>
<li>먼저 앱을 시작해 둔다.</li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pm2 start -n <span class="string">&quot;www-app&quot;</span> bin/www</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>dump를 생성한다.</li>
</ol>
<p>pm2로 현재 실행중인 프로세스 정보를 <code>save</code>로 덤프하게 저장한다. <code>systemd</code> 서비스 스크립을 작성하는데 유용하다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pm2 save</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>pm2 startup 명령</li>
</ol>
<p><code>pm2 startup</code> 명령은 pm2로 실행중인 프로세스를 systemd 서비스 유니트 파일로 제어 할 수 있다. 명령을 실행하면 <code>sudo</code> 명령으로 실행할 수 있는 스크립을 출력해 준다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ pm2 startup systemd</span><br><span class="line">...</span><br><span class="line">sudo <span class="built_in">env</span> PATH=<span class="variable">$PATH</span>:/home/foo/.nvm/versions/node/v8.8.1/bin /home/foo/.nvm/versions/node/v8.8.1/lib/node_modules/pm2/bin/pm2 startup systemd -u foo --hp /home/foo</span><br></pre></td></tr></table></figure>

<p>이 스크립을 실행해 주면 <strong>pm2-foo.service</strong> 서비스 유니 파일이 생성된다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Target path</span><br><span class="line">/etc/systemd/system/pm2-foo.service</span><br></pre></td></tr></table></figure>

<p>이 서비스 파일을 활성화하고 시작해준다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl <span class="built_in">enable</span> pm2-foo</span><br></pre></td></tr></table></figure>

<p>이제 시스템을 재시작해도 pm2 로 실행중인 프로세스는 자동으로 시작된다.</p>
<br>
<br>
### Python

<p>Python 개발 환경을 virtualenv 를 이용해서 구성하고, jupyter 를 설치한다. 그리고 시스템 시작 스크립으로 자동으로 시작하는 jupyter notebook 환경 구성까지 진행한다.</p>
<h4 id="python3-설치"><a href="#python3-설치" class="headerlink" title="python3 설치"></a>python3 설치</h4><p>openSUSE에 python2.7 만 설치되어 있어서, python3 를 설치한다. 다른 버전을 설치하면 openSUSE에서는 자동으로 update-alternatives로 <code>pip</code>를 등록해준다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo zypper <span class="keyword">in</span> python3</span><br><span class="line"></span><br><span class="line">update-alternatives: using /usr/bin/pip3.4 to provide /usr/bin/pip (pip) <span class="keyword">in</span> auto mode</span><br></pre></td></tr></table></figure>

<h4 id="개발자-패키지-설치"><a href="#개발자-패키지-설치" class="headerlink" title="개발자 패키지 설치"></a>개발자 패키지 설치</h4><p>jupyter 등 개발, 서버 개발에 필요한 시스템 개발도구를 설치한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo zypper <span class="keyword">in</span> devel_basis</span><br></pre></td></tr></table></figure>

<p>파이썬 개발과 패키지등에서 필요한 파이썬 헤더를 설치한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo zypper <span class="keyword">in</span> python3-devel python-devel</span><br></pre></td></tr></table></figure>

<p>jupyter에서 필요한 zmq 라이브러리를 설치한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo zypper <span class="keyword">in</span> python-distutils-extra libczmq3 libgdal20</span><br></pre></td></tr></table></figure>

<ul>
<li>libzmq3 : jupyter 에서 필요</li>
<li>libgdal : geospatial analysis with geopandas.</li>
</ul>
<p><strong>openSUSE 에서</strong>는 curses 관련 파이썬 모듈을 설치해야 한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo zypper <span class="keyword">in</span> python-curses python3-curses</span><br></pre></td></tr></table></figure>

<ul>
<li>python-curses: Python이 (N)Curses Libr에 대한 인터페이스이다</li>
</ul>
<h4 id="virtualenv"><a href="#virtualenv" class="headerlink" title="virtualenv"></a>virtualenv</h4><p><code>pip</code> 로 user scheme 에서 설치했다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install --user virtualenv virtualenvwrapper</span><br></pre></td></tr></table></figure>

<h4 id="Scientific-과-Pandas-개발환경"><a href="#Scientific-과-Pandas-개발환경" class="headerlink" title="Scientific 과 Pandas 개발환경"></a>Scientific 과 Pandas 개발환경</h4><p>사용하려는 Python 버전에 따라 혹은 모두 아래 과학계산용 모듈을 시스템 패키지로 설치한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo zypper <span class="keyword">in</span> python-decorator python-numpy python-scipy python-matplotlib</span><br><span class="line">sudo zypper <span class="keyword">in</span> python3-decorator python3-numpy python3-scipy python3-matplotlib</span><br><span class="line">sudo zypper <span class="keyword">in</span> python3-sympy python3-nose</span><br></pre></td></tr></table></figure>

<blockquote>
<p>라즈베피라이, 오드로이드 등 환경에서 pip로 위 모듈을 설치시 시간이 많이 걸린다.</p>
<blockquote>
<p>pip install –user pandas decorator numpy scipy matplotlib sympy nose<br>그래서 시스템 패키지로 설치했다.</p>
</blockquote>
</blockquote>
<p>겨로가적으로 앞선 scipy, matplotlib 설치하며 아래 모듈이 의존성에 따라 함게 설치된다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3-requests python3-pil python3-scrapy python3-geopy python3-shapely python3-pyproj</span><br></pre></td></tr></table></figure>

<h3 id="Jupyter-Notebook"><a href="#Jupyter-Notebook" class="headerlink" title="Jupyter Notebook"></a>Jupyter Notebook</h3><p>Jupyter notebook 으로 파이선, typescript, javascript, c&#x2F;c++ 등의 IDE 역할을 할 수 있다. 도한 Markdown 을 지원해서 문서화에도 휼륭한 플랫폼이다.</p>
<h4 id="jupyter-가상환경-만들기"><a href="#jupyter-가상환경-만들기" class="headerlink" title="jupyter 가상환경 만들기"></a><em>jupyter</em> 가상환경 만들기</h4><p><code>mkvirtualenv</code> 명령으로 <em>jupyter</em> 라는 가상환경을 만드는데, 과학계산용 라이브러리를 시스템 패키지로 설치했으므로 여기서는 가상환경 생성시 시스템 패키지를 함께 참조하도록 생성한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkvirtualenv -p python3 --system-site-packages jupyter</span><br><span class="line">(jupyter) $</span><br></pre></td></tr></table></figure>

<p>가상환경에서 파이썬 버전을 확인하고 과학계산 개발 등에 필요한 라이브러리가 설치됐는지 확인하자.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(jupyter) $ python --version</span><br><span class="line">Python 3.4.6</span><br></pre></td></tr></table></figure>

<p>필수 모듈이 설치되고 사용이 가능한지 확인한다. 버전 정보가 출력되면 관련 라이브러리가 제대로 설치되었고 가상환경에서 잘 접근되는 것이다. 다음 두 모듈이 없으면 jupyter 설치가 제대로 안된다.</p>
<blockquote>
<p>설치가 안되었으면 앞의 파이썬 개발자 패키지 설치 단락을 확인한다.</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="string">&quot;import numpy;print(numpy.__version__)&quot;</span></span><br><span class="line">1.9.3</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="string">&quot;import numpy;print(numpy.__version__)&quot;</span></span><br><span class="line">0.16.0</span><br></pre></td></tr></table></figure>

<p>그리고 Jupyter 가상환경에서 <code>pip</code> 로 <strong>Jupyter</strong>를 설치한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(jupyter)$ pip install jupyter</span><br></pre></td></tr></table></figure>

<p>주피커 노트북 파일이 저장되는 위치가 <code>iPython</code> 디렉토리라고 하면 아래 같이 시작할 수 있다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(jupyter)$ jupyter-notebook --no-browser --ip=* --port=8000 ./iPython</span><br></pre></td></tr></table></figure>

<p>옵션은</p>
<ul>
<li><code>--no-browser</code> : 로컬 브라우저는 시작하지 않는다.</li>
<li><code>--ip</code> : 접속 가능 <code>*</code>는 모든 곳에서 접근 가능</li>
<li><code>--port</code>:</li>
</ul>
<p>이런 시작 구성을 설정 파일을 이용해서 저장할 수 있고 이 파일을 이용해서 시작하는 것을 권장한다.</p>
<h4 id="Jupyter-설정-파일-이용"><a href="#Jupyter-설정-파일-이용" class="headerlink" title="Jupyter 설정 파일 이용"></a>Jupyter 설정 파일 이용</h4><p>사용자 <strong>JUPYTER_DATA_DIR</strong> 인 홈 디렉토리 밑 <code>~/.jupyter</code> 에 설정 파일을 구성해야 한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(jupyter)$ jupyter notebook --generate-config</span><br><span class="line">(jupyter)$ <span class="built_in">cd</span> .jupyter &amp;&amp; <span class="built_in">mv</span> jupyter_notebook_config.py mynotebook.py</span><br></pre></td></tr></table></figure>

<h4 id="systemd"><a href="#systemd" class="headerlink" title="systemd"></a>systemd</h4><p>jupyter notebook을 시스템 서비스로 등록해 보자. <code>jupyter.service</code>라는 시스템 서비스 파일을 <code>/etc/systemd/system/jupyter.service</code> 에 생성하고 아래 내용을 입력한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=HomePi Jupyter-Notebook</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line">PIDFile=/run/homepi-jupyter.pid</span><br><span class="line">ExecStart=/home/foo/.virtualenvs/jupyter/bin/jupyter-notebook --config=/home/foo/.jupyter/mybook_config.py</span><br><span class="line">User=qkboo</span><br><span class="line">Group=users</span><br><span class="line">WorkingDirectory=/home/foo/iPython</span><br><span class="line">Restart=always</span><br><span class="line">RestartSec=10</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>

<p>그리고 이 시스템 서비스 파이을 활성화하고 시작한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl <span class="built_in">enable</span> jupyter.service</span><br><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart jupyter.service</span><br></pre></td></tr></table></figure>

<h4 id="Typescript-kernel"><a href="#Typescript-kernel" class="headerlink" title="Typescript kernel"></a>Typescript kernel</h4><p>jupyter notebook에서 Typescript 을 작성하고 컴파일한 결과를 확인할 수 있다.</p>
<p>먼저 Nodejs용 itypescript 모듈을 global로 설치한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g itypescript</span><br></pre></td></tr></table></figure>

<p>its 명령으로 Jupyter kenel로 설치해 준다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">its --ts-install=<span class="built_in">local</span></span><br></pre></td></tr></table></figure>

<h3 id="Jupyter-notebook-Nginx-설정"><a href="#Jupyter-notebook-Nginx-설정" class="headerlink" title="Jupyter-notebook Nginx 설정"></a>Jupyter-notebook Nginx 설정</h3><p>Jupyter-notebook 을 nginx 뒤에서 실행시 아래 같은 동작이 반복적으로 보이이면</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[I 19:26:48.843 NotebookApp] Adapting to protocol v5.1 for kernel 97e659cd-0509-4f56-878e-10e2c31803e2</span><br><span class="line">[I 19:26:48.853 NotebookApp] Restoring connection for 97e659cd-0509-4f56-878e-10e2c31803e2:b4d78dff5dff4563b0e5fc7195fefca1</span><br><span class="line">[I 19:26:48.881 NotebookApp] Starting buffering for 97e659cd-0509-4f56-878e-10e2c31803e2:b4d78dff5dff4563b0e5fc7195fefca1</span><br><span class="line">[I 19:26:51.904 NotebookApp] Adapting to protocol v5.1 for kernel 97e659cd-0509-4f56-878e-10e2c31803e2</span><br><span class="line">[W 19:26:51.930 NotebookApp] Replacing stale connection: 97e659cd-0509-4f56-878e-10e2c31803e2:b4d78dff5dff4563b0e5fc7195fefca1</span><br><span class="line">[W 19:26:51.957 NotebookApp] Replacing stale connection: 97e659cd-0509-4f56-878e-10e2c31803e2:b4d78dff5dff4563b0e5fc7195fefca1</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/42350182/jupyter-notebook-keeps-reconnecting-to-kernel">jupyter-notebook-keeps-reconnecting</a> 설명 처럼 nginx proxy 에서 http 버전을 명시해 준다.</p>
<p>If you are using jupyter behind a nginx proxy, this post may be effective.</p>
<p>Add this line to nginx conf.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxy_http_version 1.1;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html">http_proxy_module</a> 에 따르면 keepalive 를 사용하기 위해서 1.1 버전을 꼭 사용해야 할 것 같다.</p>
<blockquote>
<p>Sets the HTTP protocol version for proxying. By default, version 1.0 is used. Version 1.1 is recommended for use with keepalive connections and NTLM authentication.</p>
</blockquote>
<p>참조용 jupyter-notebook conf</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">upstream my-notebook-workhorse &#123;</span><br><span class="line">  server 127.0.0.1:8888 fail_timeout=0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">map $http_upgrade $connection_upgrade &#123;</span><br><span class="line">    default upgrade;</span><br><span class="line">    &#x27;&#x27; close;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># let my-notebook deal with the redirection</span><br><span class="line">server &#123;</span><br><span class="line">  listen                    80;</span><br><span class="line">  server_name               my-notebook.wh;</span><br><span class="line">  server_tokens             off;</span><br><span class="line">  root                      /dev/null;</span><br><span class="line"></span><br><span class="line">  # Increase this if you want to upload larger attachments</span><br><span class="line">  client_max_body_size      20m;</span><br><span class="line"></span><br><span class="line">  # individual nginx logs for this vhost</span><br><span class="line">  access_log                /var/log/nginx/my-notebook_access.log;</span><br><span class="line">  error_log                 /var/log/nginx/my-notebook_error.log;</span><br><span class="line"></span><br><span class="line">  location / &#123;</span><br><span class="line">    proxy_pass http://my-notebook-workhorse;</span><br><span class="line">    proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">    proxy_set_header Host $host;</span><br><span class="line">    proxy_set_header X-Forwarded_For $proxy_add_x_forwarded_for;</span><br><span class="line">    proxy_set_header X-NginX-Proxy true;</span><br><span class="line">    auth_basic &quot;Restricted Content&quot;;</span><br><span class="line"></span><br><span class="line">    # WebSocket support</span><br><span class="line">    proxy_http_version 1.1;</span><br><span class="line">    proxy_set_header Upgrade $http_upgrade;</span><br><span class="line">    proxy_set_header Connection $connection_upgrade;</span><br><span class="line">    proxy_set_header Origin &quot;&quot;;</span><br><span class="line">    proxy_read_timeout 86400;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="참조"><a href="#참조" class="headerlink" title="참조"></a>참조</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.howtoforge.com/tutorial/how-to-deploy-nodejs-applications-with-pm2-and-nginx-on-ubuntu/">How to deploy nodejs app with pm2</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2017-10-21T00:00:00.000Z" title="2017-10-21 9:00:00">2017-10-21</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2022-02-24T16:16:51.966Z" title="2022-2-25 1:16:51">2022-02-25</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Raspberry-Pi/">Raspberry Pi</a><span> / </span><a class="link-muted" href="/categories/Raspberry-Pi/Linux/">Linux</a></span><span class="level-item">3분안에 읽기 (약 406 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2017/10/21/raspberrypi/2017-10-21-opensuse-jeos-securities/">Raspberry Pi 3 64bit OS openSUSE: Basic Security</a></h1><div class="content"><p><strong>Raspberry Pi 3 64bit OS openSUSE</strong> 는 이글은 3개 글타래로 구성되며, openSUSE 설치 및 사용에 대해 작성한다.</p>
<p>Opensuse 에서 Raspberry Pi 3를 위한 64bit OS openSESE Leap 42.3 을 제공하고 있다.</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://en.opensuse.org/HCL:Raspberry_Pi3">https://en.opensuse.org/HCL:Raspberry_Pi3</a></li>
</ul>
<ol>
<li><a href="!--swig%EF%BF%BC5--">Install 64bit openSUSE Leap 42.3 &#x2F; JeOS</a></li>
<li>openSUSE: Managing Service daemon</li>
<li>openSUSE: Basic OS Security for Server</li>
<li>Install &amp; Configuration - Nginx, Node JS</li>
<li>Build MongoDB 3.4.x</li>
</ol>
<h2 id="openSUSE-Basic-OS-Security-for-Server"><a href="#openSUSE-Basic-OS-Security-for-Server" class="headerlink" title="openSUSE: Basic OS Security for Server"></a>openSUSE: Basic OS Security for Server</h2><p>이전 글에서 라즈베리파이 3에 설치한 64bit OS openSUSE LEAP &#x2F; JeOS를 서버 구성을 위해서 보안 설정을 한다. 이 글은 다음 세가지 내용을 포함하고 있다.</p>
<ul>
<li>ssh와 sshd 설정</li>
<li>방화벽 설정: YaST Firewall 대비 ufw 설치</li>
<li>Fail2ban 설치 및 설정</li>
</ul>
<h3 id="sshd-config"><a href="#sshd-config" class="headerlink" title="sshd_config"></a>sshd_config</h3><p>ssh 사용시 </p>
<p><a href="/linux/sshd-basic-securities/">sshd securities</a></p>
<h3 id="방화벽-설정"><a href="#방화벽-설정" class="headerlink" title="방화벽 설정"></a>방화벽 설정</h3><p>openSUSE 42.3까지 SuSEfirewall2 가 기본으로 제공되어 서비스를 활성화 하면 사용할 수 있다. </p>
<h4 id="UFW"><a href="#UFW" class="headerlink" title="UFW"></a>UFW</h4><p>SuSEFirewall2 을 우분투&#x2F;데비안에서 익숙한 ufw 를 사용할 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Basic Syntax:</span><br><span class="line">    yast2 firewall interactive</span><br><span class="line">    yast2 firewall &lt;command&gt; [verbose] [options]</span><br><span class="line">    yast2 firewall help</span><br><span class="line">    yast2 firewall longhelp</span><br><span class="line">    yast2 firewall xmlhelp</span><br><span class="line">    yast2 firewall &lt;command&gt; help</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">    broadcast     Broadcast packet settings</span><br><span class="line">    disable       Disables firewall</span><br><span class="line">    enable        Enables firewall</span><br><span class="line">    interfaces    Network interfaces configuration</span><br><span class="line">    logging       Logging settings</span><br><span class="line">    masqredirect  Redirect requests to masqueraded IP</span><br><span class="line">    masquerade    Masquerading settings</span><br><span class="line">    services      Allowed services, ports, and protocols</span><br><span class="line">    startup       Start-up settings</span><br><span class="line">    summary       Firewall configuration summary</span><br><span class="line">    zones         Known firewall zones</span><br></pre></td></tr></table></figure>

<p>먼저 SuSEfirewall2 를 멈추고 비활성화 한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yast firewall disable</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop SuSEfirewall2</span><br><span class="line">systemctl <span class="built_in">disable</span> SuSEfirewall2</span><br></pre></td></tr></table></figure>

<p>그리고 ufw를 설치하고</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zypper in ufw</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ufw default deny</span><br><span class="line">ufw enable</span><br><span class="line">systemctl enable ufw</span><br><span class="line">systemctl start ufw</span><br></pre></td></tr></table></figure>


<h3 id="Fail2ban"><a href="#Fail2ban" class="headerlink" title="Fail2ban"></a>Fail2ban</h3><p>rsyslog 를 설치한다.</p>
<p><a target="_blank" rel="noopener" href="https://en.opensuse.org/SDB:SSH_systematic_attack_protection">https://en.opensuse.org/SDB:SSH_systematic_attack_protection</a></p>
<p><a target="_blank" rel="noopener" href="https://www.howtoforge.com/fail2ban_opensuse10.3">https://www.howtoforge.com/fail2ban_opensuse10.3</a></p>
<p>zypper in fail2ban</p>
<h2 id="참조"><a href="#참조" class="headerlink" title="참조"></a>참조</h2><p><a target="_blank" rel="noopener" href="https://en.opensuse.org/SDB:OpenSSH_public_key_authentication">OpenSSH Public Key Authentication</a></p>
<p><a target="_blank" rel="noopener" href="https://doc.opensuse.org/documentation/leap/security/html/book.security/cha.security.firewall.html">https://doc.opensuse.org/documentation/leap/security/html/book.security/cha.security.firewall.html</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2017-10-20T00:10:00.000Z" title="2017-10-20 9:10:00">2017-10-20</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2022-02-24T16:47:05.972Z" title="2022-2-25 1:47:05">2022-02-25</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Raspberry-Pi/">Raspberry Pi</a><span> / </span><a class="link-muted" href="/categories/Raspberry-Pi/Linux/">Linux</a></span><span class="level-item">20분안에 읽기 (약 2968 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2017/10/20/raspberrypi-2017-10-20-opensuse-jeos-install/">Raspberry Pi 3 64bit OS openSUSE: Install</a></h1><div class="content"><blockquote>
<p>2017-10-30: swap 추가, timezone 수정<br>{:.right-history}</p>
</blockquote>
<p>Opensuse 에서 Raspberry Pi 3를 위한 64bit OS openSESE Leap 42.2 을 제공하고 있다.</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://en.opensuse.org/HCL:Raspberry_Pi3">https://en.opensuse.org/HCL:Raspberry_Pi3</a></li>
</ul>
<p>이글은 5개 글타래로 구성되며, openSUSE 설치 및 사용에 대해 작성한다.</p>
<ol>
<li><strong>Install 64bit openSUSE Leap 42.2 &#x2F; JeOS</strong></li>
<li>openSUSE: Managing Service daemon</li>
<li>openSUSE: Basic OS Security for Server</li>
<li><a href="!--swig%EF%BF%BC32--">Install &amp; Configuration - Nginx, Node JS, Jupyter</a></li>
<li>openSUSE: Build MongoDB 3.4.x</li>
</ol>
<h2 id="Install-64bit-openSUSE-Leap-42-2-x2F-JeOS"><a href="#Install-64bit-openSUSE-Leap-42-2-x2F-JeOS" class="headerlink" title="Install 64bit openSUSE Leap 42.2 &#x2F; JeOS"></a>Install 64bit openSUSE Leap 42.2 &#x2F; JeOS</h2><p>openSUSE는 <strong>Raspberry Pi 3</strong>를 위한 Opensuse community edition은 정식 버전 <strong>Leap 42.2 image</strong>, 개발버전 <em>Tumbleweed image</em>, 커뮤니티버전 non-upstream openSUSE Tumbleweed image* 으로 구성되어 있다.</p>
<p>이들 버전은 용도에 따라 JeOS, E20, LXQT X11 이미지로 다운받을 수 있다.</p>
<ul>
<li><p>Just Enought Operating System (JeOS)</p>
<ul>
<li>jeOS 이미지는 기본 오에스만을 포함하고 있다.</li>
<li><a target="_blank" rel="noopener" href="https://www.suse.com/products/server/jeos/">https://www.suse.com/products/server/jeos/</a></li>
</ul>
</li>
<li><p>E20</p>
<ul>
<li>데스크탑 환경으로 Enlightenment 을 사용하 GUI 이미지</li>
</ul>
</li>
<li><p>LXQt</p>
<ul>
<li>LXDE-Qt 와 RazorQt 병합한 데스크탑 환경</li>
<li><a target="_blank" rel="noopener" href="https://en.opensuse.org/LXQt">https://en.opensuse.org/LXQt</a></li>
</ul>
</li>
</ul>
<br>
### Download and Install

<p><a target="_blank" rel="noopener" href="https://en.opensuse.org/HCL:Raspberry_Pi3">Download Page</a> 의 두번째 <em>Installing the 64-bit openSUSE Leap image</em> 단락에 있는 JeOS image 를 다운로드 한다.</p>
<h4 id="Writing-image-to-SD-Card"><a href="#Writing-image-to-SD-Card" class="headerlink" title="Writing image to SD Card"></a>Writing image to SD Card</h4><p><a target="_blank" rel="noopener" href="http://etcher.io/">Etcher</a> 등을 이용해서 다운받은 이미지 파일을 SD Card에 쓴다.</p>
<p><img src="/images/opensuse/etcher-image-writing.png">{:width&#x3D;”640”}</p>
<h5 id="dd-를-사용한다면"><a href="#dd-를-사용한다면" class="headerlink" title="dd 를 사용한다면,"></a><code>dd</code> 를 사용한다면,</h5><p>다운받은 <code>.xz</code> 파일을 <code>dd</code> 를 이용해서 SD Card에 쓴다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xzcat openSUSE-Leap42.2-ARM-JeOS-raspberrypi3.aarch64.raw.xz | sudo dd of=/dev/rdisk1 bs=4m; sync</span><br></pre></td></tr></table></figure>

<br>
#### Serial console

<p>여기서는 <strong>Serial console</strong>에서 네트워크 확인 및 초기 설정을 하고 <strong>ssh</strong> 로 서버에 로그인해서 시스템 구성을 진행한다.</p>
<blockquote>
<p>SD Card를 라즈베리파이에 꽃고 HDMI, Keyboard 및 Mouse 가 별도로 준비되어 있으면 직접 모니터를 보고 작업을 진행하면 좋다.</p>
</blockquote>
<p>USB to Serial 케이블을 사용해서 Raspberry Pi의 Serial Console에 연결한다.</p>
<p><img src="/images/raspberrypi/rpi-usb-serial.png">{:width&#x3D;”640”}</p>
<p>그리고 시리얼 포트를 통해 tty 연결을 위해 터미널 프로그램에서 baud rate 115200 으로 연결한다. 아래는 macOS의 <code>screen</code> CLI 명령으로 usb serial 포트에 연결하고 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ screen /dev/cu.usbserial 115200</span><br></pre></td></tr></table></figure>

<p>이제 SD Card를 넣고 부팅을 하면, 터미널에 부트 단계가 진행되고 처음 5분 정도 소요된다.</p>
<p><img src="/images/opensuse/opensuse-boot33.png">{:width&#x3D;”640”}</p>
<p>Raspberry Pi를 위한 이미지는 처음 계정은 <code>root/linux</code> 이다.</p>
<p>터미널에서 uname 은 <strong>aarch64</strong> 임을 확인 할 수 있다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root<span class="comment"># uname -a</span></span><br><span class="line">Linux homepi 4.4.90-18.32-default <span class="comment">#1 SMP Fri Oct 6 13:30:08 UTC 2017 (465b410) aarch64 aarch64 aarch64 GNU/Linux</span></span><br></pre></td></tr></table></figure>

<p>처음으로 라즈베리파이에서 64bit 환경으로 운영해 볼 수 있게 됐다.</p>
<br>
<br>
### 설치 후 서버 구성을 위해 할 일

<p>JeOS를 서버로 구성하기 위해서 다음 같은 작업을 수행해 준다.</p>
<ul>
<li>root 패스워드 변경</li>
<li>sudoer 사용자 생성</li>
<li>DHCP를 고정 IP로 변경</li>
</ul>
<h4 id="root-패스워드"><a href="#root-패스워드" class="headerlink" title="root 패스워드"></a>root 패스워드</h4><p>root 사용자의 패스워드를 변경한다.</p>
<p><img src="/images/opensuse/opensuse-root-passwd.png">{:width&#x3D;”640”}</p>
<h4 id="Update"><a href="#Update" class="headerlink" title="Update"></a>Update</h4><p>Ubuntu&#x2F;Debian 계열의 패키지 명령 <code>apt</code>,<code>apt-get</code> 과 비슷한 openSUSE 명령라인 패키지 관리자는 <strong>zypper</strong> 가 있다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">zypper <span class="built_in">help</span> search     <span class="comment"># to print help for the search command</span></span><br><span class="line">zypper refresh, ref    <span class="comment"># Refresh all repositories.</span></span><br><span class="line">zypper update,  up     <span class="comment"># to update all installed packages</span></span><br><span class="line">zypper lp              <span class="comment"># to see what patch updates are needed</span></span><br><span class="line">zypper patch           <span class="comment"># to apply the needed patches</span></span><br><span class="line">zypper se sqlite       <span class="comment"># to search for sqlite</span></span><br><span class="line">zypper <span class="built_in">rm</span> sqlite2      <span class="comment"># to remove sqlite2</span></span><br><span class="line">zypper <span class="keyword">in</span> sqlite3      <span class="comment"># to install sqlite3</span></span><br><span class="line">zypper <span class="keyword">in</span> yast*        <span class="comment"># to install all packages matching &#x27;yast*&#x27;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><a target="_blank" rel="noopener" href="https://en.opensuse.org/SDB:Zypper_usage">zypper usages</a> 에서 사용방법을 자세히 알 수 있다.</li>
</ul>
<p>머저 최신 소프트웨어 목록으로 업데이트 한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">zypper refresh</span><br><span class="line">zypper ref</span><br></pre></td></tr></table></figure>

<p>그리고 최근 업그레이드된 필요한 패키지를 다운로드하고 설치한다.[^1]</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">zypper update</span><br><span class="line">zypper up</span><br></pre></td></tr></table></figure>

<blockquote>
<p>지원중단된 패키지, 나뉘어진 패키지 등의 의존성을 고려한 업그레이드를 하려면 <code>dup</code> 명령을 사용한다.&gt;</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">zypper dup             <span class="comment"># distribution upgrade</span></span><br><span class="line">zypper dist-upgrade</span><br></pre></td></tr></table></figure>
</blockquote>
<h5 id="upgrade-후에"><a href="#upgrade-후에" class="headerlink" title="upgrade 후에"></a>upgrade 후에</h5><p>실행중인 데몬을 재시작해줄 필요가 있는데 <code>zypper ps -s</code> 를 실행하면 목록을 표시해 준다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">pi64:/home/ # zypper ps -s</span><br><span class="line">The following running processes use deleted files:</span><br><span class="line"></span><br><span class="line">PID   | PPID  | UID  | User       | Command                    | Service</span><br><span class="line">------+-------+------+------------+----------------------------+-------------------</span><br><span class="line">307   | 1     | 0    | root       | systemd-journald (deleted) | systemd-journald</span><br><span class="line">484   | 1     | 0    | root       | auditd                     | auditd</span><br><span class="line">502   | 1     | 1000 | qkboo      | python3                    | jupyter</span><br><span class="line">513   | 1     | 499  | messagebus | dbus-daemon (deleted)      | dbus</span><br><span class="line">525   | 1     | 0    | root       | systemd-logind (deleted)   | systemd-logind</span><br><span class="line">529   | 1     | 0    | root       | agetty (deleted)           | getty@tty1</span><br><span class="line">996   | 1     | 0    | root       | cupsd                      | cups</span><br><span class="line">1018  | 1     | 0    | root       | cron                       | cron</span><br><span class="line">1043  | 1     | 74   | ntp        | ntpd                       | ntpd</span><br><span class="line">1047  | 1043  | 74   | ntp        | ntpd                       | ntpd</span><br><span class="line">1145  | 1     | 0    | root       | python2.7                  | fail2ban</span><br><span class="line">1146  | 1     | 1000 | qkboo      | node                       | pm2-qkboo</span><br><span class="line">2131  | 1     | 0    | root       | agetty (deleted)           | serial-getty@ttyS0</span><br><span class="line">5716  | 1146  | 1000 | qkboo      | node                       | pm2-qkboo</span><br><span class="line">5749  | 1146  | 1000 | qkboo      | node                       | pm2-qkboo</span><br><span class="line">12400 | 1     | 0    | root       | sshd (deleted)             |</span><br><span class="line">12402 | 1     | 1000 | qkboo      | systemd (deleted)          |</span><br><span class="line">12405 | 0     | 1000 | qkboo      | systemd (deleted)          |</span><br><span class="line">12411 | 12400 | 1000 | qkboo      | sshd (deleted)             |</span><br><span class="line">12412 | 12411 | 1000 | qkboo      | bash                       |</span><br><span class="line">12783 | 12412 | 0    | root       | sudo                       |</span><br><span class="line">12784 | 12783 | 0    | root       | bash                       |</span><br><span class="line">12876 | 1     | 0    | root       | nginx                      | nginx</span><br><span class="line">12879 | 12876 | 494  | nginx      | nginx                      | nginx</span><br><span class="line">12880 | 12876 | 494  | nginx      | nginx                      | nginx</span><br><span class="line">12881 | 12876 | 494  | nginx      | nginx                      | nginx</span><br><span class="line">12882 | 12876 | 494  | nginx      | nginx                      | nginx</span><br><span class="line">15908 | 502   | 1000 | qkboo      | node                       | jupyter</span><br><span class="line">15916 | 15908 | 1000 | qkboo      | node                       | jupyter</span><br><span class="line">26929 | 502   | 1000 | qkboo      | node                       | jupyter</span><br></pre></td></tr></table></figure>

<h4 id="ip-주소-확인"><a href="#ip-주소-확인" class="headerlink" title="ip 주소 확인"></a>ip 주소 확인</h4><p>ifconfig 명령으로 현재 IP Address를 확인하고 이 IP Address에 <code>ssh</code> 를 사용해 접속한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">linux:~ <span class="comment"># ifconfig</span></span><br><span class="line">eth0      Link encap:Ethernet  HWaddr B9:40:EB:BA:10:02</span><br><span class="line">          inet addr:192.168.1.104  Bcast:192.168.1.255  Mask:255.255.255.0</span><br><span class="line">          inet6 addr: fe90::ba37:ebff:feba:1012/64 Scope:Link</span><br><span class="line">          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1</span><br><span class="line">          RX packets:83136 errors:0 dropped:0 overruns:0 frame:0</span><br><span class="line">          TX packets:27300 errors:0 dropped:0 overruns:0 carrier:0</span><br><span class="line">          collisions:0 txqueuelen:1000</span><br><span class="line">          RX bytes:120797947 (115.2 Mb)  TX bytes:2369690 (2.2 Mb)</span><br><span class="line">linux:~ <span class="comment">#</span></span><br><span class="line">linux:~ <span class="comment"># shutdown now</span></span><br></pre></td></tr></table></figure>

<p>좀더 편리한 사용을 위해 <code>ifconfig</code> 명령으로 찾은 IP address에 ssh 로그인을 해서 작업을 진행한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh root@192.168.1.104</span><br></pre></td></tr></table></figure>

<br>
<br>
### 시스템 설정

<p>이제 sudoer 사용자로 시스템을 서버에 적합하게 구성해 보자.</p>
<ul>
<li>sudoer 추가</li>
<li>yast 소개</li>
<li>timezone</li>
<li>Network 구성: 호스트 이름, IP 주소</li>
<li>swap 개선</li>
<li>yast로 사용자 추가</li>
</ul>
<h4 id="sudoer"><a href="#sudoer" class="headerlink" title="sudoer"></a>sudoer</h4><p><strong>root</strong> 사용자가 아닌 일반사용자를 <code>sudoer</code>로 등록해 관리자 기능을 대행 할 수 있다. 그러기 위해서 먼저 사용자를 추가한다. openSUSE <code>yast</code>라는 시스템 도구로 할 수 있지만 여기선 <code>useradd</code> 명령을 사용해서 사용자 추가한다. <code>useradd</code>에 대해서는 <a target="_blank" rel="noopener" href="http://www.tecmint.com/add-users-in-linux/">useradd 명령</a>을 참조한다.</p>
<p><code>useradd</code> 는 홈 디렉토리, 쉘 등에 대한 옵션을 주고 사용자를 등록한다.</p>
<ul>
<li>추가한 사용자를 &#x2F;etc&#x2F;passwd, &#x2F;etc&#x2F;shadow, &#x2F;etc&#x2F;group and &#x2F;etc&#x2F;gshadow 추가</li>
<li>그리고 <code>-m</code> 옵션으로 으로 사용자 홈 디렉토리 까지 생성한다.</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root<span class="comment">#  useradd -m foo</span></span><br></pre></td></tr></table></figure>

<p>그리고 패스워드를 등록한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root<span class="comment"># passwd foo</span></span><br><span class="line">New password:</span><br><span class="line">Retype new password:</span><br><span class="line">passwd: password updated successfully</span><br></pre></td></tr></table></figure>

<h4 id="sudoer-등록"><a href="#sudoer-등록" class="headerlink" title="sudoer 등록"></a>sudoer 등록</h4><p><code>visudo</code> 명령으로 <em>&#x2F;etc&#x2F;sudoers</em> 파일을 편집한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo visudo</span><br></pre></td></tr></table></figure>

<p><em>sudoer</em> 파일에 있는 <em>User privilege</em> 항목 아래에 새로운 사용자 foo를 아래 같이 등록한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># User privilege specification</span><br><span class="line">root  ALL=(ALL) ALL</span><br><span class="line">foo  ALL=(ALL) ALL</span><br></pre></td></tr></table></figure>

<p>이제 root에서 로그아웃하고 새로 추가한 사용자로 로그인한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ ssh foo@192.168.1.104</span><br><span class="line">Password:</span><br><span class="line">Have a lot of fun...</span><br><span class="line">foo@linux:~&gt;</span><br></pre></td></tr></table></figure>

<p>openSUSE는 관리자용 명령을 직접 내리면 찾지 못한다고 한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">foo@linux:~&gt; yast2 timezone</span><br><span class="line">-bash: yast2: <span class="built_in">command</span> not found</span><br></pre></td></tr></table></figure>

<p>그리고 처음으로 sudoer 사용자가 관리자 권한이 필요한 명령을 사용하기 위해 <code>sudu</code> 로 명령을 내리면 아래 같은 경고가 나온다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">foo@linux:~&gt; sudo /sbin/yast2 timezone</span><br><span class="line"></span><br><span class="line">We trust you have received the usual lecture from the <span class="built_in">local</span> System</span><br><span class="line">Administrator. It usually boils down to these three things:</span><br><span class="line"></span><br><span class="line">    <span class="comment">#1) Respect the privacy of others.</span></span><br><span class="line">    <span class="comment">#2) Think before you type.</span></span><br><span class="line">    <span class="comment">#3) With great power comes great responsibility.</span></span><br></pre></td></tr></table></figure>

<p>openSUSE는 시스템 관리 도구로 <code>yast</code> 를 사용해서 소프트웨어 설치, 네트워크 구성, 시간 관리, 보안 및 사용자 등을 다루는 소프트웨어로 GUI와 CLI 모두 사용할 수 있다.</p>
<p>시스템 네트워크를 구성하기 위해서 <code>yast</code> 명령을 사용해보자,</p>
<h4 id="yast"><a href="#yast" class="headerlink" title="yast"></a>yast</h4><p>yast는 GUI 혹은 ClI에서 사용이 가능하다 . 다음은 <code>sudo yast</code> 를 실행하면 Ncurse 로 표시되는 yast 화면이다.</p>
<p><img src="/images/opensuse/yast-cli-ui.png">{:width&#x3D;”640”}</p>
<p>TAB 키로 각 항목을 이동할 수 있고, Enter로 실행한다. 전체 화면에서 F9는 Cancel, F10은 OK 기능을 수행한다.</p>
<h4 id="Timezone"><a href="#Timezone" class="headerlink" title="Timezone"></a>Timezone</h4><p>처음 설치후 <em>CET</em> 시간대로 되어 있어서 Asia&#x2F;Seoul로 변경하고자 한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">linux:~ <span class="comment"># date</span></span><br><span class="line">Sun Oct 29 09:19:31 CET 2017</span><br></pre></td></tr></table></figure>

<p>시스템 시간대를 설정하려면 <code>yast</code> 를 시작해 <em>System -&gt; Date and Time</em> 을 실행해 시간대를 지정한다. 혹은 <code>yast timezone</code> 모듈 명령을 주면 해당 Date and Time 화면으로 이동할 수 있다.</p>
<p><img src="/images/opensuse/yast-date_time.png">{:width&#x3D;”640”}</p>
<p>시간대를 변경후 확인해 보면,</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">linux:~ # date</span><br><span class="line">Sun Oct 29 17:22:11 KST 2017</span><br></pre></td></tr></table></figure>

<p>ntp로 동기화하려면 <em>Other Settings…</em> 항목을 선택해 <em>ntp server</em> 를 설치하고 활성화 한다.</p>
<p><img src="/images/opensuse/yast-date_time-ntp1.png">{:width&#x3D;”640”}<br><img src="/images/opensuse/yast-date_time-ntp2.png">{:width&#x3D;”640”}</p>
<!--
참고로 ClI로 `yast` 명령을 사용할 수 있다. 예를 들어 timezone 사용 가능한 시간대는

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yast2 timezone list</span><br></pre></td></tr></table></figure>

<p>해당 하는 시간대 문자열을 이용해 시간대를 지정한다.</p>
<blockquote>
<p>sudo yast2 timezone set timezone&#x3D;[TIMEZONE]</p>
</blockquote>
<p>우리나라 시간대 ‘Asia&#x2F;Seoul (Seoul)’는 이렇게 지정할 수 있다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~&gt; sudo yast2 timezone <span class="built_in">set</span> timezone=<span class="string">&#x27;Asia/Seoul (Seoul)&#x27;</span></span><br></pre></td></tr></table></figure>
<p>–&gt;</p>
<h4 id="yast로-네트워크-설정하기"><a href="#yast로-네트워크-설정하기" class="headerlink" title="yast로 네트워크 설정하기"></a>yast로 네트워크 설정하기</h4><p>시스템 네트워크 구성을 설정하려면 <code>yast</code> 에서 <em>System -&gt; Network Settings</em> 을 실행한다.</p>
<p><img src="/images/opensuse/yast-network1.png">{:width&#x3D;”640”}</p>
<p>네트워크 구성 상태를 가져오는 시간이 걸린다.</p>
<p><img src="/images/opensuse/yast-network2.png">{:width&#x3D;”640”}</p>
<p>네트워크 구성을 시작한다. TAB으로 <code>Edit</code> 를 선택하고,</p>
<p><img src="/images/opensuse/yast-network-settings.png">{:width&#x3D;”640”}</p>
<p><em>Statically Assigned IP Address</em>를 선택하고, 아래 IP Address, Subnet Mask, Hostname 을 입력한다.</p>
<p><img src="/images/opensuse/yast-network-ip-address.png">{:width&#x3D;”640”}</p>
<p>TAB으로 이동해 <strong>Next</strong> 버튼을 누른다. 그리고 TAB으로 <strong>Hostname&#x2F;DNS</strong> 탭 으로 이동해서 Name Server를 입력한다. 보통 DHCP를 지원하는 공유기&#x2F;라우터에서 DNS server 역할을 하므로 게이트웨이 IP를 입력해도 무방하다.</p>
<p><img src="/images/opensuse/yast-network-host.png">{:width&#x3D;”640”}</p>
<p>마지막으로 <strong>Routing</strong> 탭을 이동해 Gateway를 입력해 준다.</p>
<p><img src="/images/opensuse/yast-network-gw.png">{:width&#x3D;”640”}</p>
<p>완료됐으면 <em>F10</em> 혹은 TAB으로 <strong>OK 버튼</strong>으로 이동해 설정한 내용을 저장한다. 이로서 수동 IP 주소 입력을 마친다.</p>
<p><code>yast</code> ClI 명령으로 Host 이름을 변경할 수 있다.</p>
<blockquote>
<p>yast dns edit hostname&#x3D;HOSTNAME</p>
</blockquote>
<p>또한 <code>yast</code> ClI 명령으로 소프트웨어 패키지를 설치 할 수 있다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo yast -i &lt;package_name&gt;</span><br><span class="line">sudo yast --install &lt;package_name&gt;</span><br></pre></td></tr></table></figure>

<h4 id="swap-개선"><a href="#swap-개선" class="headerlink" title="swap 개선"></a>swap 개선</h4><p>JeOS는 별도의 파티션에 swap을 가지고 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~&gt; sudo swapon -s</span><br><span class="line">Filename        Type    Size  Used  Priority</span><br><span class="line">/dev/mmcblk0p3                          partition 497384  1816  -1</span><br></pre></td></tr></table></figure>

<p>별도의 swap 을 1GB 크기 Swap file로 추가하려면</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ sudo dd if=/dev/zero of=/var/swapfile1G bs=1G count=1</span><br><span class="line">$ sudo chmod 600 /var/swapfile1G</span><br><span class="line">$ sudo mkswap /var/swapfile1G</span><br><span class="line">Setting up swapspace version 1, size = 1024 MiB (1073737728 bytes)</span><br><span class="line">no label, UUID=3b192470-5297-42ef-a033-b19b0de03590</span><br><span class="line"></span><br><span class="line">$ sudo swapon /var/swapfile1G</span><br><span class="line">$ sudo swapon -s</span><br></pre></td></tr></table></figure>

<p><code>mkswap</code> 명령 결과에 있는 <em>UUID&#x3D;…</em> 부분을 복사해 &#x2F;etc&#x2F;fstab 에 종속적으로 등록해 주면 재시동 후에도 사용 가능하다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UUID=3b192470-5297-42ef-a033-b19b0de03590 swap swap defaults 0 0</span><br></pre></td></tr></table></figure>

<h4 id="yast-사용자-추가"><a href="#yast-사용자-추가" class="headerlink" title="yast 사용자 추가"></a>yast 사용자 추가</h4><p>앞에서 <code>adduser</code> 명령으로 사용자를 추가했는데 openSUSE에서는 <code>yast</code>에서 사용할 수 있다. <code>yast</code> 를 시작해서 사용자 관리로 가거나, 아래 같이 바로 사용자 관리 화면으로 시작할 수 있다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yast2 <span class="built_in">users</span></span><br></pre></td></tr></table></figure>

<p>yast 화면에서 사용자 관리 화면,</p>
<p><img src="/images/opensuse/yast-user.png">{:width&#x3D;”650”}</p>
<p>다음 서버로 운영을 위해서 openSUSE에서 sshd 보안 강화, 방화벽, 필터링 등의 기본적인 보안 작업을 진행한다. <em>다음 openSUSE: Basic Security for Server</em></p>
<h4 id="Memory"><a href="#Memory" class="headerlink" title="Memory"></a>Memory</h4><p>rpi3 가 1GB 메인메모리로 출시, raspbian 실제 메모리 정보는,</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ cat /proc/meminfo</span><br><span class="line">MemTotal:         949572 kB</span><br><span class="line">MemFree:          386192 kB</span><br><span class="line">MemAvailable:     711148 kB</span><br></pre></td></tr></table></figure>

<p>rpi3에 openSUSE LEAP 42.2에서</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; cat /proc/meminfo</span><br><span class="line">MemTotal:         803988 kB</span><br><span class="line">MemFree:          661276 kB</span><br><span class="line">MemAvailable:     684504 kB</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://raspberrypi.stackexchange.com/questions/56266/raspberry-pi-3-has-less-than-1gb-memory-available-at-os-level">여기</a> 에 따르면 GPU 때문 인듯…</p>
<h3 id="tune2fs"><a href="#tune2fs" class="headerlink" title="tune2fs"></a>tune2fs</h3><p>fsck로 마지막 체크한 시간 확인은 <code>tune2fs</code> 명령을 이용</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$sudo tune2fs -l /dev/sdbX | grep Last\ c</span><br><span class="line">Last checked:             Sun Dec 13 09:14:22 2015</span><br></pre></td></tr></table></figure>

<h4 id="e2fsck-점검"><a href="#e2fsck-점검" class="headerlink" title="e2fsck 점검"></a>e2fsck 점검</h4><p>부팅시 e2fsck로 점검할 마운트 횟수가 설정되 있다. <code>-l</code> 옵션으로 확인한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tune2fs -l /dev/sdbX | grep Mount</span><br><span class="line">Mount count:              157</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tune2fs -l /dev/sdbX | grep Max</span><br><span class="line">Maximum mount count:      -1</span><br></pre></td></tr></table></figure>

<p>이 마운트 회수를 지정할 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tune2fs -c 10 /dev/sdb1</span><br></pre></td></tr></table></figure>

<br>

<h2 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h2><p><a target="_blank" rel="noopener" href="https://en.opensuse.org/HCL:Raspberry_Pi3#Installing_the_64-bit_openSUSE_Leap_image">Raspberry Pi 3: Installing 64bit openSuse Leap Image</a></p>
<p>[^1]: <a target="_blank" rel="noopener" href="https://en.opensuse.org/SDB:System_upgrade">System Upgrade</a><br>[^2]: <a target="_blank" rel="noopener" href="https://software.opensuse.org/package/net-tools-deprecated">net-tools deprecated</a><br>[^4]: <a target="_blank" rel="noopener" href="http://www.susegeek.com/networking/how-to-setup-persistent-static-routes-in-opensuse-110/">Static route in Opensuse</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2017-07-14T13:00:00.000Z" title="2017-7-14 22:00:00">2017-07-14</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2022-02-24T16:47:39.323Z" title="2022-2-25 1:47:39">2022-02-25</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Raspberry-Pi/">Raspberry Pi</a><span> / </span><a class="link-muted" href="/categories/Raspberry-Pi/Linux/">Linux</a></span><span class="level-item">23분안에 읽기 (약 3496 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2017/07/14/raspberrypi-2018-07-13-opensuse-leap15-install/">Raspberry Pi 3 64bit OS openSUSE LEAP 15: Install</a></h1><div class="content"><blockquote>
<p>2017-10-30: swap 추가, timezone 수정<br>{:.right-history}</p>
</blockquote>
<p>Opensuse 에서 Raspberry Pi 3를 위한 64bit OS openSESE Leap 42.2 을 제공하고 있다.</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://en.opensuse.org/HCL:Raspberry_Pi3">https://en.opensuse.org/HCL:Raspberry_Pi3</a></li>
</ul>
<p>이글은 5개 글타래로 구성되며, openSUSE 설치 및 사용에 대해 작성한다.</p>
<ol>
<li><strong>Install 64bit openSUSE Leap 42.2 &#x2F; JeOS</strong></li>
<li>openSUSE: Managing Service daemon</li>
<li>openSUSE: Basic OS Security for Server</li>
<li><a href="!--swig%EF%BF%BC38--">Install &amp; Configuration - Nginx, Node JS, Jupyter</a></li>
<li>openSUSE: Build MongoDB 3.4.x</li>
</ol>
<h2 id="Install-64bit-openSUSE-Leap-42-2-x2F-JeOS"><a href="#Install-64bit-openSUSE-Leap-42-2-x2F-JeOS" class="headerlink" title="Install 64bit openSUSE Leap 42.2 &#x2F; JeOS"></a>Install 64bit openSUSE Leap 42.2 &#x2F; JeOS</h2><p>openSUSE는 <strong>Raspberry Pi 3</strong>를 위한 Opensuse community edition은 정식 버전 <strong>Leap 42.2 image</strong>, 개발버전 <em>Tumbleweed image</em>, 커뮤니티버전 non-upstream openSUSE Tumbleweed image* 으로 구성되어 있다.</p>
<p>이들 버전은 용도에 따라 JeOS, E20, LXQT X11 이미지로 다운받을 수 있다.</p>
<ul>
<li><p>Just Enought Operating System (JeOS)</p>
<ul>
<li>jeOS 이미지는 기본 오에스만을 포함하고 있다.</li>
<li><a target="_blank" rel="noopener" href="https://www.suse.com/products/server/jeos/">https://www.suse.com/products/server/jeos/</a></li>
</ul>
</li>
<li><p>E20</p>
<ul>
<li>데스크탑 환경으로 Enlightenment 을 사용하 GUI 이미지</li>
</ul>
</li>
<li><p>LXQt</p>
<ul>
<li>LXDE-Qt 와 RazorQt 병합한 데스크탑 환경</li>
<li><a target="_blank" rel="noopener" href="https://en.opensuse.org/LXQt">https://en.opensuse.org/LXQt</a></li>
</ul>
</li>
</ul>
<br>
### Download and Install

<p><a target="_blank" rel="noopener" href="https://en.opensuse.org/HCL:Raspberry_Pi3">Download Page</a> 의 두번째 <em>Installing the 64-bit openSUSE Leap image</em> 단락에 있는 JeOS image 를 다운로드 한다.</p>
<h4 id="Writing-image-to-SD-Card"><a href="#Writing-image-to-SD-Card" class="headerlink" title="Writing image to SD Card"></a>Writing image to SD Card</h4><p><a target="_blank" rel="noopener" href="http://etcher.io/">Etcher</a> 등을 이용해서 다운받은 이미지 파일을 SD Card에 쓴다.</p>
<p><img src="/images/opensuse/etcher-image-writing.png">{:width&#x3D;”640”}</p>
<h5 id="dd-를-사용한다면"><a href="#dd-를-사용한다면" class="headerlink" title="dd 를 사용한다면,"></a><code>dd</code> 를 사용한다면,</h5><p>다운받은 <code>.xz</code> 파일을 <code>dd</code> 를 이용해서 SD Card에 쓴다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xzcat openSUSE-Leap42.2-ARM-JeOS-raspberrypi3.aarch64.raw.xz | sudo dd of=/dev/rdisk1 bs=4m; sync</span><br></pre></td></tr></table></figure>

<br>
#### Serial console

<p>여기서는 <strong>Serial console</strong>에서 네트워크 확인 및 초기 설정을 하고 <strong>ssh</strong> 로 서버에 로그인해서 시스템 구성을 진행한다.</p>
<blockquote>
<p>SD Card를 라즈베리파이에 꽃고 HDMI, Keyboard 및 Mouse 가 별도로 준비되어 있으면 직접 모니터를 보고 작업을 진행하면 좋다.</p>
</blockquote>
<p>USB to Serial 케이블을 사용해서 Raspberry Pi의 Serial Console에 연결한다.</p>
<p><img src="/images/raspberrypi/rpi-usb-serial.png">{:width&#x3D;”640”}</p>
<p>그리고 시리얼 포트를 통해 tty 연결을 위해 터미널 프로그램에서 baud rate 115200 으로 연결한다. 아래는 macOS의 <code>screen</code> CLI 명령으로 usb serial 포트에 연결하고 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ screen /dev/cu.usbserial 115200</span><br></pre></td></tr></table></figure>

<p>이제 SD Card를 넣고 부팅을 하면, 터미널에 부트 단계가 진행되고 처음 5분 정도 소요된다.</p>
<p><img src="/images/opensuse/opensuse-boot33.png">{:width&#x3D;”640”}</p>
<p>Raspberry Pi를 위한 이미지는 처음 계정은 <code>root/linux</code> 이다.</p>
<p>터미널에서 uname 은 <strong>aarch64</strong> 임을 확인 할 수 있다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root<span class="comment"># uname -a</span></span><br><span class="line">Linux homepi 4.4.90-18.32-default <span class="comment">#1 SMP Fri Oct 6 13:30:08 UTC 2017 (465b410) aarch64 aarch64 aarch64 GNU/Linux</span></span><br></pre></td></tr></table></figure>

<p>처음으로 라즈베리파이에서 64bit 환경으로 운영해 볼 수 있게 됐다.</p>
<br>
<br>
### 설치 후 서버 구성을 위해 할 일

<p>JeOS를 서버로 구성하기 위해서 다음 같은 작업을 수행해 준다.</p>
<ul>
<li>root 패스워드 변경</li>
<li>sudoer 사용자 생성</li>
<li>DHCP를 고정 IP로 변경</li>
</ul>
<h4 id="root-패스워드"><a href="#root-패스워드" class="headerlink" title="root 패스워드"></a>root 패스워드</h4><p>root 사용자의 패스워드를 변경한다.</p>
<p><img src="/images/opensuse/opensuse-root-passwd.png">{:width&#x3D;”640”}</p>
<h4 id="Update"><a href="#Update" class="headerlink" title="Update"></a>Update</h4><p>Ubuntu&#x2F;Debian 계열의 패키지 명령 <code>apt</code>,<code>apt-get</code> 과 비슷한 openSUSE 명령라인 패키지 관리자는 <strong>zypper</strong> 가 있다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">zypper <span class="built_in">help</span> search     <span class="comment"># to print help for the search command</span></span><br><span class="line">zypper refresh, ref    <span class="comment"># Refresh all repositories.</span></span><br><span class="line">zypper update,  up     <span class="comment"># to update all installed packages</span></span><br><span class="line">zypper lp              <span class="comment"># to see what patch updates are needed</span></span><br><span class="line">zypper patch           <span class="comment"># to apply the needed patches</span></span><br><span class="line">zypper se sqlite       <span class="comment"># to search for sqlite</span></span><br><span class="line">zypper <span class="built_in">rm</span> sqlite2      <span class="comment"># to remove sqlite2</span></span><br><span class="line">zypper <span class="keyword">in</span> sqlite3      <span class="comment"># to install sqlite3</span></span><br><span class="line">zypper <span class="keyword">in</span> yast*        <span class="comment"># to install all packages matching &#x27;yast*&#x27;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><a target="_blank" rel="noopener" href="https://en.opensuse.org/SDB:Zypper_usage">zypper usages</a> 에서 사용방법을 자세히 알 수 있다.</li>
</ul>
<p>머저 최신 소프트웨어 목록으로 업데이트 한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">zypper refresh</span><br><span class="line">zypper ref</span><br></pre></td></tr></table></figure>

<p>그리고 최근 업그레이드된 필요한 패키지를 다운로드하고 설치한다.[^1]</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">zypper update</span><br><span class="line">zypper up</span><br></pre></td></tr></table></figure>

<blockquote>
<p>지원중단된 패키지, 나뉘어진 패키지 등의 의존성을 고려한 업그레이드를 하려면 <code>dup</code> 명령을 사용한다.&gt;</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">zypper dup             <span class="comment"># distribution upgrade</span></span><br><span class="line">zypper dist-upgrade</span><br></pre></td></tr></table></figure>
</blockquote>
<h5 id="upgrade-후에"><a href="#upgrade-후에" class="headerlink" title="upgrade 후에"></a>upgrade 후에</h5><p>실행중인 데몬을 재시작해줄 필요가 있는데 <code>zypper ps -s</code> 를 실행하면 목록을 표시해 준다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">pi64:/home/ # zypper ps -s</span><br><span class="line">The following running processes use deleted files:</span><br><span class="line"></span><br><span class="line">PID   | PPID  | UID  | User       | Command                    | Service</span><br><span class="line">------+-------+------+------------+----------------------------+-------------------</span><br><span class="line">307   | 1     | 0    | root       | systemd-journald (deleted) | systemd-journald</span><br><span class="line">484   | 1     | 0    | root       | auditd                     | auditd</span><br><span class="line">502   | 1     | 1000 | qkboo      | python3                    | jupyter</span><br><span class="line">513   | 1     | 499  | messagebus | dbus-daemon (deleted)      | dbus</span><br><span class="line">525   | 1     | 0    | root       | systemd-logind (deleted)   | systemd-logind</span><br><span class="line">529   | 1     | 0    | root       | agetty (deleted)           | getty@tty1</span><br><span class="line">996   | 1     | 0    | root       | cupsd                      | cups</span><br><span class="line">1018  | 1     | 0    | root       | cron                       | cron</span><br><span class="line">1043  | 1     | 74   | ntp        | ntpd                       | ntpd</span><br><span class="line">1047  | 1043  | 74   | ntp        | ntpd                       | ntpd</span><br><span class="line">1145  | 1     | 0    | root       | python2.7                  | fail2ban</span><br><span class="line">1146  | 1     | 1000 | qkboo      | node                       | pm2-qkboo</span><br><span class="line">2131  | 1     | 0    | root       | agetty (deleted)           | serial-getty@ttyS0</span><br><span class="line">5716  | 1146  | 1000 | qkboo      | node                       | pm2-qkboo</span><br><span class="line">5749  | 1146  | 1000 | qkboo      | node                       | pm2-qkboo</span><br><span class="line">12400 | 1     | 0    | root       | sshd (deleted)             |</span><br><span class="line">12402 | 1     | 1000 | qkboo      | systemd (deleted)          |</span><br><span class="line">12405 | 0     | 1000 | qkboo      | systemd (deleted)          |</span><br><span class="line">12411 | 12400 | 1000 | qkboo      | sshd (deleted)             |</span><br><span class="line">12412 | 12411 | 1000 | qkboo      | bash                       |</span><br><span class="line">12783 | 12412 | 0    | root       | sudo                       |</span><br><span class="line">12784 | 12783 | 0    | root       | bash                       |</span><br><span class="line">12876 | 1     | 0    | root       | nginx                      | nginx</span><br><span class="line">12879 | 12876 | 494  | nginx      | nginx                      | nginx</span><br><span class="line">12880 | 12876 | 494  | nginx      | nginx                      | nginx</span><br><span class="line">12881 | 12876 | 494  | nginx      | nginx                      | nginx</span><br><span class="line">12882 | 12876 | 494  | nginx      | nginx                      | nginx</span><br><span class="line">15908 | 502   | 1000 | qkboo      | node                       | jupyter</span><br><span class="line">15916 | 15908 | 1000 | qkboo      | node                       | jupyter</span><br><span class="line">26929 | 502   | 1000 | qkboo      | node                       | jupyter</span><br></pre></td></tr></table></figure>

<h4 id="ip-주소-확인"><a href="#ip-주소-확인" class="headerlink" title="ip 주소 확인"></a>ip 주소 확인</h4><p>ifconfig 명령으로 현재 IP Address를 확인하고 이 IP Address에 <code>ssh</code> 를 사용해 접속한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">linux:~ <span class="comment"># ifconfig</span></span><br><span class="line">eth0      Link encap:Ethernet  HWaddr B9:40:EB:BA:10:02</span><br><span class="line">          inet addr:192.168.1.104  Bcast:192.168.1.255  Mask:255.255.255.0</span><br><span class="line">          inet6 addr: fe90::ba37:ebff:feba:1012/64 Scope:Link</span><br><span class="line">          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1</span><br><span class="line">          RX packets:83136 errors:0 dropped:0 overruns:0 frame:0</span><br><span class="line">          TX packets:27300 errors:0 dropped:0 overruns:0 carrier:0</span><br><span class="line">          collisions:0 txqueuelen:1000</span><br><span class="line">          RX bytes:120797947 (115.2 Mb)  TX bytes:2369690 (2.2 Mb)</span><br><span class="line">linux:~ <span class="comment">#</span></span><br><span class="line">linux:~ <span class="comment"># shutdown now</span></span><br></pre></td></tr></table></figure>

<p>좀더 편리한 사용을 위해 <code>ifconfig</code> 명령으로 찾은 IP address에 ssh 로그인을 해서 작업을 진행한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh root@192.168.1.104</span><br></pre></td></tr></table></figure>

<br>
<br>
### 시스템 설정

<p>이제 sudoer 사용자로 시스템을 서버에 적합하게 구성해 보자.</p>
<ul>
<li>sudoer 추가</li>
<li>yast 소개</li>
<li>timezone</li>
<li>Network 구성: 호스트 이름, IP 주소</li>
<li>swap 개선</li>
<li>yast로 사용자 추가</li>
</ul>
<h4 id="sudoer"><a href="#sudoer" class="headerlink" title="sudoer"></a>sudoer</h4><p><strong>root</strong> 사용자가 아닌 일반사용자를 <code>sudoer</code>로 등록해 관리자 기능을 대행 할 수 있다. 그러기 위해서 먼저 사용자를 추가한다. openSUSE <code>yast</code>라는 시스템 도구로 할 수 있지만 여기선 <code>useradd</code> 명령을 사용해서 사용자 추가한다. <code>useradd</code>에 대해서는 <a target="_blank" rel="noopener" href="http://www.tecmint.com/add-users-in-linux/">useradd 명령</a>을 참조한다.</p>
<p><code>useradd</code> 는 홈 디렉토리, 쉘 등에 대한 옵션을 주고 사용자를 등록한다.</p>
<ul>
<li>추가한 사용자를 &#x2F;etc&#x2F;passwd, &#x2F;etc&#x2F;shadow, &#x2F;etc&#x2F;group and &#x2F;etc&#x2F;gshadow 추가</li>
<li>그리고 <code>-m</code> 옵션으로 으로 사용자 홈 디렉토리 까지 생성한다.</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root<span class="comment">#  useradd -m foo</span></span><br></pre></td></tr></table></figure>

<p>그리고 패스워드를 등록한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root<span class="comment"># passwd foo</span></span><br><span class="line">New password:</span><br><span class="line">Retype new password:</span><br><span class="line">passwd: password updated successfully</span><br></pre></td></tr></table></figure>

<h4 id="sudoer-등록"><a href="#sudoer-등록" class="headerlink" title="sudoer 등록"></a>sudoer 등록</h4><p><code>visudo</code> 명령으로 <em>&#x2F;etc&#x2F;sudoers</em> 파일을 편집한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo visudo</span><br></pre></td></tr></table></figure>

<p><em>sudoer</em> 파일에 있는 <em>User privilege</em> 항목 아래에 새로운 사용자 foo를 아래 같이 등록한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># User privilege specification</span><br><span class="line">root  ALL=(ALL) ALL</span><br><span class="line">foo  ALL=(ALL) ALL</span><br></pre></td></tr></table></figure>

<p>이제 root에서 로그아웃하고 새로 추가한 사용자로 로그인한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ ssh foo@192.168.1.104</span><br><span class="line">Password:</span><br><span class="line">Have a lot of fun...</span><br><span class="line">foo@linux:~&gt;</span><br></pre></td></tr></table></figure>

<p>openSUSE는 관리자용 명령을 직접 내리면 찾지 못한다고 한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">foo@linux:~&gt; yast2 timezone</span><br><span class="line">-bash: yast2: <span class="built_in">command</span> not found</span><br></pre></td></tr></table></figure>

<p>그리고 처음으로 sudoer 사용자가 관리자 권한이 필요한 명령을 사용하기 위해 <code>sudu</code> 로 명령을 내리면 아래 같은 경고가 나온다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">foo@linux:~&gt; sudo /sbin/yast2 timezone</span><br><span class="line"></span><br><span class="line">We trust you have received the usual lecture from the <span class="built_in">local</span> System</span><br><span class="line">Administrator. It usually boils down to these three things:</span><br><span class="line"></span><br><span class="line">    <span class="comment">#1) Respect the privacy of others.</span></span><br><span class="line">    <span class="comment">#2) Think before you type.</span></span><br><span class="line">    <span class="comment">#3) With great power comes great responsibility.</span></span><br></pre></td></tr></table></figure>

<p>openSUSE는 시스템 관리 도구로 <code>yast</code> 를 사용해서 소프트웨어 설치, 네트워크 구성, 시간 관리, 보안 및 사용자 등을 다루는 소프트웨어로 GUI와 CLI 모두 사용할 수 있다.</p>
<p>시스템 네트워크를 구성하기 위해서 <code>yast</code> 명령을 사용해보자,</p>
<h4 id="yast"><a href="#yast" class="headerlink" title="yast"></a>yast</h4><p>yast는 GUI 혹은 ClI에서 사용이 가능하다 . 다음은 <code>sudo yast</code> 를 실행하면 Ncurse 로 표시되는 yast 화면이다.</p>
<p><img src="/images/opensuse/yast-cli-ui.png">{:width&#x3D;”640”}</p>
<p>TAB 키로 각 항목을 이동할 수 있고, Enter로 실행한다. 전체 화면에서 F9는 Cancel, F10은 OK 기능을 수행한다.</p>
<h4 id="Timezone"><a href="#Timezone" class="headerlink" title="Timezone"></a>Timezone</h4><p>처음 설치후 <em>CET</em> 시간대로 되어 있어서 Asia&#x2F;Seoul로 변경하고자 한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">linux:~ <span class="comment"># date</span></span><br><span class="line">Sun Oct 29 09:19:31 CET 2017</span><br></pre></td></tr></table></figure>

<p>시스템 시간대를 설정하려면 <code>yast</code> 를 시작해 <em>System -&gt; Date and Time</em> 을 실행해 시간대를 지정한다. 혹은 <code>yast timezone</code> 모듈 명령을 주면 해당 Date and Time 화면으로 이동할 수 있다.</p>
<p><img src="/images/opensuse/yast-date_time.png">{:width&#x3D;”640”}</p>
<p>시간대를 변경후 확인해 보면,</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">linux:~ # date</span><br><span class="line">Sun Oct 29 17:22:11 KST 2017</span><br></pre></td></tr></table></figure>

<p>ntp로 동기화하려면 <em>Other Settings…</em> 항목을 선택해 <em>ntp server</em> 를 설치하고 활성화 한다.</p>
<p><img src="/images/opensuse/yast-date_time-ntp1.png">{:width&#x3D;”640”}<br><img src="/images/opensuse/yast-date_time-ntp2.png">{:width&#x3D;”640”}</p>
<!--
참고로 ClI로 `yast` 명령을 사용할 수 있다. 예를 들어 timezone 사용 가능한 시간대는

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yast2 timezone list</span><br></pre></td></tr></table></figure>

<p>해당 하는 시간대 문자열을 이용해 시간대를 지정한다.</p>
<blockquote>
<p>sudo yast2 timezone set timezone&#x3D;[TIMEZONE]</p>
</blockquote>
<p>우리나라 시간대 ‘Asia&#x2F;Seoul (Seoul)’는 이렇게 지정할 수 있다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~&gt; sudo yast2 timezone <span class="built_in">set</span> timezone=<span class="string">&#x27;Asia/Seoul (Seoul)&#x27;</span></span><br></pre></td></tr></table></figure>
<p>–&gt;</p>
<h4 id="yast로-네트워크-설정하기"><a href="#yast로-네트워크-설정하기" class="headerlink" title="yast로 네트워크 설정하기"></a>yast로 네트워크 설정하기</h4><p>시스템 네트워크 구성을 설정하려면 <code>yast</code> 에서 <em>System -&gt; Network Settings</em> 을 실행한다.</p>
<p><img src="/images/opensuse/yast-network1.png">{:width&#x3D;”640”}</p>
<p>네트워크 구성 상태를 가져오는 시간이 걸린다.</p>
<p><img src="/images/opensuse/yast-network2.png">{:width&#x3D;”640”}</p>
<p>네트워크 구성을 시작한다. TAB으로 <code>Edit</code> 를 선택하고,</p>
<p><img src="/images/opensuse/yast-network-settings.png">{:width&#x3D;”640”}</p>
<p><em>Statically Assigned IP Address</em>를 선택하고, 아래 IP Address, Subnet Mask, Hostname 을 입력한다.</p>
<p><img src="/images/opensuse/yast-network-ip-address.png">{:width&#x3D;”640”}</p>
<p>TAB으로 이동해 <strong>Next</strong> 버튼을 누른다. 그리고 TAB으로 <strong>Hostname&#x2F;DNS</strong> 탭 으로 이동해서 Name Server를 입력한다. 보통 DHCP를 지원하는 공유기&#x2F;라우터에서 DNS server 역할을 하므로 게이트웨이 IP를 입력해도 무방하다.</p>
<p><img src="/images/opensuse/yast-network-host.png">{:width&#x3D;”640”}</p>
<p>마지막으로 <strong>Routing</strong> 탭을 이동해 Gateway를 입력해 준다.</p>
<p><img src="/images/opensuse/yast-network-gw.png">{:width&#x3D;”640”}</p>
<p>완료됐으면 <em>F10</em> 혹은 TAB으로 <strong>OK 버튼</strong>으로 이동해 설정한 내용을 저장한다. 이로서 수동 IP 주소 입력을 마친다.</p>
<p><code>yast</code> ClI 명령으로 Host 이름을 변경할 수 있다.</p>
<blockquote>
<p>yast dns edit hostname&#x3D;HOSTNAME</p>
</blockquote>
<p>또한 <code>yast</code> ClI 명령으로 소프트웨어 패키지를 설치 할 수 있다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo yast -i &lt;package_name&gt;</span><br><span class="line">sudo yast --install &lt;package_name&gt;</span><br></pre></td></tr></table></figure>

<h4 id="swap-개선"><a href="#swap-개선" class="headerlink" title="swap 개선"></a>swap 개선</h4><p>JeOS는 별도의 파티션에 swap을 가지고 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~&gt; sudo swapon -s</span><br><span class="line">Filename        Type    Size  Used  Priority</span><br><span class="line">/dev/mmcblk0p3                          partition 497384  1816  -1</span><br></pre></td></tr></table></figure>

<p>별도의 swap 을 1GB 크기 Swap file로 추가하려면</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ sudo dd if=/dev/zero of=/var/swapfile1G bs=1G count=1</span><br><span class="line">$ sudo chmod 600 /var/swapfile1G</span><br><span class="line">$ sudo mkswap /var/swapfile1G</span><br><span class="line">Setting up swapspace version 1, size = 1024 MiB (1073737728 bytes)</span><br><span class="line">no label, UUID=3b192470-5297-42ef-a033-b19b0de03590</span><br><span class="line"></span><br><span class="line">$ sudo swapon /var/swapfile1G</span><br><span class="line">$ sudo swapon -s</span><br></pre></td></tr></table></figure>

<p><code>mkswap</code> 명령 결과에 있는 <em>UUID&#x3D;…</em> 부분을 복사해 &#x2F;etc&#x2F;fstab 에 종속적으로 등록해 주면 재시동 후에도 사용 가능하다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UUID=3b192470-5297-42ef-a033-b19b0de03590 swap swap defaults 0 0</span><br></pre></td></tr></table></figure>

<h4 id="yast-사용자-추가"><a href="#yast-사용자-추가" class="headerlink" title="yast 사용자 추가"></a>yast 사용자 추가</h4><p>앞에서 <code>adduser</code> 명령으로 사용자를 추가했는데 openSUSE에서는 <code>yast</code>에서 사용할 수 있다. <code>yast</code> 를 시작해서 사용자 관리로 가거나, 아래 같이 바로 사용자 관리 화면으로 시작할 수 있다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yast2 <span class="built_in">users</span></span><br></pre></td></tr></table></figure>

<p>yast 화면에서 사용자 관리 화면,</p>
<p><img src="/images/opensuse/yast-user.png">{:width&#x3D;”650”}</p>
<p>다음 서버로 운영을 위해서 openSUSE에서 sshd 보안 강화, 방화벽, 필터링 등의 기본적인 보안 작업을 진행한다. <em>다음 openSUSE: Basic Security for Server</em></p>
<h4 id="Memory"><a href="#Memory" class="headerlink" title="Memory"></a>Memory</h4><p>rpi3 가 1GB 메인메모리로 출시, raspbian 실제 메모리 정보는,</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ cat /proc/meminfo</span><br><span class="line">MemTotal:         949572 kB</span><br><span class="line">MemFree:          386192 kB</span><br><span class="line">MemAvailable:     711148 kB</span><br></pre></td></tr></table></figure>

<p>rpi3에 openSUSE LEAP 42.2에서</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; cat /proc/meminfo</span><br><span class="line">MemTotal:         803988 kB</span><br><span class="line">MemFree:          661276 kB</span><br><span class="line">MemAvailable:     684504 kB</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://raspberrypi.stackexchange.com/questions/56266/raspberry-pi-3-has-less-than-1gb-memory-available-at-os-level">여기</a> 에 따르면 GPU 때문 인듯…</p>
<h3 id="tune2fs"><a href="#tune2fs" class="headerlink" title="tune2fs"></a>tune2fs</h3><p>fsck로 마지막 체크한 시간 확인은 <code>tune2fs</code> 명령을 이용</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$sudo tune2fs -l /dev/sdbX | grep Last\ c</span><br><span class="line">Last checked:             Sun Dec 13 09:14:22 2015</span><br></pre></td></tr></table></figure>

<h4 id="e2fsck-점검"><a href="#e2fsck-점검" class="headerlink" title="e2fsck 점검"></a>e2fsck 점검</h4><p>부팅시 e2fsck로 점검할 마운트 횟수가 설정되 있다. <code>-l</code> 옵션으로 확인한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tune2fs -l /dev/sdbX | grep Mount</span><br><span class="line">Mount count:              157</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tune2fs -l /dev/sdbX | grep Max</span><br><span class="line">Maximum mount count:      -1</span><br></pre></td></tr></table></figure>

<p>이 마운트 회수를 지정할 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tune2fs -c 10 /dev/sdb1</span><br></pre></td></tr></table></figure>

<h3 id="Upgrade-amp-Patch"><a href="#Upgrade-amp-Patch" class="headerlink" title="Upgrade &amp; Patch"></a>Upgrade &amp; Patch</h3><h4 id="보안-패치"><a href="#보안-패치" class="headerlink" title="보안 패치"></a>보안 패치</h4><p>openSUSE는 upgrade와 patch 를 분리해서 제공한다. 패치는 보안 사항에 관련한 것을 제공하고 있다. <code>lp</code> 로 다운로드 가능한 패치를 확인할 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># zypper lp</span><br><span class="line">Retrieving repository &#x27;openSUSE-Leap-42.3-Update&#x27; metadata ..................[done]</span><br><span class="line">Building repository &#x27;openSUSE-Leap-42.3-Update&#x27; cache .......................[done]</span><br><span class="line">Loading repository data...</span><br><span class="line">Reading installed packages...</span><br><span class="line"></span><br><span class="line">Repository                | Name               | Category    | Severity  | Interactive | Status | Summary</span><br><span class="line">--------------------------+--------------------+-------------+-----------+-------------+--------+-----------------------------------------------------------------------</span><br><span class="line">openSUSE-Leap-42.3-Update | openSUSE-2017-1268 | security    | important | ---         | needed | Security update for webkit2gtk3</span><br><span class="line">openSUSE-Leap-42.3-Update | openSUSE-2017-1425 | recommended | low       | ---         | needed | Recommended update for grub2</span><br><span class="line">openSUSE-Leap-42.3-Update | openSUSE-2017-940  | security    | important | ---         | needed | Security update for subversion</span><br><span class="line">openSUSE-Leap-42.3-Update | openSUSE-2018-118  | security    | important | ---         | needed | Security update for webkit2gtk3</span><br><span class="line">openSUSE-Leap-42.3-Update | openSUSE-2018-234  | recommended | low       | ---         | needed | Recommended update for grub2</span><br><span class="line">openSUSE-Leap-42.3-Update | openSUSE-2018-241  | recommended | moderate  | ---         | needed | Recommended update for yast2, yast2-nfs-client, yast2-services-manager</span><br><span class="line">openSUSE-Leap-42.3-Update | openSUSE-2018-586  | recommended | low       | ---         | needed | Recommended update for grub2</span><br><span class="line"></span><br><span class="line">Found 7 applicable patches:</span><br><span class="line">7 patches needed (3 security patches)</span><br></pre></td></tr></table></figure>

<p>패치는 보안 이슈에 대한 것으로 해당 보안 이슈 정보 혹은 분류 등을 확인할 수 있다. 목록에서 Name 컬럼이 발생한 보안 사항 번호로 이 번호로 조회할 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zypper info openSUSE-2017-462</span><br></pre></td></tr></table></figure>

<p>패키지 내용은 CVE(Common Vulnerabilities and Exposures)로 보고된 보안 사항을 적용한 내용을 자세히 보여주고 있다.</p>
<p>패치 중에서 Category로 검색할 수 있다. 다음 같이 security 분류만 검색할 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">zypper lp --category security</span><br><span class="line">Loading repository data...</span><br><span class="line">Reading installed packages...</span><br><span class="line"></span><br><span class="line">Repository                | Name               | Category | Severity  | Interactive | Status | Summary</span><br><span class="line">--------------------------+--------------------+----------+-----------+-------------+--------+--------------------------------</span><br><span class="line">openSUSE-Leap-42.3-Update | openSUSE-2017-1268 | security | important | ---         | needed | Security update for webkit2gtk3</span><br><span class="line">openSUSE-Leap-42.3-Update | openSUSE-2017-940  | security | important | ---         | needed | Security update for subversion</span><br><span class="line">openSUSE-Leap-42.3-Update | openSUSE-2018-118  | security | important | ---         | needed | Security update for webkit2gtk3</span><br><span class="line"></span><br><span class="line">Considering 3 out of 7 applicable patches:</span><br><span class="line">3 patches needed (3 security patches)</span><br></pre></td></tr></table></figure>

<p>패치를 전체를 설치하려면</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo zypper patch</span><br></pre></td></tr></table></figure>

<p>혹은 패치 중에서 특정 패치만 설치할 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo zypper install patch:openSUSE-2017-1268</span><br></pre></td></tr></table></figure>

<p>업그레이드나 패치 중에 현재 사용중인 패키지 버전과 충돌시 문제 보고를 출력하는데 제시된 솔루션을 선택하면 된다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ sudo zypper patch</span><br><span class="line">Problem: nothing provides subversion = 1.9.7 needed by subversion-bash-completion-1.9.7-8.1.noarch</span><br><span class="line"> Solution 1: deinstallation of subversion-bash-completion-1.9.5-1.1.noarch</span><br><span class="line"> Solution 2: do not install patch:openSUSE-2017-940-1.noarch</span><br><span class="line"> Solution 3: break subversion-bash-completion-1.9.7-8.1.noarch by ignoring some of its dependencies</span><br><span class="line"></span><br><span class="line">Choose from above solutions by number or skip, retry or cancel [1/2/3/s/r/c] (c): 1</span><br></pre></td></tr></table></figure>

<br>

<h2 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h2><ul>
<li><a target="_blank" rel="noopener" href="https://en.opensuse.org/HCL:Raspberry_Pi3#Installing_the_64-bit_openSUSE_Leap_image">Raspberry Pi 3: Installing 64bit openSuse Leap Image</a></li>
<li><a target="_blank" rel="noopener" href="https://en.opensuse.org/SDB:System_upgrade">OpenSUSE System Upgrade</a></li>
<li><a target="_blank" rel="noopener" href="https://lukerawlins.com/opensuse-patch-vs-update/">openSUSE Update &amp; Patch</a></li>
</ul>
<p>[^1]: <a target="_blank" rel="noopener" href="https://en.opensuse.org/SDB:System_upgrade">System Upgrade</a><br>[^2]: <a target="_blank" rel="noopener" href="https://software.opensuse.org/package/net-tools-deprecated">net-tools deprecated</a><br>[^4]: <a target="_blank" rel="noopener" href="http://www.susegeek.com/networking/how-to-setup-persistent-static-routes-in-opensuse-110/">Static route in Opensuse</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2016-12-20T00:00:00.000Z" title="2016-12-20 9:00:00">2016-12-20</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2022-02-24T16:16:51.961Z" title="2022-2-25 1:16:51">2022-02-25</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Raspberry-Pi/">Raspberry Pi</a><span> / </span><a class="link-muted" href="/categories/Raspberry-Pi/Linux/">Linux</a></span><span class="level-item">17분안에 읽기 (약 2558 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2016/12/20/raspberrypi/2016-12-20-sdcard-usage/">SD Card 포맷 및 디스크 이미지 사용하기</a></h1><div class="content"><p>SBC, PC 등의 머신에서 SD Card 사용에 필요한 사항을 정리했다.</p>
<blockquote>
<p>2018-08-30: 전체 내용 편집<br>2017-10-30: swap 추가, timezone 수정<br>{:.right-history}</p>
</blockquote>
<br>
## SD Card 와 디스크 이미지 사용하기

<p>SD Card는 Secure Digital의 약자로 Flash memory(비휘발성) 카드 포맷이다.</p>
<p>자세한 내용은 <a target="_blank" rel="noopener" href="https://ko.wikipedia.org/wiki/SD_%EC%B9%B4%EB%93%9C">Wikipedia: SD Card</a> 를 확인하자.</p>
<h3 id="SD-Card-format"><a href="#SD-Card-format" class="headerlink" title="SD Card format"></a>SD Card format</h3><ol>
<li>Windows</li>
</ol>
<ul>
<li>Disk Utility를 이용한다.</li>
<li>SD Association의 SD Formatter 를 이용한다.</li>
</ul>
<ol start="2">
<li>macOS</li>
</ol>
<ul>
<li>Diskutility 앱을 이용한다.</li>
<li>SD Association의 SD Formatter 를 이용한다.</li>
</ul>
<ol start="3">
<li>Linux</li>
</ol>
<ul>
<li><code>fdisk</code>, <code>parted</code> 명령으로 포맷할 수 있다.</li>
<li><code>dd</code> 명령으로</li>
</ul>
<h4 id="macOS"><a href="#macOS" class="headerlink" title="macOS"></a>macOS</h4><p>macOS는 Disk Utility 프로그램을 명령줄에서 <a target="_blank" rel="noopener" href="https://ss64.com/osx/diskutil.html">diskutil</a> 명령으로 디스크에 대한 파티션, 포맷 및 점검을 할 수 있다. GUI 윈도우를 제공하지만 명령줄에서 <code>diskutil</code> 명령으로 파티션, 마운트 및 포맷을 할 수 있다.</p>
<p>명령줄에서 <code>diskutil</code> 명령으로 목록과 파티션 마운트를 해제하고 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ diskutil list</span><br><span class="line"></span><br><span class="line">$ diskutil unmountDisk /dev/diskX</span><br></pre></td></tr></table></figure>

<p>역시 <code>dd</code> 명령을 이용해 <code>/dev/zero</code>, <code>/dev/urandom</code> 을 디스크 전체에 써서 지울 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo dd if=/dev/urandom of=/dev/diskX bs=1000000</span><br></pre></td></tr></table></figure>

<p>디스크 파티션은 <code>partitionDisk</code> 를 사용해서 파티션할 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo diskutil partitionDisk &lt;Disk&gt; GPT| FAT|exFAT|JHFS+ NAME SIZE</span><br></pre></td></tr></table></figure>

<ul>
<li>SIZE: 0b 전체.</li>
</ul>
<h4 id="zeros"><a href="#zeros" class="headerlink" title="zeros"></a>zeros</h4><p>$ diskutil reformat &#x2F;dev&#x2F;rdisk3</p>
<h4 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h4><p>Ubuntu 등은 SD Card 슬롯에 삽입된 장치는 &#x2F;dev&#x2F;mmcblkX 같이 장치 이름을 붙인다. USB Stick 으로 SD Card 혹은 Micro SD Card를 사용하면 &#x2F;dev&#x2F;sdX 디스크 이름을 사용한다.</p>
<p><code>lsblk</code> 명령은 디바이스 장치가 마운트 된 곳을 출력해 준다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ lsblk</span><br><span class="line">NAME        MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT</span><br><span class="line">sda           8:0    0 119.2G  0 disk</span><br><span class="line">├─sda1        8:1    0  84.5G  0 part</span><br><span class="line">└─sda6        8:6    0  28.9G  0 part /</span><br><span class="line">mmcblk0     179:0    0   7.5G  0 disk</span><br><span class="line">├─mmcblk0p2 179:2    0   6.8G  0 part /media/qkboo/ROOT</span><br><span class="line">├─mmcblk0p3 179:3    0 486.1M  0 part</span><br><span class="line">└─mmcblk0p1 179:1    0   200M  0 part /media/qkboo/EFI</span><br></pre></td></tr></table></figure>

<p>파티션 및 포맷을 위해 마운트된 파티션을 언마운트 한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo umount /dev/mmcblk0p2</span><br><span class="line">$ sudo umount /dev/mmcblk0p1</span><br></pre></td></tr></table></figure>

<p><code>parted</code> 유틸리티로 파티션을 삭제, 생성할 수 있다. 다음은 명령라인에서 옵션을 주어 사용하는 방법이다</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo parted /dev/mmcblk0 rm 1</span><br><span class="line">$ sudo parted /dev/mmcblk0 rm 2</span><br><span class="line">$ sudo parted /dev/sdc mkpart primary ext3 4MiB 100%</span><br></pre></td></tr></table></figure>

<p>결과로 <em>mmcblk0</em> 디스크 드라이브에 <strong>mmcblk0p1</strong> 파티션이 생성된다.</p>
<p>다음은 위와 같은 내용으로 fat32 파티션을 <code>parted</code> 를 Shell로 사용하는 예이다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo parted /dev/mmcblk0</span><br><span class="line">(parted) mklabel msdos</span><br><span class="line">(parted) mkpart primary fat32 1MiB 100%</span><br><span class="line">(parted) set 1 boot on</span><br><span class="line">(parted) quit</span><br></pre></td></tr></table></figure>

<p>마지막으로 파티션을 파일시스템으로 포맷해 준다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo mkfs -V -t vfat /dev/mmcblk0p1</span><br></pre></td></tr></table></figure>


<p>역시 <code>dd</code> 명령을 이용해 <code>/dev/zero</code>, <code>/dev/urandom</code> 을 디스크 전체에 써서 지울 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo dd if=/dev/zero of=/dev/diskX bs=4M</span><br></pre></td></tr></table></figure>



<h3 id="Disk-clone"><a href="#Disk-clone" class="headerlink" title="Disk clone"></a>Disk clone</h3><p>Linux, macOS 에서 파티션 도구, <code>dd</code> 를 사용해서 디스크 전체, 혹은 파티션을 이미지로 추출해 생성하는 과정을 정리했다.</p>
<h4 id="dd-이용하기"><a href="#dd-이용하기" class="headerlink" title="dd 이용하기"></a><code>dd</code> 이용하기</h4><p><code>dd</code> 로 디스크의 전체를 이미지 파일로 생성할 수 있다. 다만 디스크 전체 섹터를 추출하므로 디스크 용량과 같은 크기를 가진 이미지 파일이 생성된다. </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dd bs=4M if=/dev/sdX of=image.gz conv=fsync</span><br></pre></td></tr></table></figure>


<h4 id="Ubuntu-gparted"><a href="#Ubuntu-gparted" class="headerlink" title="Ubuntu gparted"></a>Ubuntu <code>gparted</code></h4><p>우분투 Live CD에서 <code>gparted</code>는 가능한 사용하지 않는 공간은 빼고 최소 크기로 줄여 줄 수 있다.</p>
<h4 id="압축-이용하기"><a href="#압축-이용하기" class="headerlink" title="압축 이용하기"></a>압축 이용하기</h4><p>전체 디스크 크기의 이미지 파일이 너무 크면,  압축유틸리티를 이용해 저장할 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dd bs=4M count=&lt;size_in_MBs&gt; if=/dev/sdX | gzip -c --fast| dd of=image.gz</span><br><span class="line">dd bs=4M count=&lt;size_in_MBs&gt; if=/dev/sdX | xz -c --fast| dd of=image.xz</span><br></pre></td></tr></table></figure>


<p>반대로 압축한 이미지 파일을 디스크로 복원하기 위해서 <code>unzip</code>, <code>gunzip</code>, <code>xz -d</code> 압축을 해제한 결과를 파이프로 <code>dd</code>로 전달한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dd if=/path/to/image.gz | gunzip -c | dd bs=1M of=/dev/sdY</span><br><span class="line">dd if=/path/to/image.xz | xzcat | dd bs=1M of=/dev/sdY</span><br></pre></td></tr></table></figure>


<h4 id="macOS의-Disk-Utility-이용"><a href="#macOS의-Disk-Utility-이용" class="headerlink" title="macOS의 Disk Utility 이용"></a>macOS의 Disk Utility 이용</h4><p>GUI인 Disk Utility에서 SD Card 디스크를 선택하고 macOS의 <em>.dmg</em> 이미지 파일로 저장할 수 있고, 저장시 압축 선택이 가능하다.</p>
<br>
### Disk Image를 SD Card에 쓰기

<p>각 OS에서 <code>dd</code> 같은 Disk clone 도구를 사용해서 디스크 이미지를 SD Card에 쓸 수 있다. </p>
<h4 id="Etcher"><a href="#Etcher" class="headerlink" title="Etcher"></a>Etcher</h4><p>모든 OS  플랫폼을 지원하는 <strong>Etcher</strong> 사용을 권장한다. <a target="_blank" rel="noopener" href="http://etcher.io/">Etcher</a> 을 다운받아 이미지 파일 선택해 대상 SD Card 에 GUI로 쓸 수 있다.</p>
<p><img src="/images/opensuse/etcher-image-writing.png">{:width&#x3D;”640”}</p>
<p><code>dd</code>를 사용한다면 이러지는 <strong>macOS</strong>, <strong>Linux</strong> 섹션을 참조한다.</p>
<h4 id="dd로-이미지-쓰기"><a href="#dd로-이미지-쓰기" class="headerlink" title="dd로 이미지 쓰기"></a><code>dd</code>로 이미지 쓰기</h4><p>디스크 내용을 <code>dd</code> 명령으로 디스크 이미지 형태로 저장할 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo dd if=opensuse_jeos-20171030.img of=/dev/mmcblk0 bs=4m</span><br></pre></td></tr></table></figure>

<p>압축 이미지로 제공하는 이미지 파일은 <code>zcat</code>, <code>xzcat</code>, <code>gzcat</code> 같은 표출 출력 유틸리티를 사용해, dd 명령에 파이프로 처리할 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ xzcat openSUSE-Leap42.2-ARM-JeOS-raspberrypi3.aarch64.raw.xz | sudo dd of=/dev/rdisk1 bs=4m; sync</span><br></pre></td></tr></table></figure>


<p>이제 이미지 SD Card를 보드에 넣고 부팅한 후 시스템 설정을 시작하면 된다.</p>
<p>시스템 구성을 하고, 여러 설정을 한 후 백업, 복사 등을 위해, 설정한 OS 를 디스크 이미지로 복제하는 경우가 많아 이때는 <code>dd</code> 명령을 사용할 수 있다.</p>
<br>
### 이미지 파일 다루기

<p>백업한 디스크 이미지 파티션을 확인하고 폴더에 마운트해서 내용을 확인할 할 수 있다.</p>
<p>이미지 파일의 파티션 정보를 <code>fdisk</code>, <code>parted</code> 명령으로 확인할 수 있다.</p>
<h4 id="fdisk-이용"><a href="#fdisk-이용" class="headerlink" title="fdisk 이용"></a><code>fdisk</code> 이용</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ fdisk -lu opensuse-e20.img</span><br><span class="line">Disk opensuse-e20.img: 14.9 GiB, 16022241280 bytes, 31293440 sectors</span><br><span class="line">Units: sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disklabel <span class="built_in">type</span>: dos</span><br><span class="line">Disk identifier: 0xe0e3966b</span><br><span class="line"></span><br><span class="line">Device            Boot    Start      End  Sectors   Size Id Type</span><br><span class="line">opensuse-e20.img1          2048   411651   409604   200M  c W95 FAT32 (LBA)</span><br><span class="line">opensuse-e20.img2        413696 30282525 29868830  14.2G 83 Linux</span><br><span class="line">opensuse-e20.img3      30283776 31278554   994779 485.7M 82 Linux swap / Solaris</span><br></pre></td></tr></table></figure>

<h4 id="parted-이용"><a href="#parted-이용" class="headerlink" title="parted 이용"></a><code>parted</code> 이용</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ parted opensuse-42.3-homepi_16GB-firewalld.img</span><br><span class="line">GNU Parted 3.2</span><br><span class="line">Using opensuse-42.3-homepi_16GB-firewalld.img</span><br><span class="line">Welcome to GNU Parted! Type &#x27;help&#x27; to view a list of commands.</span><br><span class="line">(parted) p</span><br><span class="line">Model:  (file)</span><br><span class="line">Disk opensuse-42.3-homepi_16GB-firewalld.img: 16.0GB</span><br><span class="line">Sector size (logical/physical): 512B/512B</span><br><span class="line">Partition Table: msdos</span><br><span class="line">Disk Flags:</span><br><span class="line"></span><br><span class="line">Number  Start   End     Size    Type     File system     Flags</span><br><span class="line"> 1      1049kB  211MB   210MB   primary  fat16           lba</span><br><span class="line"> 2      212MB   15.5GB  15.3GB  primary  ext4</span><br><span class="line"> 3      15.5GB  16.0GB  509MB   primary  linux-swap(v1)</span><br></pre></td></tr></table></figure>

<p>Byte 단위로 보려면</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(parted) unit</span><br><span class="line">Unit?  [compact]? B</span><br><span class="line">(parted) p</span><br><span class="line">Number  Start         End           Size          Type     File system     Flags</span><br><span class="line"> 1      1048576B      210765823B    209717248B    primary  fat16           lba</span><br><span class="line"> 2      211812352B    15504653311B  15292840960B  primary  ext4</span><br><span class="line"> 3      15505293312B  16014620159B  509326848B    primary  linux-swap(v1)</span><br></pre></td></tr></table></figure>


<h4 id="이미지-마운트"><a href="#이미지-마운트" class="headerlink" title="이미지 마운트"></a>이미지 마운트</h4><p>디스크 이미지는 리눅스에서 <code>mount</code> 명령으로 마운트 할 수 있다. mount 명령으로 실제 파티션이 시작하는 위치를 offset으로 지정해서 마운트 한다.</p>
<p>앞서 사용한 opensuse-42.3-homepi_16GB.img 이미지의 파티션 정보가 다음 같다고 하자.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Number  Start         End           Size          Type     File system     Flags</span><br><span class="line"> 1      1048576B      210765823B    209717248B    primary  fat16           lba</span><br><span class="line"> 2      211812352B    15504653311B  15292840960B  primary  ext4</span><br><span class="line"> 3      15505293312B  16014620159B  509326848B    primary  linux-swap(v1)</span><br></pre></td></tr></table></figure>

<p>첫번째 파티션 시작 위치 <em>1048576B</em> 를 오프셋으로 삼아서 root 권한으로 <code>mount</code> 명령을 사용한다.</p>
<blockquote>
<p>섹터 정보를 Byte 단위로 변경하려면, 파티션 정보에서 1 sector 크기가 512 를 확인하고, 이미피 파일의 파티션 시작 섹터를 곱해서 offset 범위를 계산한다.</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Sector size * Start = (in the case) 512 * 8192 = 4194304 (Byte)</span><br></pre></td></tr></table></figure>

<p>이제 마운트 명령 <code>mount -o loop,ro,offset</code> 옵션을 주고, boot와 ROOT 파티션을 마운트 해보자,</p>
<p>Now we have the offsets and we can use those to mount the filesystems using the loopback device:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo mount -o loop,ro,offset=1048576 opensuse-42.3-homepi_16GB.img ~/mnt/boot/</span><br><span class="line">$ sudo mount -o loop,ro,offset=211812352 opensuse-42.3-homepi_16GB.img ~/mnt/ROOT/</span><br></pre></td></tr></table></figure>

<p>마운트가 성공하면 <code>df</code> 명령 혹은 <code>mount</code> 명령으로 마운트한 위치를 확인할 수 있다;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ df -h</span><br><span class="line">Filesystem      Size  Used Avail Use% Mounted on</span><br><span class="line">udev            1.5G     0  1.5G   0% /dev</span><br><span class="line">tmpfs           300M  5.1M  295M   2% /run</span><br><span class="line">/dev/sda6        29G  7.3G   20G  28% /</span><br><span class="line">tmpfs           1.5G  188K  1.5G   1% /dev/shm</span><br><span class="line">tmpfs           5.0M  4.0K  5.0M   1% /run/lock</span><br><span class="line">tmpfs           1.5G     0  1.5G   0% /sys/fs/cgroup</span><br><span class="line">/dev/loop0      200M  4.4M  196M   3% /home/qkboo/mnt/boot</span><br><span class="line">/dev/loop1      200M  4.4M  196M   3% /home/qkboo/mnt/ROOT</span><br></pre></td></tr></table></figure>

<p><em>&#x2F;dev&#x2F;loop0</em> 파일 시스템이 지정한 마운트 위치에 마운트했다는 것을 알 수 있다.</p>
<p>또한 <code>-t [fs_type]</code> 옵션으로 파티션의 파일 시스템을 명시할 수 있다.</p>
<h4 id="이미지에서-한-파티션만-마운트-하기"><a href="#이미지에서-한-파티션만-마운트-하기" class="headerlink" title="이미지에서 한 파티션만 마운트 하기"></a>이미지에서 한 파티션만 마운트 하기</h4><p>이미지에 있는 하나의 파티션만 마운트 할 수 있다. [^3]</p>
<p>앞의 이미지 파일 정보를 <code>/dev/loop0</code> 에 offset을 주고</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo losetup -o 4194304 /dev/loop0 sda.img</span><br></pre></td></tr></table></figure>

<p>Now the partition resides on &#x2F;dev&#x2F;loop0. You can fsck it, mount it etc</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo fsck -fv /dev/loop0</span><br><span class="line">sudo mount /dev/loop0 /mnt</span><br></pre></td></tr></table></figure>

<p>Unmount</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo umount /mnt</span><br><span class="line">sudo losetup -d /dev/loop0</span><br></pre></td></tr></table></figure>


<h4 id="Truncate"><a href="#Truncate" class="headerlink" title="Truncate"></a>Truncate</h4><p><a target="_blank" rel="noopener" href="https://raspberrypi.stackexchange.com/questions/7177/image-of-a-16gb-card-containing-unpartitioned-space-at-the-end-truncating-possi">질문, 원래 2GB 데비안 이미지를 16GB SD Card에 썼다. 나머지 14GB 공간을 별도로 파티션 나눌 수 있나?</a>  </p>
<p>먼저 이미지 파티션 정보를 얻는다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ fdisk -lu image.img</span><br><span class="line">Disk image.img: 4096 MB, 4096000000 bytes, 8000000 sectors</span><br><span class="line">Units = sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disk identifier: 0x000a1bc7</span><br><span class="line"></span><br><span class="line">      Device Boot      Start         End      Blocks   Id  System</span><br><span class="line">image.img1              2048     5872026     5869978    b  W95 FAT32</span><br></pre></td></tr></table></figure>

<p>이미지 파티션의 끝 부분이 <em>5872026</em> 으로 <code>5872026 * 512 = 2,8Gb</code> 이고, 나머지는 안쓰는 공간이다.</p>
<p><code>truncate</code> 도구로 현재 파티션에서 빈공간을 잘라낸다. 다만 블럭 수가 0에서 시작하므로 섹터 수에 <em>1</em>을 더해준다.[^2]</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ truncate --size=$[(5872026+1)*512] image.img</span><br></pre></td></tr></table></figure>


<h3 id="Repair-amp-Corruption"><a href="#Repair-amp-Corruption" class="headerlink" title="Repair &amp; Corruption"></a>Repair &amp; Corruption</h3><p>프롬프트에서 다음 명령으로 해당 파티션을 점검한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># fsck -fy /dev/mmcblk0p2</span><br><span class="line"># reboo</span><br></pre></td></tr></table></figure>

<p>혹은 다음 부팅시 처리할 수 있도록 한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># touch /forcefsck</span><br><span class="line"># reboot</span><br></pre></td></tr></table></figure>


<h4 id="Check-Bad-sector"><a href="#Check-Bad-sector" class="headerlink" title="Check Bad sector"></a>Check Bad sector</h4><p>터미널에서 SD Card 삽입&#x2F;추출 및 점검시 섹터 에러를 확인하기 위해 <code>dmesg</code> 로 감시할 수 있다. 다음 명령은 dmesg 가 발생하면, 내용 중 마지막 15줄을 터미널로 출력해 준다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ watch &quot;dmesg | tail -15&quot;</span><br></pre></td></tr></table></figure>


<h4 id="hdparam"><a href="#hdparam" class="headerlink" title="hdparam"></a><code>hdparam</code></h4><p><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/hdparm">hdparam</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ sudo hdparm -t /dev/mmcblk0</span><br><span class="line"></span><br><span class="line">/dev/mmcblk0:</span><br><span class="line"> Timing buffered disk reads:  58 MB in  3.09 seconds =  18.80 MB/sec</span><br></pre></td></tr></table></figure>


<h4 id="badblocks"><a href="#badblocks" class="headerlink" title="badblocks"></a>badblocks</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo badblocks -n -v /dev/mmcblk0</span><br></pre></td></tr></table></figure>



<h4 id="Recovering"><a href="#Recovering" class="headerlink" title="Recovering"></a>Recovering</h4><p>GNU ddrescue is a data recovery tool. It copies data from one file or block device (hard disc, cdrom, etc) to another, trying to rescue the good parts first in case of read errors.</p>
<p><a target="_blank" rel="noopener" href="https://www.gnu.org/software/ddrescue/">https://www.gnu.org/software/ddrescue/</a></p>
<h2 id="참조"><a href="#참조" class="headerlink" title="참조"></a>참조</h2><p>[^2]: <a target="_blank" rel="noopener" href="https://raspberrypi.stackexchange.com/questions/7177/image-of-a-16gb-card-containing-unpartitioned-space-at-the-end-truncating-possi">Truncate free space at disk image</a></p>
<p>[^3]: <a target="_blank" rel="noopener" href="https://askubuntu.com/questions/69363/mount-single-partition-from-image-of-entire-disk-device">Mount single partition from image of entire disk(device)</a></p>
</div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/images/qkboo_400.png" alt="Gangtai"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Gangtai</p><p class="is-size-6 is-block">Your title</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Paju, South Korea</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">포스트</p><a href="/archives"><p class="title">53</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">카테고리</p><a href="/categories"><p class="title">14</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">태그</p><a href="/tags"><p class="title">95</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/thinkbee" target="_blank" rel="noopener">팔로우</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/thinkbee"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/gtko"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">링크</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">카테고리</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/AI/"><span class="level-start"><span class="level-item">AI</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/"><span class="level-start"><span class="level-item">Linux</span></span><span class="level-end"><span class="level-item tag">26</span></span></a><ul><li><a class="level is-mobile" href="/categories/Linux/Database/"><span class="level-start"><span class="level-item">Database</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/NodeJS/"><span class="level-start"><span class="level-item">NodeJS</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/Programming/"><span class="level-start"><span class="level-item">Programming</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/NodeJS/"><span class="level-start"><span class="level-item">NodeJS</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul><li><a class="level is-mobile" href="/categories/NodeJS/Database/"><span class="level-start"><span class="level-item">Database</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Photoshop/"><span class="level-start"><span class="level-item">Photoshop</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/"><span class="level-start"><span class="level-item">Programming</span></span><span class="level-end"><span class="level-item tag">9</span></span></a><ul><li><a class="level is-mobile" href="/categories/Programming/Angular/"><span class="level-start"><span class="level-item">Angular</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/Angularjs/"><span class="level-start"><span class="level-item">Angularjs</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Raspberry-Pi/"><span class="level-start"><span class="level-item">Raspberry Pi</span></span><span class="level-end"><span class="level-item tag">10</span></span></a><ul><li><a class="level is-mobile" href="/categories/Raspberry-Pi/Linux/"><span class="level-start"><span class="level-item">Linux</span></span><span class="level-end"><span class="level-item tag">10</span></span></a><ul><li><a class="level is-mobile" href="/categories/Raspberry-Pi/Linux/Database/"><span class="level-start"><span class="level-item">Database</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li></ul></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">최근 글</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-02-23T15:47:59.802Z">2022-02-24</time></p><p class="title"><a href="/2022/02/24/hello-world/">blog.thinkbee.kr 이전 작업중입니다.</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-02-02T09:00:00.000Z">2020-02-02</time></p><p class="title"><a href="/2020/02/02/linux/2020-02-02-letsencrypt%EB%B0%9C%EA%B8%89/">HTTPS를 위한 공인인증서 - Let&#039;s Encrypt 발급</a></p><p class="categories"><a href="/categories/Linux/">Linux</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2019-12-20T03:00:00.000Z">2019-12-20</time></p><p class="title"><a href="/2019/12/20/linux-2019-12-20-mongodb-config/">MongoDB 구성 설정과 사용자 인증 사용</a></p><p class="categories"><a href="/categories/Linux/">Linux</a> / <a href="/categories/Linux/Database/">Database</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2019-12-20T01:00:00.000Z">2019-12-20</time></p><p class="title"><a href="/2019/12/20/linux-2019-12-20-mongodb-4-2-install-arm64/">MongoDB Community Edition 4.2 설치 - ARM64 Ubuntu/Debian Armbian</a></p><p class="categories"><a href="/categories/Linux/">Linux</a> / <a href="/categories/Linux/Database/">Database</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2019-09-05T11:00:00.000Z">2019-09-05</time></p><p class="title"><a href="/2019/09/05/python/2019-09-05-OpenSuse-JupyterNotebook_scientific/">openSUSE - 과학계산을 위한 Python, Jupyter Notebook</a></p><p class="categories"><a href="/categories/Linux/">Linux</a> / <a href="/categories/Linux/Programming/">Programming</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">아카이브</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2022/02/"><span class="level-start"><span class="level-item">2월 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/02/"><span class="level-start"><span class="level-item">2월 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/12/"><span class="level-start"><span class="level-item">12월 2019</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/09/"><span class="level-start"><span class="level-item">9월 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/10/"><span class="level-start"><span class="level-item">10월 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/08/"><span class="level-start"><span class="level-item">8월 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/07/"><span class="level-start"><span class="level-item">7월 2018</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/06/"><span class="level-start"><span class="level-item">6월 2018</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/12/"><span class="level-start"><span class="level-item">12월 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/11/"><span class="level-start"><span class="level-item">11월 2017</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/10/"><span class="level-start"><span class="level-item">10월 2017</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/09/"><span class="level-start"><span class="level-item">9월 2017</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/07/"><span class="level-start"><span class="level-item">7월 2017</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/05/"><span class="level-start"><span class="level-item">5월 2017</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/04/"><span class="level-start"><span class="level-item">4월 2017</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/12/"><span class="level-start"><span class="level-item">12월 2016</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/02/"><span class="level-start"><span class="level-item">2월 2016</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">태그</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/ARM/"><span class="tag">ARM</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Armbian/"><span class="tag">Armbian</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Artificial-Intelligence/"><span class="tag">Artificial Intelligence</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Debian/"><span class="tag">Debian</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Debian-Strech/"><span class="tag">Debian Strech</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JSON-Web-Token/"><span class="tag">JSON Web Token</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JWT-Toekn/"><span class="tag">JWT Toekn</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/LEAP-15-0/"><span class="tag">LEAP 15.0</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/LEAP-42-3/"><span class="tag">LEAP 42.3</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">10</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MongoDB/"><span class="tag">MongoDB</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Numpy/"><span class="tag">Numpy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Odroid/"><span class="tag">Odroid</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Odroid-C2/"><span class="tag">Odroid C2</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Orange-Pi/"><span class="tag">Orange Pi</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Raspberry-Pi/"><span class="tag">Raspberry Pi</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Raspberry-Pi-3/"><span class="tag">Raspberry Pi 3</span><span class="tag">10</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Raspbian/"><span class="tag">Raspbian</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SD-Card/"><span class="tag">SD Card</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Scientific/"><span class="tag">Scientific</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/TensorFlow/"><span class="tag">TensorFlow</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/TypeScript/"><span class="tag">TypeScript</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/TypeScript-Tutorials/"><span class="tag">TypeScript Tutorials</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Ubuntu/"><span class="tag">Ubuntu</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/X11/"><span class="tag">X11</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/amd64/"><span class="tag">amd64</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/angular4/"><span class="tag">angular4</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/angularjs/"><span class="tag">angularjs</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/apache/"><span class="tag">apache</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/arm64/"><span class="tag">arm64</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/armbian/"><span class="tag">armbian</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/banana-pi/"><span class="tag">banana pi</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/certificate-ssl/"><span class="tag">certificate ssl</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/clipping-mask/"><span class="tag">clipping-mask</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/collages/"><span class="tag">collages</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cross-compiler/"><span class="tag">cross compiler</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/debian/"><span class="tag">debian</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/firewall/"><span class="tag">firewall</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/firewalld/"><span class="tag">firewalld</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/https/"><span class="tag">https</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/install/"><span class="tag">install</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jasmine/"><span class="tag">jasmine</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jupyter/"><span class="tag">jupyter</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jupyter-notebook/"><span class="tag">jupyter notebook</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jupyter-notebook/"><span class="tag">jupyter-notebook</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/karma/"><span class="tag">karma</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/leap-15/"><span class="tag">leap 15</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/leap-42-3/"><span class="tag">leap 42.3</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/linux/"><span class="tag">linux</span><span class="tag">17</span></a></div><div class="control"><a class="tags has-addons" href="/tags/lvm/"><span class="tag">lvm</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/lvm2/"><span class="tag">lvm2</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/macOS/"><span class="tag">macOS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/micro-SD-Card/"><span class="tag">micro SD Card</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/middleware/"><span class="tag">middleware</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mongodb/"><span class="tag">mongodb</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mongoose/"><span class="tag">mongoose</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nginx/"><span class="tag">nginx</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nodejs/"><span class="tag">nodejs</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nodejs-tutorials/"><span class="tag">nodejs tutorials</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nvm/"><span class="tag">nvm</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/odroid/"><span class="tag">odroid</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/odroid-c2/"><span class="tag">odroid c2</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/odroid-c2/"><span class="tag">odroid-c2</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/openSUSE/"><span class="tag">openSUSE</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/opensuse/"><span class="tag">opensuse</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/opensuse-leap-15/"><span class="tag">opensuse leap 15</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/orange-pi/"><span class="tag">orange pi</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/photoshop/"><span class="tag">photoshop</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/python/"><span class="tag">python</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/raspberry-pi/"><span class="tag">raspberry pi</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/security/"><span class="tag">security</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ssh/"><span class="tag">ssh</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ssl/"><span class="tag">ssl</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/synergy/"><span class="tag">synergy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/terminal/"><span class="tag">terminal</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tmux/"><span class="tag">tmux</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ubuntu/"><span class="tag">ubuntu</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/unit-testing/"><span class="tag">unit testing</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/virtualenv/"><span class="tag">virtualenv</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/virtualenvwrapper/"><span class="tag">virtualenvwrapper</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/webdav/"><span class="tag">webdav</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%EB%8D%B0%EB%B9%84%EC%95%88/"><span class="tag">데비안</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%EB%8D%B0%EC%9D%B4%EC%95%88/"><span class="tag">데이안</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%EB%9D%BC%EC%A6%88%EB%B2%A0%EB%A6%AC%ED%8C%8C%EC%9D%B4/"><span class="tag">라즈베리파이</span><span class="tag">10</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%EB%9D%BC%EC%A6%88%EB%B9%84%EC%95%88/"><span class="tag">라즈비안</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%EB%A6%AC%EB%88%85%EC%8A%A4/"><span class="tag">리눅스</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%EB%B0%94%EB%82%98%EB%82%98%ED%8C%8C%EC%9D%B4/"><span class="tag">바나나파이</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%EB%B0%A9%ED%99%94%EB%B2%BD/"><span class="tag">방화벽</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%EC%98%A4%EB%A0%8C%EC%A7%80%ED%8C%8C%EC%9D%B4/"><span class="tag">오렌지파이</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%EC%9A%B0%EB%B6%84%ED%88%AC/"><span class="tag">우분투</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%EC%9B%B9%ED%86%A0%ED%81%B0/"><span class="tag">웹토큰</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%EC%9D%B8%EA%B3%B5%EC%A7%80%EB%8A%A5/"><span class="tag">인공지능</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%EC%A0%84%EC%9B%90%EA%B4%80%EB%A6%AC/"><span class="tag">전원관리</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%ED%8C%8C%EC%9D%B4%EC%8D%AC/"><span class="tag">파이썬</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%ED%8C%8C%EC%9D%B4%EC%96%B4%EC%9B%94/"><span class="tag">파이어월</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">업데이트 소식 받기</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="구독"></div></div></form></div></div></div><div class="card widget" data-type="adsense"><div class="card-content"><div class="menu"><h3 class="menu-label">광고</h3><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-1465716454138955" data-ad-slot="4883770640" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="구독"></div></div></form></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/images/thinkbee_logo.png" alt="Blogging through Programming" height="28"></a><p class="is-size-7"><span>&copy; 2022 John Doe</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("ko");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="맨 위로" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "이 웹 사이트는 귀하의 경험을 향상시키기 위해 Cookie를 사용합니다.",
          dismiss: "무시",
          allow: "허용",
          deny: "거부",
          link: "더 알아보기",
          policy: "Cookie 정책",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="입력 하세요..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"입력 하세요...","untitled":"(제목 없음)","posts":"포스트","pages":"페이지","categories":"카테고리","tags":"태그"});
        });</script></body></html>