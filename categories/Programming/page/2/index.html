<!doctype html>
<html lang="ko"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta><title>카테고리: Programming - IT Tech blogging</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="thinkbee blog"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="thinkbee blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Machine learning, Deep learning, Python, Data science and Mobile Programming like Android"><meta property="og:type" content="website"><meta property="og:title" content="IT Tech blogging"><meta property="og:url" content="https://blog.thinkbee.kr/"><meta property="og:site_name" content="IT Tech blogging"><meta property="og:description" content="Machine learning, Deep learning, Python, Data science and Mobile Programming like Android"><meta property="og:locale" content="ko_KR"><meta property="og:image" content="https://blog.thinkbee.kr/img/og_image.png"><meta property="article:author" content="Gangtai Goh"><meta property="article:tag" content="Machine learning, Deep learning, Python, Data science, Android, Ubuntu, Linux, macOS"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://blog.thinkbee.kr/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.thinkbee.kr"},"headline":"IT Tech blogging","image":["https://blog.thinkbee.kr/img/og_image.png"],"author":{"@type":"Person","name":"Gangtai Goh"},"publisher":{"@type":"Organization","name":"IT Tech blogging","logo":{"@type":"ImageObject","url":"https://blog.thinkbee.kr/images/thinkbee_logo.png"}},"description":"Machine learning, Deep learning, Python, Data science and Mobile Programming like Android"}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/vs2015.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-5ZH90CZ414" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-5ZH90CZ414');</script><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><script data-ad-client="ca-pub-1465716454138955" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/images/thinkbee_logo.png" alt="IT Tech blogging" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Blog</a><a class="navbar-item" href="/documents">Doc</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/thinkbee"><i class="fab fa-github"></i></a><a class="navbar-item search" title="검색" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-four-fifths-tablet is-four-fifths-desktop is-four-fifths-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/categories">카테고리</a></li><li class="is-active"><a href="#" aria-current="page">Programming</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-07-14T07:00:00.000Z" title="7/14/2023, 4:00:00 PM">2023-07-14</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2023-07-15T08:17:32.478Z" title="7/15/2023, 5:17:32 PM">2023-07-15</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Programming/">Programming</a><span> / </span><a class="link-muted" href="/categories/Programming/Python/">Python</a></span><span class="level-item">7분안에 읽기 (약 1001 단어)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/jupyterlab-multiprocess_print-483b37e7a2c3/">Jupyter 기반 환경에서 Multiprocess 실행시 print 출력 차이.</a></p><div class="content"><p>jupyter notebook에서 실행하면 차일드 프로세스로 실행한 print() 로 출력하는 결과를 확인할 수 업다. print 는 std out 에 출력하도록 되어 있다. 자식 프로세스에서 print 를 호출하면 <code>spawn</code> 을 사용해서 호출되어서 출력되지 않는다.  </p>
<h1 id="차일드-프로세스-print-문제"><a href="#차일드-프로세스-print-문제" class="headerlink" title="차일드 프로세스 print 문제"></a>차일드 프로세스 print 문제</h1><p>아래 코드는 아주 간단하게 메인 프로세스에서 새 프로세스를 생성하고 실행한다. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">msg</span>):</span><br><span class="line">    <span class="built_in">print</span>(msg)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    proc = Process(target=func, args=(<span class="string">&#x27;Hello multiproess&#x27;</span>,))</span><br><span class="line">    proc.start()</span><br><span class="line">    proc.join()</span><br></pre></td></tr></table></figure>

<p>이 코드는 소스로 쉘에서 실행하거나 Web 기반의 jupyterlab 에서 실행하면 아무 문제이 print 문이 잘 작동하고 출력 결과가 나온다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>! python mutiprocess1.py</span><br><span class="line">Hello multiproess</span><br></pre></td></tr></table></figure>

<blockquote>
<p>print 의 Multiprocessing 에서 문제는 링크 <a href="#footnote1">참고1</a> 을 읽어보기를 권한다. 이 글에서는 테스트한 내용을 정리만 했다.</p>
</blockquote>
<h1 id="원인"><a href="#원인" class="headerlink" title="원인"></a>원인</h1><p>아래 링크 <a href="#footnote1">참고1</a> 기사에서 설명을 자세히 하고 있다. 보통 파이썬에서 차일드 프로세스를 시작할 때는 <code>&#39;fork&#39;, &#39;spawn&#39;, &#39;forkserver&#39;</code> 방법이 있다고 한다. 그런데 spawn 으로 차일드 프로세스를 실행하면 std io 출력 버퍼가 자동으로 비워지지 않는다(print는 기본으로 flush가 되지 않는다). 그러다 보니 차일드 프로세스가 종료 하면서 자동으로 gabage collection에 의해  버퍼에 남아 있는 메시지가 사라지는 것이다.</p>
<h1 id="해결-방법"><a href="#해결-방법" class="headerlink" title="해결 방법"></a>해결 방법</h1><ol>
<li>메시지 버퍼가 사라지기 전에 flush 를 한다.</li>
<li>fork 기반의 프로세스를 생성한다.</li>
</ol>
<h2 id="1-flush-사용"><a href="#1-flush-사용" class="headerlink" title="1. flush 사용"></a>1. flush 사용</h2><ol>
<li>메시지 버퍼가 사라지기 전에 flush 를 한다.</li>
</ol>
<p>이를 해결하기 위해 모든 print 의 출력은 즉시 flush 되도록 flush&#x3D;True 옵션을 사용할 수 있다고 한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">msg</span>):</span><br><span class="line">    <span class="built_in">print</span>(msg, flush=Yes)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>이 방법은 VS code 현재 jupyter 확장에서는 효과가 없다.</p>
</blockquote>
<h3 id="flush-란"><a href="#flush-란" class="headerlink" title="flush 란?"></a>flush 란?</h3><p>std io 의 버퍼 처리 흐름은 글 <a target="_blank" rel="noopener" href="https://velog.io/@jinh2352/%ED%8C%8C%EC%9D%BC-IO-%EB%B2%84%ED%8D%BC%EB%A7%81">파일 I&#x2F;O 버퍼링</a> 을 살펴보고,</p>
<img src='https://images.velog.io/images/jinh2352/post/f7beb0b1-fb84-4f74-adcf-5956f80833ab/image.png' width=550>


<p>python에서 print 같은 표준 출력의 flush에 대해서 이글 <a target="_blank" rel="noopener" href="https://www.msdotnet.co.in/2020/04/print-function-in-python-language-with.html"></a> 의 그림을 참고한다.</p>
<img src='https://1.bp.blogspot.com/-UrjeTkA4kVA/XpcsMVPBIHI/AAAAAAAAHRg/EDERNZm9L4MIEWEtyIiJ42par-sIChx3wCLcBGAsYHQ/s640/FLUSH%2BIN%2BPYTHON.JPG' width=550>


<h2 id="2-fork-기반의-프로세스를-생성한다"><a href="#2-fork-기반의-프로세스를-생성한다" class="headerlink" title="2. fork 기반의 프로세스를 생성한다."></a>2. fork 기반의 프로세스를 생성한다.</h2><p>지원되는 프로세스 시작 방법은 아래 같이 확인이 가능하다. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> multiprocessing <span class="keyword">as</span> mp</span><br><span class="line"></span><br><span class="line">mp.get_start_method()       <span class="comment"># 현재 start 메서드</span></span><br><span class="line">mp.get_all_start_methods()  <span class="comment"># 모든 start 메서드</span></span><br></pre></td></tr></table></figure>

<p>아래 같이 start method 를 <code>fork</code> 로 강제 사용할 수 있다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> multiprocessing <span class="keyword">as</span> mp</span><br><span class="line"></span><br><span class="line">mp.set_start_method(<span class="string">&#x27;fork&#x27;</span>)       <span class="comment"># 현재 start 메서드</span></span><br></pre></td></tr></table></figure>

<p>브라우저 기반의 jupyter 실행환경은  <code>&#39;fork&#39;, &#39;spawn&#39;, &#39;forkserver&#39;</code> 를 모두 가능하다. 하지만 현재 VS code 의 jupyter 확장은 에서는 <code>spawn</code> 만 지원하고 있다.</p>
<h2 id="fork-spawn"><a href="#fork-spawn" class="headerlink" title="fork, spawn"></a>fork, spawn</h2><p>링크 <a href="#footnote2">침고2</a> 에 있는 글에서 Fork, Spawn 에 대한 설명을 읽어보자.</p>
<p>Forking</p>
<ul>
<li>포크한 부모 프로세스의 이미지를 그래도 사용한다.</li>
</ul>
<img src='https://d33wubrfki0l68.cloudfront.net/8c3a4605e6d501f6a448faafd71cd2047d9d2e07/b9b18/blog/assets/2019-11-13-python-forkserver-preload/python-forkserver-0.png' width=550>


<p>Spwaning</p>
<ul>
<li>포크한 부모 프로세스와 다르게 새 이미지로 갱신한다.</li>
</ul>
<img src='https://d33wubrfki0l68.cloudfront.net/8d5e9dd98d91090aeecb72cf9e956b3afe679fd6/3b168/blog/assets/2019-11-13-python-forkserver-preload/python-forkserver-1.png' width=500>


<h1 id="sleep-으로-지연하면"><a href="#sleep-으로-지연하면" class="headerlink" title="sleep 으로 지연하면?"></a>sleep 으로 지연하면?</h1><p>VS code 환경에서 아래 같이 sleep 으로 지연을 주어 봤지만 해결이 안된다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">msg</span>):</span><br><span class="line">    <span class="built_in">print</span>(msg, flush=<span class="literal">True</span>)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    proc = mp.Process(target=func, args=(<span class="string">&#x27;Hello multiproess&#x27;</span>,))</span><br><span class="line">    proc.start()</span><br><span class="line">    proc.join()</span><br></pre></td></tr></table></figure>

<p>아래 같이 join 전에 sleep 으로 지연</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">msg</span>):</span><br><span class="line">    <span class="built_in">print</span>(msg, flush=<span class="literal">True</span>)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    proc = mp.Process(target=func, args=(<span class="string">&#x27;Hello multiproess&#x27;</span>,))</span><br><span class="line">    proc.start()</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    proc.join()</span><br></pre></td></tr></table></figure>


<h1 id="결론"><a href="#결론" class="headerlink" title="결론"></a>결론</h1><p>현재 테스트한 VS Code 의 jupyter 확장 버전은 아래 같다.</p>
<ul>
<li>Windows VS code, Jupyter Extension<ul>
<li>v2023.6.1101941928</li>
<li>v2023.7.1001901100</li>
</ul>
</li>
</ul>
<p>만약 VS code 에서 Multiprocess 디버깅시 다른 logger 라이브러리 등을 이용해야 할 것 같다.</p>
<hr>
<h1 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h1><p><a name='footnote1'>참고1</a> :  <a target="_blank" rel="noopener" href="https://superfastpython.com/multiprocessing-print/">How to print() from a Child Process in Python</a></p>
<p><a name='footnote2'>참고2</a> : <a target="_blank" rel="noopener" href="https://sunyzero.tistory.com/191">fork, vfork 그리고 posix_spawn 이야기</a></p>
<p><a name='footnote2'>참고3</a> : <a target="_blank" rel="noopener" href="https://bnikolic.co.uk/blog/python/parallelism/2019/11/13/python-forkserver-preload.html">foring, spawning 이미지</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-07-13T13:00:00.000Z" title="7/13/2023, 10:00:00 PM">2023-07-13</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2023-07-13T15:10:03.857Z" title="7/14/2023, 12:10:03 AM">2023-07-14</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Programming/">Programming</a><span> / </span><a class="link-muted" href="/categories/Programming/Python/">Python</a></span><span class="level-item">4분안에 읽기 (약 646 단어)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/windows-conda-shell-cbeeac74bbce/">Windows Terminal에서 miniconda/ananconda Profile 사용</a></p><div class="content"><p>Anaconda &#x2F; Miniconda 를 설치하고 윈도우즈에서 실행시 바로가기로 사용하는 방법을 정리했다. 모든 Commandline, Powershell 에서 conda 명령을 사용하려면 환경변수 <code>PATH</code> 에 지정을 해야 한다. 이 글에서는 바로가기를 사용하면 <code>PATH</code> 환경변수를 활용하지 않고도 쉽게 사용할 수 있다.</p>
<blockquote>
<p>Anaconda&#x2F;Miniconda 설치 프로그램으로 설치를 하면 바로가기를 만들어 준다. 여기서 힌트를 얻으면 된다.</p>
</blockquote>
<img src='/images/python/conda-powershell02.png'>


<p>바로가기 속성을 사용해 파워쉘로 conda 환경을 초기화 하기 위해서는 conda-hook.ps1 실행이 필요하다. 설치한 Anaconda 시작프로그램의 속성을 통해 알 수 있다. 보통 설치된 아래 위치에 있다.</p>
<ul>
<li><code>C:\Users\USERID\miniconda3\shell\condabin\conda-hook.ps1</code></li>
</ul>
<img src='/images/python/conda-powershell01.png'>


<h1 id="PowerShell"><a href="#PowerShell" class="headerlink" title="PowerShell"></a>PowerShell</h1><p>윈도우 기본 파워쉘과 Powershell 7 으로 바로가기 설정을 보면, conda-hook.ps1 을 포함해 바로가기 아이콘 속성에 파워쉘을 통해 실행하도록 설정하면 된다.</p>
<h2 id="PowerShell-7"><a href="#PowerShell-7" class="headerlink" title="PowerShell 7"></a>PowerShell 7</h2><p>powershell 7 으로 Miniconda3 의 base 가상환경 기반 쉘을 실행한다.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;C:\Program Files\PowerShell\7\pwsh.exe&quot; -ExecutionPolicy ByPass -NoExit -Command &quot;&amp; &#x27;C:\Users\USERID\miniconda3\shell\condabin\conda-hook.ps1&#x27; ; conda activate &#x27;C:\Users\USERID\miniconda3&#x27; &quot;</span><br></pre></td></tr></table></figure>


<h2 id="기본-PowerShell-버전"><a href="#기본-PowerShell-버전" class="headerlink" title="기본 PowerShell 버전"></a>기본 PowerShell 버전</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">%</span><span class="language-bash">windir%\System32\WindowsPowerShell\v1.0\powershell.exe -ExecutionPolicy ByPass -NoExit -Command <span class="string">&quot;&amp; &#x27;C:\Users\USERID\miniconda3\shell\condabin\conda-hook.ps1&#x27; ; conda activate &#x27;C:\Users\USERID\miniconda3&#x27; &quot;</span></span></span><br></pre></td></tr></table></figure>


<h1 id="Command-Line"><a href="#Command-Line" class="headerlink" title="Command Line"></a>Command Line</h1><p>윈도우 Command 로 anaconda &#x2F; miniconda 를 실행하려면 아래 같이 activate.bat 배치를 실행하면 된다.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">%</span><span class="language-bash">windir%\System32\cmd.exe <span class="string">&quot;/K&quot;</span> C:\Users\daddy\miniconda3\Scripts\activate.bat C:\Users\daddy\miniconda3</span></span><br></pre></td></tr></table></figure>

<br>

<h1 id="Windows-Terminal-프로파일-설정"><a href="#Windows-Terminal-프로파일-설정" class="headerlink" title="Windows Terminal 프로파일 설정"></a>Windows Terminal 프로파일 설정</h1><p>윈도우 터미널에 새 프로파일 추가시 랜덤한 GUID 값이 필요하다. 터미널에서 New-Guid 명령으로 발행해 사용한다.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span>&gt; <span class="built_in">New-Guid</span></span><br><span class="line"></span><br><span class="line">Guid</span><br><span class="line"><span class="literal">----</span></span><br><span class="line"><span class="number">9</span>f2a1a27<span class="literal">-fe9b-4421-ba19-6cea57188b17</span></span><br></pre></td></tr></table></figure>

<h2 id="PowerShell-7-버전"><a href="#PowerShell-7-버전" class="headerlink" title="PowerShell 7 버전"></a>PowerShell 7 버전</h2><p>guid 는 New-Guid 로 발행해서 등록하면 된다.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;commandline&quot;</span><span class="punctuation">:</span> <span class="string">&quot;C:\\Program Files\\PowerShell\\7\\pwsh.exe -ExecutionPolicy ByPass -NoExit -Command \&quot;&amp; &#x27;C:\\Users\\USERID\\miniconda3\\shell\\condabin\\conda-hook.ps1&#x27; ; conda activate &#x27;C:\\Users\\daddy\\miniconda3&#x27; \&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;guid&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&#123;fe2a1a27-9efb-4421-ba19-6cea57188b17&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Miniconda3 64bit(ps7)&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;startingDirectory&quot;</span><span class="punctuation">:</span> <span class="string">&quot;%USERPROFILE%&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;commandline&quot;</span><span class="punctuation">:</span> <span class="string">&quot;C:\\Program Files\\PowerShell\\7\\pwsh.exe -ExecutionPolicy ByPass -NoExit -Command \&quot;&amp; &#x27;C:\\Users\\USERID\\anaconda3\\shell\\condabin\\conda-hook.ps1&#x27; ; conda activate &#x27;C:\\Users\\daddy\\anaconda3&#x27; \&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;guid&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&#123;3f2k7199-d35c-44e5-b82d-7cd5442175fc&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Anaconda 64bit(ps7)&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;startingDirectory&quot;</span><span class="punctuation">:</span> <span class="string">&quot;%USERPROFILE%&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>


<h2 id="윈도우-기본-PowerShell-버전"><a href="#윈도우-기본-PowerShell-버전" class="headerlink" title="윈도우 기본 PowerShell 버전"></a>윈도우 기본 PowerShell 버전</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;commandline&quot;</span><span class="punctuation">:</span> <span class="string">&quot;%windir%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -ExecutionPolicy ByPass -NoExit -Command \&quot;&amp; &#x27;C:\\Users\\USERID\\miniconda3\\shell\\condabin\\conda-hook.ps1&#x27; ; conda activate &#x27;C:\\Users\\daddy\\miniconda3&#x27; \&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;guid&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&#123;573e44d9-1ff5-4f3f-b083-1b2fd9a6a575&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Miniconda3 64bit&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;startingDirectory&quot;</span><span class="punctuation">:</span> <span class="string">&quot;%USERPROFILE%&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;commandline&quot;</span><span class="punctuation">:</span> <span class="string">&quot;%windir%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -ExecutionPolicy ByPass -NoExit -Command \&quot;&amp; &#x27;C:\\Users\\USERID\\anaconda3\\shell\\condabin\\conda-hook.ps1&#x27; ; conda activate &#x27;C:\\Users\\daddy\\anaconda3&#x27; \&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;guid&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&#123;f441f482-8cf6-47ed-9a9c-fc40df46c9ac&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Anaconda 64bit&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;startingDirectory&quot;</span><span class="punctuation">:</span> <span class="string">&quot;%USERPROFILE%&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-07-12T17:00:00.000Z" title="7/13/2023, 2:00:00 AM">2023-07-13</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2023-07-12T17:57:34.916Z" title="7/13/2023, 2:57:34 AM">2023-07-13</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Programming/">Programming</a><span> / </span><a class="link-muted" href="/categories/Programming/Python/">Python</a></span><span class="level-item">10분안에 읽기 (약 1462 단어)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/pd-Stack_Unstack_Melt-9d0bcd365efe/">Pandas - Pivot, Stack, Unstack, Melt</a></p><div class="content"><p>Pandas 에서 2차원 data를 Stack, unstack, melt 를 이용해 복합 인덱스를 사용할 수 있고 Pivot 을 이용해 특정 데이터 중심의 2차원 데이터로 생성할 수 있다.</p>
<ol>
<li>Pivot</li>
<li>Stack &amp; Unstack</li>
<li>Melt</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure>

<h1 id="2차원-테이블"><a href="#2차원-테이블" class="headerlink" title="2차원 테이블"></a>2차원 테이블</h1><p>행과 열로 구성된 데이터 집합</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(</span><br><span class="line">    &#123;<span class="string">&#x27;foo&#x27;</span> : [<span class="string">&#x27;One&#x27;</span>,<span class="string">&#x27;One&#x27;</span>,<span class="string">&#x27;One&#x27;</span>,<span class="string">&#x27;Two&#x27;</span>,<span class="string">&#x27;Two&#x27;</span>,<span class="string">&#x27;Two&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;bar&#x27;</span>: [<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;baz&#x27;</span>: [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>] ,</span><br><span class="line">        <span class="string">&#x27;zoo&#x27;</span>: [<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;y&#x27;</span>,<span class="string">&#x27;z&#x27;</span>,<span class="string">&#x27;q&#x27;</span>,<span class="string">&#x27;w&#x27;</span>,<span class="string">&#x27;t&#x27;</span>]&#125;</span><br><span class="line">)</span><br><span class="line">df</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>foo</th>
      <th>bar</th>
      <th>baz</th>
      <th>zoo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>One</td>
      <td>A</td>
      <td>1</td>
      <td>x</td>
    </tr>
    <tr>
      <th>1</th>
      <td>One</td>
      <td>B</td>
      <td>2</td>
      <td>y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>One</td>
      <td>C</td>
      <td>3</td>
      <td>z</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Two</td>
      <td>A</td>
      <td>4</td>
      <td>q</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Two</td>
      <td>B</td>
      <td>5</td>
      <td>w</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Two</td>
      <td>C</td>
      <td>6</td>
      <td>t</td>
    </tr>
  </tbody>
</table>
</div>



<h1 id="Pivot"><a href="#Pivot" class="headerlink" title="Pivot"></a>Pivot</h1><p>피봇&#x2F;피봇 테이블은 2차원 데이터 열에서 공통된 부분을 중심으로 새 테이블 집합을 형성하게 해준다.  피봇은 index, columns, values 라는 이름을 가진 세 가지 parameter를 취한다. 이러한 각 파라미터의 값으로 원래 표에 열 이름을 지정해야 한다.</p>
<img src='https://pandas.pydata.org/docs/_images/reshaping_pivot.png'>

<p>foo, bar, baz, zoo 컬럼 중에서 foo 에 대해서 정리를 하고 bar 를 컬럼으로 지정하면 아래와 같다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df_pivot = df.pivot_table(index=<span class="string">&#x27;foo&#x27;</span>, columns=<span class="string">&#x27;bar&#x27;</span>, values=<span class="string">&#x27;baz&#x27;</span>)</span><br><span class="line">df_pivot</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>bar</th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
    <tr>
      <th>foo</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>One</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Two</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>



<h3 id="ex-nba-데이터를-포지션의-연령별-연봉-테이블로-전환"><a href="#ex-nba-데이터를-포지션의-연령별-연봉-테이블로-전환" class="headerlink" title="ex) nba 데이터를 포지션의 연령별 연봉 테이블로 전환"></a>ex) nba 데이터를 포지션의 연령별 연봉 테이블로 전환</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dfnba = pd.read_csv(<span class="string">&#x27;../data/nba.csv&#x27;</span>)</span><br><span class="line">dfnba</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Team</th>
      <th>Number</th>
      <th>Position</th>
      <th>Age</th>
      <th>Height</th>
      <th>Weight</th>
      <th>College</th>
      <th>Salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Avery Bradley</td>
      <td>Boston Celtics</td>
      <td>0.0</td>
      <td>PG</td>
      <td>25.0</td>
      <td>6-2</td>
      <td>180.0</td>
      <td>Texas</td>
      <td>7730337.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jae Crowder</td>
      <td>Boston Celtics</td>
      <td>99.0</td>
      <td>SF</td>
      <td>25.0</td>
      <td>6-6</td>
      <td>235.0</td>
      <td>Marquette</td>
      <td>6796117.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>John Holland</td>
      <td>Boston Celtics</td>
      <td>30.0</td>
      <td>SG</td>
      <td>27.0</td>
      <td>6-5</td>
      <td>205.0</td>
      <td>Boston University</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>R.J. Hunter</td>
      <td>Boston Celtics</td>
      <td>28.0</td>
      <td>SG</td>
      <td>22.0</td>
      <td>6-5</td>
      <td>185.0</td>
      <td>Georgia State</td>
      <td>1148640.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Jonas Jerebko</td>
      <td>Boston Celtics</td>
      <td>8.0</td>
      <td>PF</td>
      <td>29.0</td>
      <td>6-10</td>
      <td>231.0</td>
      <td>NaN</td>
      <td>5000000.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>453</th>
      <td>Shelvin Mack</td>
      <td>Utah Jazz</td>
      <td>8.0</td>
      <td>PG</td>
      <td>26.0</td>
      <td>6-3</td>
      <td>203.0</td>
      <td>Butler</td>
      <td>2433333.0</td>
    </tr>
    <tr>
      <th>454</th>
      <td>Raul Neto</td>
      <td>Utah Jazz</td>
      <td>25.0</td>
      <td>PG</td>
      <td>24.0</td>
      <td>6-1</td>
      <td>179.0</td>
      <td>NaN</td>
      <td>900000.0</td>
    </tr>
    <tr>
      <th>455</th>
      <td>Tibor Pleiss</td>
      <td>Utah Jazz</td>
      <td>21.0</td>
      <td>C</td>
      <td>26.0</td>
      <td>7-3</td>
      <td>256.0</td>
      <td>NaN</td>
      <td>2900000.0</td>
    </tr>
    <tr>
      <th>456</th>
      <td>Jeff Withey</td>
      <td>Utah Jazz</td>
      <td>24.0</td>
      <td>C</td>
      <td>26.0</td>
      <td>7-0</td>
      <td>231.0</td>
      <td>Kansas</td>
      <td>947276.0</td>
    </tr>
    <tr>
      <th>457</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>458 rows × 9 columns</p>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.options.display.float_format = <span class="string">&quot;&#123;:,.2f&#125;&quot;</span>.<span class="built_in">format</span></span><br></pre></td></tr></table></figure>

<p>컬럼의 데이터에 공통된 모습이 많이 보인다. 이 중에서 포지션을 기준으로 나이에 따른 연봉을 본다고 가정하면 포지션을 인덱스로하고 나이를 컬럼으로 지정하면 아래와 같다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 포지션의 연령별 연봉 테이블</span></span><br><span class="line">dfnba.pivot_table(index=<span class="string">&#x27;Position&#x27;</span>, columns=<span class="string">&#x27;Age&#x27;</span>, values=<span class="string">&#x27;Salary&#x27;</span>)</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Age</th>
      <th>19.00</th>
      <th>20.00</th>
      <th>21.00</th>
      <th>22.00</th>
      <th>23.00</th>
      <th>24.00</th>
      <th>25.00</th>
      <th>26.00</th>
      <th>27.00</th>
      <th>28.00</th>
      <th>...</th>
      <th>31.00</th>
      <th>32.00</th>
      <th>33.00</th>
      <th>34.00</th>
      <th>35.00</th>
      <th>36.00</th>
      <th>37.00</th>
      <th>38.00</th>
      <th>39.00</th>
      <th>40.00</th>
    </tr>
    <tr>
      <th>Position</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C</th>
      <td>NaN</td>
      <td>5,143,140.00</td>
      <td>1,571,000.00</td>
      <td>3,476,698.20</td>
      <td>2,121,999.50</td>
      <td>4,532,003.33</td>
      <td>10,881,995.00</td>
      <td>3,041,850.82</td>
      <td>5,004,260.50</td>
      <td>7,635,761.83</td>
      <td>...</td>
      <td>10,338,218.00</td>
      <td>8,208,695.50</td>
      <td>9,500,000.00</td>
      <td>6,258,000.00</td>
      <td>7,448,760.00</td>
      <td>947,276.00</td>
      <td>NaN</td>
      <td>222,888.00</td>
      <td>NaN</td>
      <td>5,250,000.00</td>
    </tr>
    <tr>
      <th>PF</th>
      <td>NaN</td>
      <td>2,369,838.00</td>
      <td>2,397,408.00</td>
      <td>1,601,105.80</td>
      <td>2,399,120.50</td>
      <td>2,577,551.44</td>
      <td>2,195,476.60</td>
      <td>7,228,086.75</td>
      <td>9,217,098.43</td>
      <td>5,268,839.17</td>
      <td>...</td>
      <td>5,323,787.00</td>
      <td>14,346,365.00</td>
      <td>2,630,241.40</td>
      <td>6,469,277.50</td>
      <td>2,624,593.50</td>
      <td>2,877,470.00</td>
      <td>6,666,667.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8,500,000.00</td>
    </tr>
    <tr>
      <th>PG</th>
      <td>NaN</td>
      <td>3,316,290.00</td>
      <td>1,944,080.00</td>
      <td>2,381,130.00</td>
      <td>1,627,769.00</td>
      <td>4,652,526.50</td>
      <td>5,422,085.80</td>
      <td>10,038,174.80</td>
      <td>5,944,070.17</td>
      <td>5,021,965.17</td>
      <td>...</td>
      <td>7,467,596.40</td>
      <td>4,082,425.33</td>
      <td>2,226,179.67</td>
      <td>8,395,104.00</td>
      <td>NaN</td>
      <td>2,170,465.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>947,726.00</td>
      <td>250,750.00</td>
    </tr>
    <tr>
      <th>SF</th>
      <td>NaN</td>
      <td>1,979,976.00</td>
      <td>1,404,480.00</td>
      <td>2,401,364.60</td>
      <td>2,760,134.36</td>
      <td>5,067,491.60</td>
      <td>3,382,640.73</td>
      <td>7,322,325.20</td>
      <td>10,532,567.00</td>
      <td>1,996,608.71</td>
      <td>...</td>
      <td>10,960,320.25</td>
      <td>9,720,195.75</td>
      <td>NaN</td>
      <td>261,894.00</td>
      <td>947,276.00</td>
      <td>1,721,559.75</td>
      <td>25,000,000.00</td>
      <td>3,376,000.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>SG</th>
      <td>1,930,440.00</td>
      <td>1,749,840.00</td>
      <td>2,215,710.43</td>
      <td>2,055,241.00</td>
      <td>1,388,251.18</td>
      <td>3,205,720.53</td>
      <td>1,782,834.89</td>
      <td>9,872,690.29</td>
      <td>4,815,524.62</td>
      <td>6,354,000.00</td>
      <td>...</td>
      <td>7,085,000.00</td>
      <td>2,041,138.00</td>
      <td>2,233,533.33</td>
      <td>12,579,269.50</td>
      <td>3,512,173.75</td>
      <td>3,311,138.00</td>
      <td>NaN</td>
      <td>1,880,638.00</td>
      <td>4,088,019.00</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div>



<h1 id="Stack-amp-Unstack"><a href="#Stack-amp-Unstack" class="headerlink" title="Stack &amp; Unstack"></a>Stack &amp; Unstack</h1><p>2차원 테이블은 행 과 열이 순차적 값으로 교차하게 되어 있다. 스택은 컬럼의 값을 아래-위로 배치를 시킨다고 상상이 된다. 그래서 스택과 언스택은 이렇게 생각된다.</p>
<ul>
<li>stack : 2차원 컬럼의 내용을 수직방향으로 쌓는 구조, 즉 새로운 인덱스가 더해진다.</li>
<li>unstack : 인덱스 구성요소를 한 단계 컬럼으로 만들며 수평방향으로 쌓게 한다.</li>
</ul>
<p>stack</p>
<p><img src='https://pandas.pydata.org/docs/_images/reshaping_stack.png'> <a target="_blank" rel="noopener" href="https://pandas.pydata.org/docs/user_guide/reshaping.html">pandas reshaping</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">df_single_level = pd.DataFrame(</span><br><span class="line">    [[<span class="string">&#x27;Mostly cloudy&#x27;</span>, <span class="number">10</span>], [<span class="string">&#x27;Sunny&#x27;</span>, <span class="number">12</span>]],</span><br><span class="line">    index=[<span class="string">&#x27;London&#x27;</span>, <span class="string">&#x27;Oxford&#x27;</span>],</span><br><span class="line">    columns=[<span class="string">&#x27;Weather&#x27;</span>, <span class="string">&#x27;Wind&#x27;</span>]</span><br><span class="line">)</span><br><span class="line">df_single_level</span><br><span class="line"></span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Weather</th>
      <th>Wind</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>London</th>
      <td>Mostly cloudy</td>
      <td>10</td>
    </tr>
    <tr>
      <th>Oxford</th>
      <td>Sunny</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div>



<p>index와 weather, wind 라는 컬럼을 stack을 호출하면 weather-wind 관련 인덱스를 생성하고 데이터를 나열한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_single_level.stack()</span><br></pre></td></tr></table></figure>




<pre><code>London  Weather    Mostly cloudy
        Wind                  10
Oxford  Weather            Sunny
        Wind                  12
dtype: object
</code></pre>
<p>다른 데이터를 살펴보자.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># MultiIndex</span></span><br><span class="line">tuples = <span class="built_in">list</span>(</span><br><span class="line">    <span class="built_in">zip</span>(</span><br><span class="line">        *[</span><br><span class="line">            [<span class="string">&quot;bar&quot;</span>, <span class="string">&quot;bar&quot;</span>, <span class="string">&quot;baz&quot;</span>, <span class="string">&quot;baz&quot;</span>, <span class="string">&quot;foo&quot;</span>, <span class="string">&quot;foo&quot;</span>, <span class="string">&quot;qux&quot;</span>, <span class="string">&quot;qux&quot;</span>],</span><br><span class="line">            [<span class="string">&quot;one&quot;</span>, <span class="string">&quot;two&quot;</span>, <span class="string">&quot;one&quot;</span>, <span class="string">&quot;two&quot;</span>, <span class="string">&quot;one&quot;</span>, <span class="string">&quot;two&quot;</span>, <span class="string">&quot;one&quot;</span>, <span class="string">&quot;two&quot;</span>],</span><br><span class="line">        ]</span><br><span class="line">    )</span><br><span class="line">)</span><br><span class="line">index = pd.MultiIndex.from_tuples(tuples, names=[<span class="string">&quot;first&quot;</span>, <span class="string">&quot;second&quot;</span>])</span><br><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">8</span>, <span class="number">2</span>), index=index, columns=[<span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>])</span><br><span class="line">df</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
    <tr>
      <th>first</th>
      <th>second</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">bar</th>
      <th>one</th>
      <td>-1.301694</td>
      <td>-0.013259</td>
    </tr>
    <tr>
      <th>two</th>
      <td>-0.197846</td>
      <td>0.879890</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">baz</th>
      <th>one</th>
      <td>0.718211</td>
      <td>-0.739434</td>
    </tr>
    <tr>
      <th>two</th>
      <td>-0.140217</td>
      <td>0.071260</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">foo</th>
      <th>one</th>
      <td>-1.142268</td>
      <td>-2.606413</td>
    </tr>
    <tr>
      <th>two</th>
      <td>1.119145</td>
      <td>0.109402</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">qux</th>
      <th>one</th>
      <td>-0.504167</td>
      <td>-1.703280</td>
    </tr>
    <tr>
      <th>two</th>
      <td>1.064976</td>
      <td>1.011060</td>
    </tr>
  </tbody>
</table>
</div>



<p>위 데이터는 stack()을 하면 A, B 컬럼이 MultiIndex 로 추가되며 A, B 컬럼 데이터 포인트가 배치된다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.stack()</span><br></pre></td></tr></table></figure>




<pre><code>first  second   
bar    one     A   -1.301694
               B   -0.013259
       two     A   -0.197846
               B    0.879890
baz    one     A    0.718211
               B   -0.739434
       two     A   -0.140217
               B    0.071260
foo    one     A   -1.142268
               B   -2.606413
       two     A    1.119145
               B    0.109402
qux    one     A   -0.504167
               B   -1.703280
       two     A    1.064976
               B    1.011060
dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df2 = df[:<span class="number">4</span>]</span><br><span class="line">df2</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
    <tr>
      <th>first</th>
      <th>second</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">bar</th>
      <th>one</th>
      <td>-1.301694</td>
      <td>-0.013259</td>
    </tr>
    <tr>
      <th>two</th>
      <td>-0.197846</td>
      <td>0.879890</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">baz</th>
      <th>one</th>
      <td>0.718211</td>
      <td>-0.739434</td>
    </tr>
    <tr>
      <th>two</th>
      <td>-0.140217</td>
      <td>0.071260</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">stacked = df2.stack()</span><br><span class="line">stacked</span><br></pre></td></tr></table></figure>




<pre><code>first  second   
bar    one     A   -1.301694
               B   -0.013259
       two     A   -0.197846
               B    0.879890
baz    one     A    0.718211
               B   -0.739434
       two     A   -0.140217
               B    0.071260
dtype: float64
</code></pre>
<p>Unstack</p>
<p><img src='https://pandas.pydata.org/docs/_images/reshaping_unstack.png'> <a target="_blank" rel="noopener" href="https://pandas.pydata.org/docs/user_guide/reshaping.html">pandas reshaping</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stacked</span><br></pre></td></tr></table></figure>




<pre><code>first  second   
bar    one     A   -1.301694
               B   -0.013259
       two     A   -0.197846
               B    0.879890
baz    one     A    0.718211
               B   -0.739434
       two     A   -0.140217
               B    0.071260
dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stacked.unstack()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
    <tr>
      <th>first</th>
      <th>second</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">bar</th>
      <th>one</th>
      <td>-1.301694</td>
      <td>-0.013259</td>
    </tr>
    <tr>
      <th>two</th>
      <td>-0.197846</td>
      <td>0.879890</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">baz</th>
      <th>one</th>
      <td>0.718211</td>
      <td>-0.739434</td>
    </tr>
    <tr>
      <th>two</th>
      <td>-0.140217</td>
      <td>0.071260</td>
    </tr>
  </tbody>
</table>
</div>



<p>레벨을 지정</p>
<img src='https://pandas.pydata.org/docs/_images/reshaping_unstack_1.png'>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stacked.unstack(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>second</th>
      <th>one</th>
      <th>two</th>
    </tr>
    <tr>
      <th>first</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">bar</th>
      <th>A</th>
      <td>-1.301694</td>
      <td>-0.197846</td>
    </tr>
    <tr>
      <th>B</th>
      <td>-0.013259</td>
      <td>0.879890</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">baz</th>
      <th>A</th>
      <td>0.718211</td>
      <td>-0.140217</td>
    </tr>
    <tr>
      <th>B</th>
      <td>-0.739434</td>
      <td>0.071260</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stacked.unstack(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
    <tr>
      <th>first</th>
      <th>second</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">bar</th>
      <th>one</th>
      <td>-1.301694</td>
      <td>-0.013259</td>
    </tr>
    <tr>
      <th>two</th>
      <td>-0.197846</td>
      <td>0.879890</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">baz</th>
      <th>one</th>
      <td>0.718211</td>
      <td>-0.739434</td>
    </tr>
    <tr>
      <th>two</th>
      <td>-0.140217</td>
      <td>0.071260</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="Melt"><a href="#Melt" class="headerlink" title="Melt"></a>Melt</h1><p>melt() 는 ID 변수를 기준으로 원래 데이터셋에 있던 여러개의 칼럼 이름을 ‘variable’ 칼럼에 위에서 아래로 길게 쌓아놓고, ‘value’ 칼럼에 ID와 variable에 해당하는 값을 넣어주는 식으로 데이터를 재구조화합니다.  </p>
<img src='https://pandas.pydata.org/docs/_images/reshaping_melt.png'>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cheese = pd.DataFrame(</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;first&quot;</span>: [<span class="string">&quot;John&quot;</span>, <span class="string">&quot;Mary&quot;</span>],</span><br><span class="line">        <span class="string">&quot;last&quot;</span>: [<span class="string">&quot;Doe&quot;</span>, <span class="string">&quot;Bo&quot;</span>],</span><br><span class="line">        <span class="string">&quot;height&quot;</span>: [<span class="number">5.5</span>, <span class="number">6.0</span>],</span><br><span class="line">        <span class="string">&quot;weight&quot;</span>: [<span class="number">130</span>, <span class="number">150</span>],</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line">cheese</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>first</th>
      <th>last</th>
      <th>height</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>John</td>
      <td>Doe</td>
      <td>5.50</td>
      <td>130</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Mary</td>
      <td>Bo</td>
      <td>6.00</td>
      <td>150</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># colums중 height, weight 를 row 로 융합</span></span><br><span class="line">cheese.melt(id_vars=[<span class="string">&#x27;first&#x27;</span>,<span class="string">&#x27;last&#x27;</span>]) <span class="comment"># first, last 인덱스로 나머지 컬럼은 value 로 치환</span></span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>first</th>
      <th>last</th>
      <th>variable</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>John</td>
      <td>Doe</td>
      <td>height</td>
      <td>5.50</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Mary</td>
      <td>Bo</td>
      <td>height</td>
      <td>6.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>John</td>
      <td>Doe</td>
      <td>weight</td>
      <td>130.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Mary</td>
      <td>Bo</td>
      <td>weight</td>
      <td>150.00</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cheese.melt(id_vars=[<span class="string">&#x27;first&#x27;</span>,<span class="string">&#x27;last&#x27;</span>], value_name=<span class="string">&#x27;quantity&#x27;</span>) </span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>first</th>
      <th>last</th>
      <th>variable</th>
      <th>quantity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>John</td>
      <td>Doe</td>
      <td>height</td>
      <td>5.50</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Mary</td>
      <td>Bo</td>
      <td>height</td>
      <td>6.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>John</td>
      <td>Doe</td>
      <td>weight</td>
      <td>130.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Mary</td>
      <td>Bo</td>
      <td>weight</td>
      <td>150.00</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h1><ol>
<li><a target="_blank" rel="noopener" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.stack.html">pandas.DataFrame.stack</a></li>
</ol>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-07-12T10:00:00.000Z" title="7/12/2023, 7:00:00 PM">2023-07-12</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2023-07-12T17:37:18.317Z" title="7/13/2023, 2:37:18 AM">2023-07-13</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Programming/">Programming</a><span> / </span><a class="link-muted" href="/categories/Programming/Python/">Python</a></span><span class="level-item">2분안에 읽기 (약 354 단어)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/vscode-language-server-24eec7ce2732/">VSCode 에서 languageserver 확인</a></p><div class="content"><p>VS Code에서 Jupyterlab 3.x를 사용하는데 classic jupyter notebook 에서 가능하던 content assistance 기능이 작동을 하지 않았다. </p>
<h1 id="상황"><a href="#상황" class="headerlink" title="상황"></a>상황</h1><p>Jupyterlab, classic jupyter notebook 에서 가능하던 content assistance 기능으로 속성&#x2F;모듈&#x2F;함수&#x2F;도움말 등의 지원이 가능했다.</p>
<ul>
<li>Jupyterlab에서 노트북 셀의 tab &amp; shift tab</li>
</ul>
<img src="/images/python/vs-jupyter-assistance1.png">
그림>


<p>그런데 Visual studio code 에서 <code>.ipynb</code> 노트북 파일을 열어 사용하면 이런 기능이 안되고 있어서 궁금했다.</p>
<p>구글 검색으로 스택오버플로우에 올라온 기사를 보니 <code>settings.json</code> 을 보면 python language server 설정을 해야 한다고 한다. 현재는 Default 상태로 선택되어 있어서 그렇다고 한다. 그래서 Pylance 를 지정했다.</p>
<img src="/images/python/vs-jupyter-assistance2.png">

<p>languageserver 를 지정하고 재시작한 후 살펴보니 잘 된다.</p>
<img src="/images/python/vs-jupyter-assistance3.png">

<h2 id="Language-Server-extension-이란"><a href="#Language-Server-extension-이란" class="headerlink" title="Language Server extension 이란?"></a>Language Server extension 이란?</h2><p><a target="_blank" rel="noopener" href="https://code.visualstudio.com/api/language-extensions/language-server-extension-guide">language-server-extension-guide</a> 에서 설명한 바로는</p>
<blockquote>
<p>여러 프로그래밍 언어에 대해서 강력한 편집 경험을 제공하고자 한다.</p>
</blockquote>
<p>아래 그림에서 languageserver 의 효과를 설명하고 있다. 왼쪽 같이 LSP 가 없으면 각 편집기에서 직접 언어 엔진을 가동해야 한다. 그런데 오른쪽 깥이 LSP를 사용하면 하나의 서버를 통해서 여러 편집기에서 언어의 특성을 활용할 수 있다는 설명 이다.</p>
<img src='https://code.visualstudio.com/assets/api/language-extensions/language-server-extension-guide/lsp-languages-editors.png' backgrounds="#FFFFFF">
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-07-09T17:00:00.000Z" title="7/10/2023, 2:00:00 AM">2023-07-10</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2023-07-13T09:01:32.428Z" title="7/13/2023, 6:01:32 PM">2023-07-13</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Programming/">Programming</a><span> / </span><a class="link-muted" href="/categories/Programming/Python/">Python</a></span><span class="level-item">9분안에 읽기 (약 1294 단어)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/pandas-numpy-display_format-5e6e2759a37b/">Pandas/Numpy 숫자의 출력 옵션 조정</a></p><div class="content"><p>numpy 와 pandas 에서 수를 출력할 때 형식, 크기 및 범위를 설정할 수 있다. 간단히 보면 아래 테이블 같이 형식을 바꿔준다.</p>
<table>
<thead>
<tr>
<th>column</th>
<th>변환</th>
<th>column</th>
</tr>
</thead>
<tbody><tr>
<td>1e6</td>
<td>precision</td>
<td>1,000,000</td>
</tr>
<tr>
<td>1.1e-6</td>
<td>format</td>
<td>0.1</td>
</tr>
</tbody></table>
<p>아래 요약한 옵션 방법을 사용해서 Numpy 와 Pandas에 있는 숫자를 출력할 때 표현방법, 표기법, 환률, 정밀도 등을 변경해 사용할 수 있다</p>
<h1 id="numpy-출력-형식-변경"><a href="#numpy-출력-형식-변경" class="headerlink" title="numpy 출력 형식 변경"></a>numpy 출력 형식 변경</h1><h2 id="numpy-숫자-출력-형식-변경"><a href="#numpy-숫자-출력-형식-변경" class="headerlink" title="numpy 숫자 출력 형식 변경"></a>numpy 숫자 출력 형식 변경</h2><p><a target="_blank" rel="noopener" href="https://numpy.org/doc/stable/reference/generated/numpy.set_printoptions.html">numpy.set_printoptions</a> 을 사용할 수 있다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">numpy.set_printoptions(precision=<span class="literal">None</span>, threshold=<span class="literal">None</span>, edgeitems=<span class="literal">None</span>, linewidth=<span class="literal">None</span>, suppress=<span class="literal">None</span>,</span><br><span class="line">                       nanstr=<span class="literal">None</span>, infstr=<span class="literal">None</span>, formatter=<span class="literal">None</span>, sign=<span class="literal">None</span>, floatmode=<span class="literal">None</span>, *, legacy=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>

<h3 id="현재-출력형식-확인"><a href="#현재-출력형식-확인" class="headerlink" title="현재 출력형식 확인"></a>현재 출력형식 확인</h3><p><code>np.get_printoptions()</code> 으로 현재 상태를 출력할 수 있다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt; np.get_printoptions()</span><br><span class="line">&#123;<span class="string">&#x27;edgeitems&#x27;</span>: <span class="number">3</span>,</span><br><span class="line"> <span class="string">&#x27;threshold&#x27;</span>: <span class="number">1000</span>,</span><br><span class="line"> <span class="string">&#x27;floatmode&#x27;</span>: <span class="string">&#x27;maxprec&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;precision&#x27;</span>: <span class="number">8</span>,</span><br><span class="line"> <span class="string">&#x27;suppress&#x27;</span>: <span class="literal">False</span>,</span><br><span class="line"> <span class="string">&#x27;linewidth&#x27;</span>: <span class="number">75</span>,</span><br><span class="line"> <span class="string">&#x27;nanstr&#x27;</span>: <span class="string">&#x27;nan&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;infstr&#x27;</span>: <span class="string">&#x27;inf&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;sign&#x27;</span>: <span class="string">&#x27;-&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;formatter&#x27;</span>: <span class="literal">None</span>,</span><br><span class="line"> <span class="string">&#x27;legacy&#x27;</span>: <span class="literal">False</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Numpy 에서 실수 Float 의 출력 형식을 바꾸는 몇가지 사례를 보자</p>
<h3 id="formatter-이용"><a href="#formatter-이용" class="headerlink" title="- formatter 이용"></a>- formatter 이용</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">np.set_printoptions(formatter=&#123;<span class="string">&#x27;float_kind&#x27;</span>: <span class="keyword">lambda</span> x: <span class="string">&quot;&#123;0:0.3f&#125;&quot;</span>.<span class="built_in">format</span>(x)&#125;)</span><br></pre></td></tr></table></figure>



<h3 id="precision-이용"><a href="#precision-이용" class="headerlink" title="- precision 이용"></a>- precision 이용</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; np.set_printoptions(precision=<span class="number">4</span>)</span><br><span class="line">&gt; np.array([<span class="number">1.123456789</span>])</span><br><span class="line">[<span class="number">1.1235</span>]</span><br></pre></td></tr></table></figure>

<h3 id="threshold-이용"><a href="#threshold-이용" class="headerlink" title="- threshold 이용"></a>- threshold 이용</h3><p>개수가 많은 아이템을 출력할 때 요약해 출력할 수 있다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; np.set_printoptions(threshold=<span class="number">5</span>)</span><br><span class="line">&gt; np.arange(<span class="number">10</span>)</span><br><span class="line">array([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, ..., <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>])</span><br></pre></td></tr></table></figure>


<h2 id="numpy-printoptions-사용"><a href="#numpy-printoptions-사용" class="headerlink" title="numpy.printoptions 사용"></a>numpy.printoptions 사용</h2><p><a target="_blank" rel="noopener" href="https://numpy.org/doc/stable/reference/generated/numpy.printoptions.html#numpy.printoptions">numpy.printoptions</a> 를 with 구문과 함께 사용해 제한된 출력 조정을 할 수 있다.</p>
<p>출력시 printoptions 를 with 구문과 사용할 수 있다. set_printoptions 의 인자를 동일하게 적용할 수 있다</p>
<ul>
<li>precision, threshold, edgeitems, linewidth, suppress, nanstr, infstr, formatter, sign, floatmode</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">numpy.printoptions(*args, **kwargs)[source]</span><br></pre></td></tr></table></figure>


<p>소수점 출력 변경</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; np.array([<span class="number">2.0</span>]) / <span class="number">3</span></span><br><span class="line">array([<span class="number">0.66666667</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt; <span class="keyword">with</span> np.printoptions(precision=<span class="number">3</span>):</span><br><span class="line">&gt;    <span class="built_in">print</span>( np.array([<span class="number">2.0</span>]) / <span class="number">3</span> )</span><br></pre></td></tr></table></figure>

<br>

<h1 id="pandas-숫자-출력-형식-변경"><a href="#pandas-숫자-출력-형식-변경" class="headerlink" title="pandas 숫자 출력 형식 변경"></a>pandas 숫자 출력 형식 변경</h1><p>pandas에서 몇 가지 옵션을 바꾸는 방법을 정리해 보자. pandas의  옵션은 pd.options 를 사용한다.</p>
<h2 id="pd-options-display"><a href="#pd-options-display" class="headerlink" title="pd.options.display"></a>pd.options.display</h2><p>출력의 형태, 표기를 변경하는 것은 <code>pd.options.display</code> 아래에 있다. 여기서 사용할 수 있는 옵션은 <code>describe_option()</code> 으로 확인할 수 있다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; pd.describe_option()</span><br><span class="line">compute.use_bottleneck : <span class="built_in">bool</span></span><br><span class="line">    Use the bottleneck library to accelerate <span class="keyword">if</span> it <span class="keyword">is</span> installed,</span><br><span class="line">    the default <span class="keyword">is</span> <span class="literal">True</span></span><br><span class="line">    Valid values: <span class="literal">False</span>,<span class="literal">True</span></span><br><span class="line">    [default: <span class="literal">True</span>] [currently: <span class="literal">True</span>]</span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>

<h3 id="row-column-출력-개수-조정"><a href="#row-column-출력-개수-조정" class="headerlink" title="- row, column 출력 개수 조정"></a>- row, column 출력 개수 조정</h3><ul>
<li><code>pd.options.display.max_rows</code> : 표를 출력할 때 최대 행 수입니다.</li>
<li><code>pd.options.display.min_rows</code> : 표를 출력할 때 최소 행 수입니다.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">&gt; pd.options.display.max_rows</span><br><span class="line"><span class="number">60</span></span><br><span class="line">&gt; pd.options.display.min_rows</span><br><span class="line"><span class="number">10</span></span><br></pre></td></tr></table></figure>

<p><code>min_row</code>, <code>max_row</code>에 직접 대입하면 해당 옵션의 현재 값이 변경된다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; pd.options.display.min_rows=<span class="number">100</span></span><br><span class="line">&gt; pd.options.display.min_rows</span><br><span class="line"><span class="number">100</span></span><br></pre></td></tr></table></figure>

<p><code>max_rows</code>에 값을 입력하면 테이블의 최대 행수를 바꿀 수 있다. </p>
<p><img src='https://miro.medium.com/v2/resize:fit:1400/1*WZssN58WwDaHilhzCE5T2Q.png'><sup> 이미지 참조 <a href="#footnote1">1</a></sup> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; pd.options.display.max_rows = <span class="number">100</span></span><br><span class="line">&gt; pd.options.display.max_rows</span><br><span class="line"><span class="number">100</span></span><br></pre></td></tr></table></figure>


<h3 id="pd-get-option-pd-set-option-함수"><a href="#pd-get-option-pd-set-option-함수" class="headerlink" title="- pd.get_option(), pd.set_option() 함수"></a>- <code>pd.get_option()</code>, <code>pd.set_option()</code> 함수</h3><p><code>pd.get_option()</code> 함수를 이용해서 옵션인자에 대한 정보를 확인할 수 있다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; pd.get_option(<span class="string">&#x27;min_rows&#x27;</span>)</span><br><span class="line"><span class="number">100</span></span><br></pre></td></tr></table></figure>

<p>get_option은 옵션 이름의 일부만 일치해도 된다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; pd.get_option(<span class="string">&#x27;min_r&#x27;</span>)</span><br><span class="line"><span class="number">100</span></span><br></pre></td></tr></table></figure>
<p>max_rows 수를 설정한다. set_option도 일부만 일치해도 된다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; pd.set_option(<span class="string">&#x27;max_rows&#x27;</span>, <span class="number">20</span>)</span><br><span class="line">&gt; pd.options.display.max_rows</span><br><span class="line"><span class="number">20</span></span><br><span class="line">&gt; pd.set_option(<span class="string">&#x27;max_r&#x27;</span>, <span class="number">50</span>)</span><br><span class="line">&gt; pd.options.display.max_rows</span><br><span class="line"><span class="number">50</span></span><br></pre></td></tr></table></figure>


<h3 id="컬럼의-폭-조정"><a href="#컬럼의-폭-조정" class="headerlink" title="- 컬럼의 폭 조정"></a>- 컬럼의 폭 조정</h3><p><code>display.max_colwidth</code> 는 보통 50~70자 정도 정해져 있다. 컬럼에 표시되는 텍스트가 50자가 넘으면 <code>...</code> 줄임 표시가 나타난다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; pd.options.display.max_colwidth</span><br><span class="line"><span class="number">50</span></span><br></pre></td></tr></table></figure>



<h3 id="chop-threshold"><a href="#chop-threshold" class="headerlink" title="- chop_threshold"></a>- chop_threshold</h3><p><code>chop_threshold</code> 는 값의 크기 한계를 지정해서 이 값보다 작은 수는 모두 0으로 표시한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; pd.options.display.chop_threshold = <span class="number">0.99</span></span><br><span class="line">&gt; pd.DataFrame(&#123;<span class="string">&#x27;x&#x27;</span>: [<span class="number">10</span>, <span class="number">1</span>, <span class="number">0.1</span>]&#125;)</span><br><span class="line">&gt; <span class="built_in">print</span>(x)</span><br><span class="line"><span class="number">0</span>	<span class="number">10.0</span></span><br><span class="line"><span class="number">1</span>	<span class="number">1.0</span></span><br><span class="line"><span class="number">2</span>	<span class="number">0.0</span></span><br></pre></td></tr></table></figure>

<h2 id="숫자-포매팅"><a href="#숫자-포매팅" class="headerlink" title="숫자 포매팅"></a>숫자 포매팅</h2><p>다양한 사례는:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://pandas.pydata.org/docs/user_guide/options.html#number-formatting">https://pandas.pydata.org/docs/user_guide/options.html#number-formatting</a></li>
</ul>
<h3 id="float-format"><a href="#float-format" class="headerlink" title="- float_format"></a>- float_format</h3><p><code>float_format</code> 는 실수 값을 출력시 소수점의 출력의 정밀도를 조정할 수 있다. 아래 람다 함수 <code>lambda x: f&#39;&#123;x:.1f&#125;</code> 는 실수 x를 받아 소수점 첫째 자리까지 출력해 준다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; pd.options.display.float_format = <span class="keyword">lambda</span> x: <span class="string">f&#x27;<span class="subst">&#123;x:<span class="number">.1</span>f&#125;</span>&#x27;</span></span><br><span class="line">&gt; pd.DataFrame(&#123;<span class="string">&#x27;x&#x27;</span>: [<span class="number">3.141592</span>]&#125;)</span><br><span class="line">x</span><br><span class="line"><span class="number">0</span>	<span class="number">3.1</span></span><br></pre></td></tr></table></figure>

<p>또한 set_option 을 사용할 수 있다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; pd.set_option(<span class="string">&#x27;display.float_format&#x27;</span>, <span class="string">&#x27;&#123;:.2f&#125;&#x27;</span>.foramt )</span><br></pre></td></tr></table></figure>

<p>금액 단위에 사용하는 천단위 구분을 위해서 <code>&#123;:,.2f&#125;</code>  형식을 사용하면 화폐 단위를 추가하고 천단위 구분자를 추가해 주고 소수점 2자리수 정밀로를 지정한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; pd.set_option(<span class="string">&#x27;display.float_format&#x27;</span>, <span class="string">&#x27;$&#123;:,.2f&#125;&#x27;</span>.<span class="built_in">format</span> )</span><br><span class="line">&gt; pd.DataFrame(&#123;<span class="string">&#x27;x&#x27;</span>: [<span class="number">10000000.0</span>, <span class="number">34589234.4</span>]&#125;)</span><br><span class="line">  x</span><br><span class="line"><span class="number">0</span> $<span class="number">10</span>,<span class="number">000</span>,<span class="number">000.00</span></span><br><span class="line"><span class="number">1</span> $<span class="number">34</span>,<span class="number">589</span>,<span class="number">234.40</span></span><br></pre></td></tr></table></figure>



<h3 id="precision"><a href="#precision" class="headerlink" title="- precision"></a>- precision</h3><p>실수의 소수점은 <code>precision</code> 로 과학적 표기법으로 변환할 자릿수를 지정한다. 아래와 같이 하면 소수점 셋째 자리 밑으로는 과학적 표기법으로 표시합니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; pd.options.display.precision = <span class="number">3</span></span><br><span class="line">&gt; pd.DataFrame(&#123;<span class="string">&#x27;x&#x27;</span>: [<span class="number">0.5</span>], <span class="string">&#x27;y&#x27;</span>: [<span class="number">0.0005</span>]&#125;)</span><br><span class="line">x	y</span><br><span class="line"><span class="number">0</span>	<span class="number">0.5</span>	<span class="number">5.000e-04</span></span><br></pre></td></tr></table></figure>

<p>과학적 표기법으로 3.000e-04는 3.000 이다. 자릿수가 아주 작거나 큰 수를 표기할 때 유용합니다.</p>
<h3 id="설정-초기화-reset-option"><a href="#설정-초기화-reset-option" class="headerlink" title="- 설정 초기화 reset_option()"></a>- 설정 초기화 <code>reset_option()</code></h3><p>설정을 초기화할 때 사용한다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># chop_threshold 옵션 초기화</span></span><br><span class="line">pd.reset_option(<span class="string">&#x27;display.chop_threshold&#x27;</span>)</span><br><span class="line"><span class="comment"># float_format 옵션 초기화</span></span><br><span class="line">pd.reset_option(<span class="string">&#x27;display.float_format&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="옵션-설명-describe-option"><a href="#옵션-설명-describe-option" class="headerlink" title="- 옵션 설명 describe_option()"></a>- 옵션 설명 <code>describe_option()</code></h3><p><code>pd.describe_option(OPTIONS)</code> 를 사용하면 해당 옵션에 대한 설명을 출력해 준다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; pd.describe_option(<span class="string">&quot;max_rows&quot;</span>)</span><br><span class="line">display.max_rows : <span class="built_in">int</span></span><br><span class="line">    If max_rows <span class="keyword">is</span> exceeded, switch to truncate view. Depending on</span><br><span class="line">    `large_repr`, objects are either centrally truncated <span class="keyword">or</span> printed <span class="keyword">as</span></span><br><span class="line">    a summary view. <span class="string">&#x27;None&#x27;</span> value means unlimited.</span><br></pre></td></tr></table></figure>


<h1 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h1><p><a name='footnote1'>1</a>: <a target="_blank" rel="noopener" href="https://pub.towardsai.net/try-these-pandas-display-configurations-in-your-next-analysis-72589648d9a0">Try These Pandas Display Configurations</a></p>
<p><a name='footnote1'>2</a>: <a target="_blank" rel="noopener" href="https://pandas.pydata.org/docs/user_guide/options.html">Pandas options</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-07-09T00:00:00.000Z" title="7/9/2023, 9:00:00 AM">2023-07-09</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2023-07-09T05:31:39.385Z" title="7/9/2023, 2:31:39 PM">2023-07-09</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Programming/">Programming</a><span> / </span><a class="link-muted" href="/categories/Programming/Python/">Python</a></span><span class="level-item">15분안에 읽기 (약 2261 단어)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/python-packaging-start-48993e24137b/">Python - 파이썬 프로젝트 패키징과 배포하기</a></p><div class="content"><p>파이썬에서 작업한 소스를 공개&#x2F;비공개 배포하기 위해서 패키징을 하는 방법을 요약, 정리했다.</p>
<h1 id="파이썬-모듈-배포하기"><a href="#파이썬-모듈-배포하기" class="headerlink" title="파이썬 모듈 배포하기"></a>파이썬 모듈 배포하기</h1><p>이 글은 setuptools, builds 그리고 PyPI 업로드를 위한 twine 를 사용하고 있다.</p>
<h2 id="핵심-용어"><a href="#핵심-용어" class="headerlink" title="[핵심 용어]"></a>[핵심 용어]</h2><ul>
<li><a target="_blank" rel="noopener" href="https://pypi.org/">PyPi, Python Package Index</a>: 파이썬 사용자를 위한 오픈소스 패키지의 공개 저장소 일명 PyPi</li>
<li><a target="_blank" rel="noopener" href="https://www.pypa.io/">PyPa, 파이썬 패키징 위원회</a>: 표준 패키징 도구&#x2F;메타 데이터&#x2F;파일 형식 표준을 GitHub 와 Bitbucket 을 통해서 여러 패키징 도구, 문서, 이슈 추적기를 관리하고 있다.</li>
<li><a target="_blank" rel="noopener" href="https://docs.python.org/ko/3/library/distutils.html#module-distutils">distutils</a>: 1998년&#x2F;파이썬 표준 라이브러리 최초의 빌드 및 배포 시스템. 대부분 직접 사용이 단계적으로 폐지되고 있다.<ul>
<li>distutils는 파이썬 3.10부터 deprecated, 3.12에서 <em><strong>삭제</strong></em>될 예정.</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://setuptools.readthedocs.io/en/latest/">setuptools</a> : 2004 공개&#x2F; distutils 의 드롭인(drop-in) 대체품. distutils 와 큰 차이는 다른 패키지에 대한 의존성을 선언할 수 있다.</li>
<li>[pyproject.toml]: 2016년 setuptools의 메타 파일 setup.py 의존성을 피하고자 독립한 빌드용 선언적 메타정보 파일.</li>
<li><a target="_blank" rel="noopener" href="https://wheel.readthedocs.io/">wheel</a>: distutils&#x2F;setuptools 에 bdist_wheel 명령을 추가하는 프로젝트이다. 파이썬 라이브러리를 바이너리 확장을 포함&#x2F;크로스 플랫폼 바이너리 패키징 형식 지원 (“휠”,”휠 파일”, <a target="_blank" rel="noopener" href="https://peps.python.org/pep-0427/">PEP 427</a> 정의).</li>
</ul>
<h2 id="도구-설치"><a href="#도구-설치" class="headerlink" title="도구 설치"></a>도구 설치</h2><p>setuptools 기반 배포도구 설치</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m pip install setuptools wheel twine</span><br></pre></td></tr></table></figure>


<h2 id="파이썬-패키징"><a href="#파이썬-패키징" class="headerlink" title="파이썬 패키징"></a>파이썬 패키징</h2><p><a target="_blank" rel="noopener" href="https://packaging.python.org/en/latest/tutorials/packaging-projects/">https://packaging.python.org/en/latest/tutorials/packaging-projects/</a> 내용을 요약, 정리, 보충한다.</p>
<h3 id="프로젝트-생성"><a href="#프로젝트-생성" class="headerlink" title="프로젝트 생성"></a>프로젝트 생성</h3><blockquote>
<p>패키징 수행하면 별도의 가상환경을 생성해서 진행한다.</p>
</blockquote>
<p>프로젝트를 패키징하는 과정을 위해서 packaging_tutorial 폴더 아래에 같은 구조를 갖는다.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">packaging_tutorial/</span><br><span class="line">└── src/</span><br><span class="line">    └── example_package_YOUR_USERNAME_HERE/</span><br><span class="line">        ├── __init__.py</span><br><span class="line">        └── example.py</span><br></pre></td></tr></table></figure>

<ul>
<li><code>example_package_YOUR_USERNAME_HERE</code> : 프로젝트 이름이고 중복하지 않게 한다.</li>
<li><code>__init__.py</code> : 빈 파일로 폴더를 패키지로 인식하게 한다.</li>
<li><code>example.py</code> : 모듈.</li>
</ul>
<p> <code>example.py</code> 모듈 소스.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add_one</span>(<span class="params">number</span>):</span><br><span class="line">    <span class="keyword">return</span> number + <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h3 id="패키징용-파일-생성"><a href="#패키징용-파일-생성" class="headerlink" title="패키징용 파일 생성"></a>패키징용 파일 생성</h3><p>배포를 위한 프로젝트의 구성을 위해 패키징에 필요한 파일을 추가한 구조는 아래 같다.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">packaging_tutorial/</span><br><span class="line">├── LICENSE</span><br><span class="line">├── pyproject.toml</span><br><span class="line">├── README.md</span><br><span class="line">└── src/</span><br><span class="line">│   └── example_package_YOUR_USERNAME_HERE/</span><br><span class="line">│       ├── __init__.py</span><br><span class="line">│       └── example.py</span><br><span class="line">└── tests/</span><br></pre></td></tr></table></figure>
<ul>
<li><code>LICENSE</code> : 라이센서 선언</li>
<li><code>pyproject.toml</code> : 프로젝트 배포 프로젝트 생성에 사용하는 프론트엔드 빌드도구 <code>pip</code>, 백엔드 밸드도구 <code>build</code>  </li>
<li><code>README.md</code></li>
<li><code>tests/</code> : 테스트 파일용 공간. Leave it empty for now.</li>
</ul>
<blockquote>
<p>패키징의 프론트엔드, 백엔드는 참조의 5번 항목을 살펴보자.</p>
</blockquote>
<h3 id="pyproject-toml-구성"><a href="#pyproject-toml-구성" class="headerlink" title="pyproject.toml 구성"></a><code>pyproject.toml</code> 구성</h3><p>보통 파일 내용은 아래 항목으로 구성한다. 이 파일은 TOML 형식의 구조를 따르고 있다. 여기에 대해서는 아래 참조 4번 항목 내용을 보기 바란다.</p>
<figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[build-system]</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="section">[project]</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="section">[project.urls]</span></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>빌드 도구를 명시하는 명세서 <code>pyproject.toml</code>에 setuptools 를 사용한 예이다.</p>
<figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[build-system]</span></span><br><span class="line"><span class="attr">requires</span> = [<span class="string">&quot;setuptools&gt;=61.0&quot;</span>]</span><br><span class="line"><span class="attr">build-backend</span> = <span class="string">&quot;setuptools.build_meta&quot;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>requires</code> : 빌드용 도구 지시.</li>
<li><code>build-backend</code> :  프론트엔드 (pip)에서 빌드에 사용하는 백엔드 도구</li>
</ul>
<p>다음은 Hatching 이란 빌드 도구를 사용한 예이다.</p>
<figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[build-system]</span></span><br><span class="line"><span class="attr">requires</span> = [<span class="string">&quot;hatchling&quot;</span>]</span><br><span class="line"><span class="attr">build-backend</span> = <span class="string">&quot;hatchling.build&quot;</span></span><br></pre></td></tr></table></figure>

<p>메타 정보를 포함한 간단한  <code>pyproject.toml</code> 구성 결과.</p>
<figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[build-system]</span></span><br><span class="line"><span class="attr">requires</span> = [<span class="string">&quot;setuptools&gt;=61.0&quot;</span>]</span><br><span class="line"><span class="attr">build-backend</span> = <span class="string">&quot;setuptools.build_meta&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="section">[project]</span></span><br><span class="line"><span class="attr">name</span> = <span class="string">&quot;example_package_YOUR_USERNAME_HERE&quot;</span></span><br><span class="line"><span class="attr">version</span> = <span class="string">&quot;0.0.1&quot;</span></span><br><span class="line"><span class="attr">authors</span> = [</span><br><span class="line">  &#123; name=<span class="string">&quot;Example Author&quot;</span>, email=<span class="string">&quot;author@example.com&quot;</span> &#125;,</span><br><span class="line">]</span><br><span class="line"><span class="attr">description</span> = <span class="string">&quot;A small example package&quot;</span></span><br><span class="line"><span class="attr">readme</span> = <span class="string">&quot;README.md&quot;</span></span><br><span class="line"><span class="attr">requires-python</span> = <span class="string">&quot;&gt;=3.7&quot;</span></span><br><span class="line"><span class="attr">classifiers</span> = [</span><br><span class="line">    <span class="string">&quot;Programming Language :: Python :: 3&quot;</span>,</span><br><span class="line">    <span class="string">&quot;License :: OSI Approved :: MIT License&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Operating System :: OS Independent&quot;</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="section">[project.urls]</span></span><br><span class="line"><span class="attr">&quot;Homepage&quot;</span> = <span class="string">&quot;https://github.com/pypa/sampleproject&quot;</span></span><br><span class="line"><span class="attr">&quot;Bug Tracker&quot;</span> = <span class="string">&quot;https://github.com/pypa/sampleproject/issues&quot;</span></span><br></pre></td></tr></table></figure>

<p>자세한 메타 정보 내역은 <a target="_blank" rel="noopener" href="https://packaging.python.org/en/latest/specifications/declaring-project-metadata/#declaring-project-metadata">프로젝트 메타정보 정의</a>를 참조한다. 주요 메타 정보의 인자:</p>
<ul>
<li><code>[project]</code>:<ul>
<li>requires-python : 패키지가 요구하는 최소 파이썬 버전 명시</li>
<li>classifiers: pip가 인지하는 패키지에 대한 정보</li>
</ul>
</li>
</ul>
<h3 id="README-md-x2F-LICENSE-파일"><a href="#README-md-x2F-LICENSE-파일" class="headerlink" title="README.md &#x2F; LICENSE 파일"></a>README.md &#x2F; LICENSE 파일</h3><p>README.md 파일에 패키지 모듈를 설명한다.</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># Example Package</span></span><br><span class="line"></span><br><span class="line">This is a simple example package. You can use</span><br><span class="line">[<span class="string">Github-flavored Markdown</span>](<span class="link">https://guides.github.com/features/mastering-markdown/</span>)</span><br><span class="line">to write your content.</span><br></pre></td></tr></table></figure>

<p>LICENSE 파일에 저작권을 명시한다.</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Copyright (c) 2018 The Python Packaging Authority</span><br><span class="line"></span><br><span class="line">Permission is hereby granted, free of charge, to any person obtaining a copy</span><br></pre></td></tr></table></figure>

<h2 id="배포-묶음-생성하기"><a href="#배포-묶음-생성하기" class="headerlink" title="배포 묶음 생성하기"></a>배포 묶음 생성하기</h2><p>배포를 위한 build 도구를 설치한다.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m pip install --upgrade build</span><br></pre></td></tr></table></figure>

<p><code>packaging_tutorial</code> 폴더 아래 pyproject.toml 파일이 있는 위치에서 배포를 위한 build 명령으로 소스를 패키징을 한다. </p>
<p>build 를 수행하면 별도의 venv 가상환경을 생성해서 의존성에 명시된 setuptools 등을 설치하고 빌드를 진행한다.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">python3 -m build</span></span><br><span class="line">* Creating venv isolated environment...</span><br><span class="line">* Installing packages in isolated environment... (setuptools&gt;=61.0)</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">removing build\bdist.win-amd64\wheel</span><br><span class="line">Successfully built example_package_YOUR_USERNAME_HERE-0.0.1.tar.gz and example_package_YOUR_USERNAME_HERE-0.0.1-py3-none-any.whl</span><br></pre></td></tr></table></figure>

<p>이 명령의 결과로 <code>dist</code> 폴더에 우리 프로젝트에 대한 배포용 패키징으로 소스 패키징 <code>.gz</code> 파일, built distribution 패키징 <code>.whl</code> 2개의 파일이 생성된다.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dist/</span><br><span class="line">├── example_package_YOUR_USERNAME_HERE-0.0.1-py3-none-any.whl</span><br><span class="line">└── example_package_YOUR_USERNAME_HERE-0.0.1.tar.gz</span><br></pre></td></tr></table></figure>

<h3 id="pip-로-wheeels-설치하기"><a href="#pip-로-wheeels-설치하기" class="headerlink" title="pip 로 wheeels 설치하기"></a>pip 로 wheeels 설치하기</h3><p>pip 에서 built distribution 파일을 직접 설치할 수 있다. <a target="_blank" rel="noopener" href="https://pip.pypa.io/en/stable/user_guide/#installing-from-wheels">installing-from-wheels</a> 참조.</p>
<p>다음은 우리 프로젝트의 wheel 패키징을 설치한다.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m pip install example_package_YOUR_USERNAME_HERE-0.0.1-py3-none-any.whl</span><br></pre></td></tr></table></figure>

<p>혹은 provides_extras 메타 정보를 사용해 추가 설치를 한다면,</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m pip install &#x27;./somepackage-1.0-py2.py3-none-any.whl[my-extras]&#x27;</span><br></pre></td></tr></table></figure>

<h2 id="Upload"><a href="#Upload" class="headerlink" title="Upload"></a>Upload</h2><p>처음 PyPi 에 업로드를 하려면 아래 2가지 단계를 거쳐서 진행해 본다.</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://test.pypi.org/account/register/">https://test.pypi.org/account/register/</a> 에서 등록<ol>
<li>실제 pypi 가 아닌 튜토리얼과 테스트를 위한 곳.</li>
</ol>
</li>
<li>PyPi 업로드를 완성하려면 PyPI API token 을 발급받아야 한다.<ol>
<li><a target="_blank" rel="noopener" href="https://test.pypi.org/manage/account/#api-tokens">https://test.pypi.org/manage/account/#api-tokens</a></li>
</ol>
</li>
</ol>
<p>PyPI에 업로드가 완료되면 pip 를 통해서 패키지를 설치할 수 있다. 업로드를 위해서 Twin 패키지를 설치하고 사용해야 한다.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m pip install --upgrade twine</span><br></pre></td></tr></table></figure>

<p>twine 모듈을 사용해서 dist&#x2F; 아래의 모든 소스&#x2F;휠 패키징 묶음을 업로드할 수 있다. 지금은 <code>testpypi</code> 에 업로드를 해보자.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m twine upload --repository testpypi dist/*</span><br></pre></td></tr></table></figure>
<ul>
<li>업로드시 username은  <code>__token__</code> 사용.</li>
<li>패스워드는 발급받은 <code>pypi-</code> 으로 시작하는 token 값.</li>
</ul>
<p>업로드 진행은 아래 같을 것이다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Uploading distributions to https://test.pypi.org/legacy/</span><br><span class="line">Enter your username: __token__</span><br><span class="line">Uploading example_package_YOUR_USERNAME_HERE-0.0.1-py3-none-any.whl</span><br><span class="line">100% ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 8.2/8.2 kB • 00:01 • ?</span><br><span class="line">Uploading example_package_YOUR_USERNAME_HERE-0.0.1.tar.gz</span><br><span class="line">100% ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 6.8/6.8 kB • 00:00 • ?</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>여기서 repository로 testpypi 를 지정했으므로 업로드한 결과는 다음 같이 확인할 수 있다.</p>
<ul>
<li><code>https://test.pypi.org/project/example_package_YOUR_USERNAME_HERE</code></li>
</ul>
<h3 id="저장소에서-설치하기"><a href="#저장소에서-설치하기" class="headerlink" title="저장소에서 설치하기"></a>저장소에서 설치하기</h3><p>위에 testpypi 에 업로드한 패키지를 설치하려면 아래 같이 <code>--index-url</code> 로 저장소를 지정해서 사용한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m pip install --index-url https://test.pypi.org/simple/ --no-deps example-package-YOUR-USERNAME-HERE</span><br></pre></td></tr></table></figure>

<h3 id="PyPI-에-업로드"><a href="#PyPI-에-업로드" class="headerlink" title="PyPI 에 업로드"></a>PyPI 에 업로드</h3><p>마지막으로 실제 패키지를 PyPI에 업로드하려면 <a target="_blank" rel="noopener" href="https://pypi.org/">https://pypi.org</a> 등록을 하고, 등록한 사용자 아이디를 사용하고 <code>--repository</code> 인자를 제외하고 업로드하면 된다.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m twine upload dist/*</span><br></pre></td></tr></table></figure>

<h2 id="통합-메타-정보로서-pyproject-toml-활용"><a href="#통합-메타-정보로서-pyproject-toml-활용" class="headerlink" title="통합 메타 정보로서 pyproject.toml 활용"></a>통합 메타 정보로서 <code>pyproject.toml</code> 활용</h2><p>테스트, 코드 포맷팅 등에 대한 정보로 활용한다. 대표적으로는 코드 포맷팅 도구인 black, 테스트용 프레임워크인 pytest 등이 pyproject.toml에 설정 값을 저장하고 있다 - <a target="_blank" rel="noopener" href="https://ryanking13.github.io/2021/07/11/python-packaging.html">파이썬 패키징의 역사, blog</a></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># pyproject.toml of black</span><br><span class="line"><span class="punctuation">[</span>tool.black<span class="punctuation">]</span></span><br><span class="line">line-length = <span class="number">88</span></span><br><span class="line">target-version = <span class="punctuation">[</span>&#x27;py36&#x27;<span class="punctuation">,</span> &#x27;py37&#x27;<span class="punctuation">,</span> &#x27;py38&#x27;<span class="punctuation">]</span></span><br><span class="line">include = &#x27;\.pyi?$&#x27;</span><br></pre></td></tr></table></figure>

<h1 id="다음"><a href="#다음" class="headerlink" title="다음"></a>다음</h1><p>이후에 다른 빌드 도구들, 테스트 도구들을 다뤄보자.</p>
<ul>
<li>poetry: <ul>
<li><a target="_blank" rel="noopener" href="https://velog.io/@hj8853/Poetry%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EC%97%AC-%EA%B0%80%EC%83%81%ED%99%98%EA%B2%BD-%EB%A7%8C%EB%93%A4%EA%B8%B0">Poetry를-사용하여-가상환경-만들기</a></li>
<li><a target="_blank" rel="noopener" href="https://mixedprograming.tistory.com/35">poetry를 사용한 파이썬 dependency관리</a></li>
</ul>
</li>
</ul>
<h1 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h1><ol>
<li><a target="_blank" rel="noopener" href="https://docs.python.org/ko/3/distributing/index.html">파이썬 모듈 배포하기, python.org</a></li>
<li><a target="_blank" rel="noopener" href="https://packaging.python.org/en/latest/guides/tool-recommendations/">Tool recommendations, python.org</a><ol>
<li>주요 패키징에 필요한 도구 안내</li>
</ol>
</li>
<li><a target="_blank" rel="noopener" href="https://ryanking13.github.io/2021/07/11/python-packaging.html">파이썬 패키징의 역사, blog</a></li>
<li><a target="_blank" rel="noopener" href="https://www.itworld.co.kr/news/248128">TOML의 이해와 기본 활용, itworld</a></li>
<li><a target="_blank" rel="noopener" href="https://devocean.sk.com/blog/techBoardDetail.do?ID=164866&boardType=techBlog">Python package의 build frontend 와 backend</a></li>
</ol>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-06-25T06:00:00.000Z" title="6/25/2023, 3:00:00 PM">2023-06-25</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2023-06-26T02:08:40.970Z" title="6/26/2023, 11:08:40 AM">2023-06-26</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Programming/">Programming</a><span> / </span><a class="link-muted" href="/categories/Programming/git/">git</a></span><span class="level-item">14분안에 읽기 (약 2046 단어)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/bitbucket-ssh_key%EB%93%B1%EB%A1%9D-131a9df6053f/">bitbuket 에 SSH key 등록하기</a></p><div class="content"><p>github, bitbucket 같은 클라우드 사이트에 Client 프로그램으로 SSH 접속을 위해서는 SSH 키 쌍 생성하고 클라우드 사이트에 등록해야 한다. 보통 github, bitbucket 등 같은 SSH 접근을 지원하는 사이트는 ssh-agent forwarding 방식을 사용한다.</p>
<img src='https://miro.medium.com/v2/resize:fit:934/1*pWygndnde0yNc-B8G8lg_g.png' width=600>

<ol>
<li>클라이언트에서 ssh 키 쌍을 생성</li>
<li>클라이언트에 개인키를 ssh-agent 에 등록</li>
<li>클라우드 서비스에 공개키를 등록</li>
<li>클라이언트 프로그램에서 ssh 사용시 ssh-agent 등록한 개인키로 암호화</li>
</ol>
<p>여기서는 bitbucket 을 예로 들고 있다. </p>
<ul>
<li><a target="_blank" rel="noopener" href="https://support.atlassian.com/bitbucket-cloud/docs/configure-ssh-and-two-step-verification/">https://support.atlassian.com/bitbucket-cloud/docs/configure-ssh-and-two-step-verification/</a></li>
</ul>
<p>과정은 bitbucket 을 예로 들었지만 github 도 유사한 과정을 거친다. github에서 Key 등록에 대해서는 링크를 참조한다. <a href="/2023/05/20/Programming/github-ssh_key%EB%93%B1%EB%A1%9D/">github 에 SSH key 등록하기</a></p>
<br>

<h1 id="SSH-구성과-2단계-인증"><a href="#SSH-구성과-2단계-인증" class="headerlink" title="SSH 구성과 2단계 인증"></a>SSH 구성과 2단계 인증</h1><p>Git Credential Manager (GCM) 를 git client 에서 bitbucket 에 접속해 사용하는데 이용할 수 있다. SSH 구성을 하지 않고 bitbucket 을 사용하려면 GCM 을 사용하면 된다. <a target="_blank" rel="noopener" href="https://github.com/git-ecosystem/git-credential-manager#git-credential-manager">Git Credential Manager</a></p>
<p>단, GCM works over HTTPS, not SSH. 그래서 <code>git clone https://&#123;username&#125;@bitbucket.org/&#123;workspace&#125;/&#123;repository&#125;.git</code> 이렇게 요청해야 한다.</p>
<p>설명에 따라서 먼저 ssh host key 를 생성하고 bitbucket 에서 사용하는 개인용 ssh key 를 만든다. 이후 bitbucket 에 등록하면 된다.</p>
<h2 id="SSH-Client-Keys"><a href="#SSH-Client-Keys" class="headerlink" title="SSH Client Keys"></a>SSH Client Keys</h2><p>저장소에 접근하는 url은 HTTPS or SSH 에 따라 달라진다.</p>
<ol>
<li>HTTPS</li>
</ol>
<p><code>https://&lt;repo_owner&gt;@bitbucket.org/&lt;accountname&gt;/&lt;reponame&gt;.git</code></p>
<ol start="2">
<li>SSH</li>
</ol>
<p><code>git@bitbucket.org:&lt;repo_owner&gt;/&lt;reponame&gt;.git</code></p>
<p>or </p>
<p><code>ssh://git@bitbucket.org/&lt;repo_owner&gt;/&lt;reponame&gt;.git</code></p>
<p>bitbucket은 암호 알고리즘으로 keys: Ed25519, ECDSA, RSA, and DSA 를 지원한다.</p>
<p>예를 들어 아래 같이 생성한 공개키를 사용할 수 있다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Ed25519 (ed25519) / 256</span></span><br><span class="line">$ ssh-keygen -t ed25519 -b 256</span><br><span class="line"></span><br><span class="line"><span class="comment"># ECDSA (ecdsa) / 256</span></span><br><span class="line">$ ssh-keygen -t ecdsa -b 256</span><br><span class="line"></span><br><span class="line"><span class="comment"># RSA (rsa) / 2048</span></span><br><span class="line">$ ssh-keygen -t rsa -b 2048</span><br><span class="line"></span><br><span class="line"><span class="comment"># DSA / DSS (dsa) / 1024</span></span><br><span class="line">$ ssh-keygen -t dsa -b 1024</span><br></pre></td></tr></table></figure>

<h2 id="SSH-Host-Key-생성"><a href="#SSH-Host-Key-생성" class="headerlink" title="SSH Host Key 생성"></a>SSH Host Key 생성</h2><p>아래는 bitbucket 서버의 공개키 이다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">256 SHA256:FC73VB6C4OQLSCrjEayhMp9UMxS97caD/Yyi2bhW/J0 bitbucket.org (ECDSA)</span><br><span class="line">256 SHA256:ybgmFkzwOSotHTHLJgHO0QN8L0xErw6vd0VhFA9m3SM bitbucket.org (ED25519)</span><br><span class="line">2048 SHA256:46OSHA1Rmj8E8ERTC6xkNcmGOw9oFxYr0WF6zWW8l1E bitbucket.org (RSA)</span><br></pre></td></tr></table></figure>

<p>해당 공개키가 적적할지 확인은 다음 같이 curl 로 테스트해볼 수 있다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://bitbucket.org/site/ssh</span><br></pre></td></tr></table></figure>


<h2 id="개별키-생성"><a href="#개별키-생성" class="headerlink" title="개별키 생성"></a>개별키 생성</h2><p>ssh 를 사용해서 bitbucket 클라우드에 접근하려면 사용하는 클라이언트에서 SSH 로 개인키와 공개키를 생성해야 한다. SSH 키를 생성하려면 아래 과정이 필요하다.</p>
<ol>
<li>Open SSH 설치</li>
<li>SSH 서비스</li>
<li>SSH 키 생성</li>
</ol>
<p>여기서 Linux&#x2F;macOS 그리고 Windows 11 에서 키 쌍을 생성해서 bitbucket에 등록하는 과정을 살펴보겠다.</p>
<br>

<h1 id="Windows-11에서-키-생성"><a href="#Windows-11에서-키-생성" class="headerlink" title="Windows 11에서 키 생성"></a>Windows 11에서 키 생성</h1><p>Windows 11 에서 Git 이 설치되어 있다고 가정.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">get-command</span> git</span><br><span class="line"></span><br><span class="line">Application     git.exe                                            <span class="number">2.38</span>.<span class="number">1.1</span>   C:\Program Files\Git\cmd\git.exe</span><br></pre></td></tr></table></figure>

<p>Openssh 확인</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; ssh <span class="literal">-V</span></span><br><span class="line">OpenSSH_for_Windows_8.<span class="number">6</span>p1, LibreSSL <span class="number">3.4</span>.<span class="number">3</span></span><br></pre></td></tr></table></figure>

<p>ssh 명령 위치 확인</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">Get-Command</span> ssh</span><br></pre></td></tr></table></figure>

<p>결과 ssh 명령을 git config 로 ssh 명령을 지정</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config <span class="literal">--global</span> core.sshCommand C:/Windows/System32/OpenSSH/ssh.exe</span><br></pre></td></tr></table></figure>

<h2 id="SSH-agent-시작"><a href="#SSH-agent-시작" class="headerlink" title="SSH agent 시작"></a>SSH agent 시작</h2><p>git 이 ssh 키를 사용하려면 SSH agent 가 시작되어야 한다. 보통 Git for windows 와 Windows 11 이후 Windows OpenSSH 를 사용하므로</p>
<p>Windows OpenSSH 사용자는 다음 같이 agent를 확인하고 시작한다.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">Get-Service</span> ssh<span class="literal">-agent</span></span><br><span class="line"></span><br><span class="line">Status   Name               DisplayName</span><br><span class="line"><span class="literal">------</span>   <span class="literal">----</span>               <span class="literal">-----------</span></span><br><span class="line">Stopped  ssh<span class="literal">-agent</span>          OpenSSH Authentication Agent</span><br></pre></td></tr></table></figure>

<p>ssh-agent 서비스를 시작 하려면 Windows service에서 OpenSSH Authenticate Agent 서비스를 시작해 두어야 한다.</p>
<img src='https://i.imgur.com/UlidUNe.png'>

<p>속성에서 시작으로 한다.</p>
<img src='https://i.imgur.com/mHNWVfS.png' width=300>

<p>서비스가 정상적으로 시작되면 아래 명령으로 시작&#x2F;종료 그리고 재시작을 할 수 있다. - 시작 안되어 있으면 알수없는 에러가 난다.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">Start-Service</span> ssh<span class="literal">-agent</span></span><br></pre></td></tr></table></figure>

<p><strong>Git for windows</strong> 를 사용하면 Git for windows의 bash 터미널 에서 다음 같이 확인하고 시작한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ps -a | grep ssh-agent</span><br></pre></td></tr></table></figure>

<p>ssh-agent 를 시작한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">eval</span> $(ssh-agent)</span><br></pre></td></tr></table></figure>

<p>에이젼트가 시작되면 git client 에서 ssh 정보를 얻을 수 있다.</p>
<h2 id="bitbucket에-사용할-SSH-key-pair를-생성"><a href="#bitbucket에-사용할-SSH-key-pair를-생성" class="headerlink" title="bitbucket에 사용할 SSH key pair를 생성"></a>bitbucket에 사용할 SSH key pair를 생성</h2><p>ssh-keygen.exe로 키 쌍, 비밀키&#x2F;공개키를 생성한다. 키를 생성시 bitbucket 계정의 e-mail 을 포함해 생성한다. 생성시 사용자 홈 디렉토리 <code>.ssh</code> 디렉토리에서 작업한다.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; ssh<span class="literal">-keygen</span>.exe <span class="literal">-t</span> rsa <span class="literal">-b</span> <span class="number">4096</span> <span class="literal">-C</span> <span class="string">&quot;EMAIL&quot;</span> <span class="operator">-f</span> <span class="string">&quot;KEY_FILE&quot;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>EMAIL: bitbucket 계정 이메일</li>
<li>KEY_FILE: 파일 이름. 보통 bitbucket_work</li>
</ul>
<p><code>.ssh</code> 디렉토리에 키 쌍 KEY_FILE 과 KEY_FILE.pub 이 생성된다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt; dir .ssh</span><br><span class="line"></span><br><span class="line">    Directory: C:\Users\daddy\.ssh</span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name</span><br><span class="line">----                 -------------         ------ ----</span><br><span class="line">-a---        2023-06-25  오후 6:11           3381 bitbucket_work</span><br><span class="line">-a---        2023-06-25  오후 6:11            744 bitbucket_work.pub</span><br><span class="line">-a---        2020-11-08 오전 12:12           1675 id_rsa</span><br><span class="line">-a---        2020-11-08 오전 12:12            404 id_rsa.pub</span><br></pre></td></tr></table></figure>

<p>이제 키를 SSH Agent 에 등록하자.</p>
<h2 id="SSH-Agent-에-키-등록"><a href="#SSH-Agent-에-키-등록" class="headerlink" title="SSH Agent 에 키 등록"></a>SSH Agent 에 키 등록</h2><p>키 파일을 SSH Agent 에 등록한다. KEY_FILE 은 비밀키 파일을 지정하면 된다.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; ssh<span class="literal">-add</span> ~/.ssh/KEY_FILE</span><br></pre></td></tr></table></figure>

<p>그리고 명확하게 bitbucket 에 해당 키를 사용하도록 <code>~/.ssh/config</code> 에 아래 같이 등록한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Host bitbucket.org</span><br><span class="line">  AddKeysToAgent yes</span><br><span class="line">  IdentityFile ~/.ssh/KEY_FILE</span><br></pre></td></tr></table></figure>

<br>

<h1 id="macOS-x2F-Linux"><a href="#macOS-x2F-Linux" class="headerlink" title="macOS &#x2F; Linux"></a>macOS &#x2F; Linux</h1><p>Openssh 확인</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -V</span><br><span class="line">OpenSSH_8.2p1 macOS, OpenSSL 1.1.1f  31 Mar 2020</span><br></pre></td></tr></table></figure>

<p>ssh 명령이 없으면 macOS는 brew 로 설치한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ brew install openssh</span><br></pre></td></tr></table></figure>

<p>Linux 는 apt, dnf, pacman 을 사용해 설치한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt update &amp;&amp; sudo apt install openssh-client</span><br></pre></td></tr></table></figure>


<h2 id="SSH-agent-시작-1"><a href="#SSH-agent-시작-1" class="headerlink" title="SSH agent 시작"></a>SSH agent 시작</h2><p>git 에서 ssh 키를 사용하려면 SSH agent 가 시작한다. bash 터미널 에서 다음 같이 확인하고 시작한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ps -a | grep ssh-agent</span><br></pre></td></tr></table></figure>

<p>ssh-agent 를 시작한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">eval</span> $(ssh-agent)</span><br></pre></td></tr></table></figure>

<p>이 명령을 <code>~/.bashrc</code>, <code>~/.zshrc</code>, <code>~/.profile,</code> 등에 등록해 둔다. 에이젼트가 시작되면 git client 에서 ssh 정보를 얻을 수 있다.</p>
<h2 id="bitbucket에-사용할-SSH-key-pair를-생성-1"><a href="#bitbucket에-사용할-SSH-key-pair를-생성-1" class="headerlink" title="bitbucket에 사용할 SSH key pair를 생성"></a>bitbucket에 사용할 SSH key pair를 생성</h2><p>ssh-keygen.exe로 키 쌍, 비밀키&#x2F;공개키를 생성한다. </p>
<ul>
<li>키를 생성시 bitbucket 계정의 e-mail 을 포함해 생성한다. </li>
<li>사용자 홈 디렉토리 <code>.ssh</code> 디렉토리에서 작업한다.</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -t rsa -b 4096 -C <span class="string">&quot;EMAIL&quot;</span> -f <span class="string">&quot;KEY_FILE&quot;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>EMAIL: bitbucket 계정 이메일</li>
<li>KEY_FILE: 파일 이름. 보통 bitbucket_work</li>
</ul>
<p><code>.ssh</code> 디렉토리에 키 쌍 KEY_FILE 과 KEY_FILE.pub 이 생성된다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ ls -l .ssh</span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name</span><br><span class="line">----                 -------------         ------ ----</span><br><span class="line">-a---        2023-06-25  오후 6:11           3381 bitbucket_work</span><br><span class="line">-a---        2023-06-25  오후 6:11            744 bitbucket_work.pub</span><br><span class="line">-a---        2020-11-08 오전 12:12           1675 id_rsa</span><br><span class="line">-a---        2020-11-08 오전 12:12            404 id_rsa.pub</span><br></pre></td></tr></table></figure>

<p>이제 키 쌍를 SSH Agent 에 등록하자.</p>
<h2 id="SSH-Agent-에-키-등록-1"><a href="#SSH-Agent-에-키-등록-1" class="headerlink" title="SSH Agent 에 키 등록"></a>SSH Agent 에 키 등록</h2><p>키 파일을 SSH Agent 에 등록한다. KEY_FILE 은 비밀키 파일을 지정하면 된다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-add ~/.ssh/KEY_FILE</span><br></pre></td></tr></table></figure>

<p>그리고 명확하게 bitbucket 에 해당 키를 사용하도록 <code>~/.ssh/config</code> 에 아래 같이 등록한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Host bitbucket.org</span><br><span class="line">  AddKeysToAgent yes</span><br><span class="line">  IdentityFile ~/.ssh/KEY_FILE</span><br></pre></td></tr></table></figure>


<br>

<h1 id="Bitbucket-Cloud-with-your-public-key"><a href="#Bitbucket-Cloud-with-your-public-key" class="headerlink" title="Bitbucket Cloud with your public key"></a>Bitbucket Cloud with your public key</h1><p>bitbucket 을 위해 생성한 키 쌍에서 공개키 KEY_FILE.pub 를 bitbucket 의 계정에 등록해 주어야 한다.</p>
<ol>
<li>Settings -&gt; Personal Settings</li>
</ol>
<img src='https://i.imgur.com/Dq7WZEa.png' width=400>

<ol start="2">
<li>Secutiry -&gt; SSH Keys -&gt; Add key</li>
</ol>
<p>생성한 키 쌍에서 <code>bitbucket_work.pub</code> 같이 공개키를 등록하는데, 공개키 파일 내용을 복사해 붙여넣기를 하면 된다.</p>
<img src='https://i.imgur.com/fDjTbVe.png' >

<p>cat 명령 등으로 내용을 복사한다.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">cat</span> .\.ssh\bitbucket_work.pub</span><br><span class="line">ssh<span class="literal">-rsa</span> AAAAB3NzaC1yc2EAAAADAQABAAACAQDo+<span class="number">7</span>VGfxlhxFsy0Edu+PPmqngJVzwLQuLPanOi5x8t2yu7RmFNlEfU32AgA7vkoLno98XFZaUZ3ZjMwVu7LWeLMNczx5nH//</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">+v7ttamzvFe8idOtCjJszG5l8rn4poIN2E24AWGvCGbzs55WRXY/amYEqP5/maH0NT+pYM2ZMV7Nt8Jb86iQ== james@thinkbee.kr</span><br></pre></td></tr></table></figure>

<p>사이트의 Add key 창에 붙여 넣는다.</p>
<img src='https://i.imgur.com/ntPiVPG.png'>

<p>이제 새 SSH 키가 등록되었다.</p>
<img src='https://i.imgur.com/0A7DkJm.png'>

<p>클라이언트에서 bitbucket 에 SSH 접속이 가능한지 테스트한다. 단, 모든 SSH 연결은 최초 접속시 호스트 접속 여부를 묻는다. 아래 같이 bitbucket.org 접속시 접속 여부를 묻는 다이얼로그가 나온다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -T git@bitbucket.org</span><br><span class="line">The authenticity of host <span class="string">&#x27;bitbucket.org (104.192.141.1)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ED25519 key fingerprint is SHA256:ybgmFkzwOSotHTHLJgHO0QN8L0xErw6vd0VhFA9m3SM.</span></span><br><span class="line"><span class="string">This key is not known by any other names</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>bitbucket.org<span class="string">&#x27; (ED25519) to the list of known hosts.</span></span><br><span class="line"><span class="string">authenticated via ssh key.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">You can use git to connect to Bitbucket. Shell access is disabled</span></span><br></pre></td></tr></table></figure>

<p>결과적으로 아래 같이 결과가 출력되면 성공한 상태다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">authenticated via ssh key.</span><br><span class="line"></span><br><span class="line">You can use git to connect to Bitbucket. Shell access is disabled</span><br></pre></td></tr></table></figure>

<p>이제 git 클라이언트에서 <code>HTTPS</code>, <code>SSH</code> 를 통해서 bitbucket 과 ssh 연결이 가능하다. git 클라이언트로 push, pull 등을 수행할 수 있다.</p>
<hr>
<h1 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h1><ol>
<li><a target="_blank" rel="noopener" href="https://support.atlassian.com/bitbucket-cloud/docs/configure-ssh-and-two-step-verification/">https://support.atlassian.com/bitbucket-cloud/docs/configure-ssh-and-two-step-verification/</a></li>
<li><a href="/2023/05/20/Programming/github-ssh_key%EB%93%B1%EB%A1%9D/">github 에 SSH key 등록하기</a></li>
</ol>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-05-20T01:00:00.000Z" title="5/20/2023, 10:00:00 AM">2023-05-20</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2023-06-26T02:09:11.390Z" title="6/26/2023, 11:09:11 AM">2023-06-26</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Programming/">Programming</a><span> / </span><a class="link-muted" href="/categories/Programming/git/">git</a></span><span class="level-item">13분안에 읽기 (약 1908 단어)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/github-ssh_key%EB%93%B1%EB%A1%9D-654a33b9f5e1/">github 에 SSH key 등록하기</a></p><div class="content"><p>github, bitbucket 같은 클라우드 사이트에 Client 프로그램으로 SSH 접속을 위해서는 SSH 키 쌍 생성하고 클라우드 사이트에 등록해야 한다.</p>
<p>보통 github, bitbucket 등 같은 SSH 접근을 지원하는 사이트는 ssh-agent forwarding 방식을 사용한다.</p>
<img src='https://miro.medium.com/v2/resize:fit:934/1*pWygndnde0yNc-B8G8lg_g.png' width=600>

<ol>
<li>클라이언트에서 ssh 키 쌍을 생성</li>
<li>클라이언트에 개인키를 ssh-agent 에 등록</li>
<li>클라우드 서비스에 공개키를 등록</li>
<li>클라이언트 프로그램에서 ssh 사용시 ssh-agent 등록한 개인키로 암호화</li>
</ol>
<p>여기서는 github 에 ssh key 등록 과정을 요약하고 있다. </p>
<ul>
<li><a target="_blank" rel="noopener" href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh/about-ssh">Connect with SSH</a></li>
<li>github을 예로 들었지만 bitbucket 도 유사한 과정을 거친다.</li>
<li><a href="/2023/06/25/Programming/bitbucket-ssh_key%EB%93%B1%EB%A1%9D/">bitbucket 에 SSH key 등록하기</a></li>
</ul>
<br>

<h1 id="SSH-구성과-SSH-인증"><a href="#SSH-구성과-SSH-인증" class="headerlink" title="SSH 구성과 SSH 인증"></a>SSH 구성과 SSH 인증</h1><p>먼저 ssh host key 를 생성하고 github 과 사용할 개인 key 를 만든다. 개인키를 ssh-agent 방식으로 등록하고 공개키를 github 에 등록하면 된다.</p>
<h2 id="ssh-agent-키-관리"><a href="#ssh-agent-키-관리" class="headerlink" title="ssh-agent 키 관리"></a>ssh-agent 키 관리</h2><p>로컬 머신에서 사용하는 SSH Key 쌍에 대한 접근을 ssh-agent 를 통해서 진행한다. <a target="_blank" rel="noopener" href="https://docs.github.com/ko/authentication/connecting-to-github-with-ssh/managing-deploy-keys">managing deploy keys</a> 에 설명되어 있다.</p>
<ul>
<li>에이전트 전달은 로컬 개발 컴퓨터에서 사용하는 것과 동일한 SSH 키를 사용합니다.</li>
<li>단 사용자 클라이언트에 SSH에 있어야 합니다</li>
</ul>
<h2 id="SSH-Client-Keys"><a href="#SSH-Client-Keys" class="headerlink" title="SSH Client Keys"></a>SSH Client Keys</h2><p>저장소에 접근하는 url은 HTTPS or SSH 에 따라 달라진다.</p>
<ol>
<li>HTTPS</li>
</ol>
<p><code>https://&lt;repo_owner&gt;@github.com/&lt;accountname&gt;/&lt;reponame&gt;.git</code></p>
<ol start="2">
<li>SSH</li>
</ol>
<p><code>git@github.com:&lt;repo_owner&gt;/&lt;reponame&gt;.git</code></p>
<p>or </p>
<p><code>ssh://git@github.com/&lt;repo_owner&gt;/&lt;reponame&gt;.git</code></p>
<p>github은 암호 알고리즘으로 keys: Ed25519, ECDSA, RSA, and DSA 를 지원한다.</p>
<p>예를 들어 아래 같이 생성한 공개키를 사용할 수 있다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Ed25519 (ed25519) / 256</span></span><br><span class="line">$ ssh-keygen -t ed25519 -b 256</span><br><span class="line"></span><br><span class="line"><span class="comment"># ECDSA (ecdsa) / 256</span></span><br><span class="line">$ ssh-keygen -t ecdsa -b 256</span><br><span class="line"></span><br><span class="line"><span class="comment"># RSA (rsa) / 2048</span></span><br><span class="line">$ ssh-keygen -t rsa -b 4096</span><br></pre></td></tr></table></figure>


<h2 id="개별키-생성"><a href="#개별키-생성" class="headerlink" title="개별키 생성"></a>개별키 생성</h2><p>ssh 를 사용해서 github 에 접근하려면 사용하는 클라이언트에서 SSH 로 개인키와 공개키를 생성해야 한다. SSH 키를 생성하려면 아래 과정이 필요하다.</p>
<ol>
<li>Open SSH 설치</li>
<li>SSH 서비스</li>
<li>SSH 키 생성</li>
</ol>
<p>여기서 Linux&#x2F;macOS 그리고 Windows 11 에서 키 쌍을 생성해서 github에 SSH Key를 등록하는 과정을 살펴보겠다.</p>
<br>

<h1 id="Windows-11에서-키-생성"><a href="#Windows-11에서-키-생성" class="headerlink" title="Windows 11에서 키 생성"></a>Windows 11에서 키 생성</h1><p>Windows 11 에서 Git 이 설치되어 있다고 가정.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">get-command</span> git</span><br><span class="line"></span><br><span class="line">Application     git.exe                                            <span class="number">2.38</span>.<span class="number">1.1</span>   C:\Program Files\Git\cmd\git.exe</span><br></pre></td></tr></table></figure>

<p>Openssh 확인</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; ssh <span class="literal">-V</span></span><br><span class="line">OpenSSH_for_Windows_8.<span class="number">6</span>p1, LibreSSL <span class="number">3.4</span>.<span class="number">3</span></span><br></pre></td></tr></table></figure>

<p>ssh 명령 위치 확인</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">Get-Command</span> ssh</span><br></pre></td></tr></table></figure>

<p>결과 ssh 명령을 git config 로 ssh 명령을 지정</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config <span class="literal">--global</span> core.sshCommand C:/Windows/System32/OpenSSH/ssh.exe</span><br></pre></td></tr></table></figure>

<h2 id="SSH-agent-시작"><a href="#SSH-agent-시작" class="headerlink" title="SSH agent 시작"></a>SSH agent 시작</h2><p>git 이 ssh 키를 사용하려면 SSH agent 가 시작되어야 한다. 보통 Git for windows 와 Windows 11 이후 Windows OpenSSH 를 사용하므로</p>
<p>Windows OpenSSH 사용자는 다음 같이 agent를 확인하고 시작한다.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">Get-Service</span> ssh<span class="literal">-agent</span></span><br><span class="line"></span><br><span class="line">Status   Name               DisplayName</span><br><span class="line"><span class="literal">------</span>   <span class="literal">----</span>               <span class="literal">-----------</span></span><br><span class="line">Stopped  ssh<span class="literal">-agent</span>          OpenSSH Authentication Agent</span><br></pre></td></tr></table></figure>

<p>ssh-agent 서비스를 시작 하려면 Windows service에서 OpenSSH Authenticate Agent 서비스를 시작해 두어야 한다.</p>
<img src='https://i.imgur.com/UlidUNe.png'>

<p>속성에서 시작으로 한다.</p>
<img src='https://i.imgur.com/mHNWVfS.png' width=300>

<p>서비스가 정상적으로 시작되면 아래 명령으로 시작&#x2F;종료 그리고 재시작을 할 수 있다. - 시작 안되어 있으면 알수없는 에러가 난다.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">Start-Service</span> ssh<span class="literal">-agent</span></span><br></pre></td></tr></table></figure>

<p><strong>Git for windows</strong> 를 사용하면 Git for windows의 bash 터미널 에서 다음 같이 확인하고 시작한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ps -a | grep ssh-agent</span><br></pre></td></tr></table></figure>

<p>ssh-agent 를 시작한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">eval</span> $(ssh-agent)</span><br></pre></td></tr></table></figure>

<p>에이젼트가 시작되면 git client 에서 ssh 정보를 얻을 수 있다.</p>
<h2 id="github에서-사용할-SSH-key-pair를-생성"><a href="#github에서-사용할-SSH-key-pair를-생성" class="headerlink" title="github에서 사용할 SSH key pair를 생성"></a>github에서 사용할 SSH key pair를 생성</h2><p>ssh-keygen.exe로 키 쌍, 비밀키&#x2F;공개키를 생성한다. 키를 생성시 bitbucket 계정의 e-mail 을 포함해 생성한다. 생성시 사용자 홈 디렉토리 <code>.ssh</code> 디렉토리에서 작업한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; ssh-keygen.exe -t ed25519  -b 4096 -C <span class="string">&quot;EMAIL&quot;</span> -f <span class="string">&quot;KEY_FILE&quot;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>EMAIL: github 계정 이메일</li>
<li>KEY_FILE: 파일 이름. 보통 bitbucket_work</li>
</ul>
<blockquote>
<p>참고: Ed25519 알고리즘을 지원하지 않는 레거시 시스템을 사용하는 경우 다음을 사용합니다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;$ ssh-keygen -t rsa -b 4096 -C <span class="string">&quot;EMAIL&quot;</span> -f <span class="string">&quot;KEY_FILE&quot;</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p><code>.ssh</code> 디렉토리에 키 쌍 KEY_FILE 과 KEY_FILE.pub 이 생성된다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt; dir .ssh</span><br><span class="line"></span><br><span class="line">    Directory: C:\Users\daddy\.ssh</span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name</span><br><span class="line">----                 -------------         ------ ----</span><br><span class="line">-a---        2023-06-25  오후 6:11           3381 bitbucket_work</span><br><span class="line">-a---        2023-06-25  오후 6:11            744 bitbucket_work.pub</span><br><span class="line">-a---        2020-11-08 오전 12:12           1675 id_rsa</span><br><span class="line">-a---        2020-11-08 오전 12:12            404 id_rsa.pub</span><br></pre></td></tr></table></figure>

<p>이제 키를 SSH Agent 에 등록하자.</p>
<h2 id="SSH-Agent-에-키-등록"><a href="#SSH-Agent-에-키-등록" class="headerlink" title="SSH Agent 에 키 등록"></a>SSH Agent 에 키 등록</h2><p>키 파일을 SSH Agent 에 등록한다. KEY_FILE 은 비밀키 파일을 지정하면 된다.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; ssh<span class="literal">-add</span> ~/.ssh/KEY_FILE</span><br></pre></td></tr></table></figure>

<p>그리고 명확하게 github 에 해당 키를 사용하도록 <code>~/.ssh/config</code> 에 아래 같이 등록한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Host github.com</span><br><span class="line">  AddKeysToAgent yes</span><br><span class="line">  IdentityFile ~/.ssh/KEY_FILE</span><br></pre></td></tr></table></figure>

<br>

<h1 id="macOS-x2F-Linux"><a href="#macOS-x2F-Linux" class="headerlink" title="macOS &#x2F; Linux"></a>macOS &#x2F; Linux</h1><p>Openssh 확인</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -V</span><br><span class="line">OpenSSH_8.2p1 macOS, OpenSSL 1.1.1f  31 Mar 2020</span><br></pre></td></tr></table></figure>

<p>ssh 명령이 없으면 macOS는 brew 로 설치한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ brew install openssh</span><br></pre></td></tr></table></figure>

<p>Linux 는 apt, dnf, pacman 을 사용해 설치한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt update &amp;&amp; sudo apt install openssh-client</span><br></pre></td></tr></table></figure>


<h2 id="SSH-agent-시작-1"><a href="#SSH-agent-시작-1" class="headerlink" title="SSH agent 시작"></a>SSH agent 시작</h2><p>git 에서 ssh 키를 사용하려면 SSH agent 가 시작한다. bash 터미널 에서 다음 같이 확인하고 시작한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ps -a | grep ssh-agent</span><br></pre></td></tr></table></figure>

<p>ssh-agent 를 시작한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">eval</span> $(ssh-agent)</span><br></pre></td></tr></table></figure>

<p>이 명령을 <code>~/.bashrc</code>, <code>~/.zshrc</code>, <code>~/.profile,</code> 등에 등록해 둔다. 에이젼트가 시작되면 git client 에서 ssh 정보를 얻을 수 있다.</p>
<h2 id="github에-사용할-SSH-key-pair를-생성"><a href="#github에-사용할-SSH-key-pair를-생성" class="headerlink" title="github에 사용할 SSH key pair를 생성"></a>github에 사용할 SSH key pair를 생성</h2><p>ssh-keygen.exe로 키 쌍, 비밀키&#x2F;공개키를 생성한다. </p>
<ul>
<li>키를 생성시 bitbucket 계정의 e-mail 을 포함해 생성한다. </li>
<li>사용자 홈 디렉토리 <code>.ssh</code> 디렉토리에서 작업한다.</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -t rsa -b 4096 -C <span class="string">&quot;EMAIL&quot;</span> -f <span class="string">&quot;KEY_FILE&quot;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>EMAIL: bitbucket 계정 이메일</li>
<li>KEY_FILE: 파일 이름. 보통 bitbucket_work</li>
</ul>
<blockquote>
<p>참고: Ed25519 알고리즘을 지원하지 않는 레거시 시스템을 사용하는 경우 다음을 사용합니다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;$ ssh-keygen -t rsa -b 4096 -C <span class="string">&quot;EMAIL&quot;</span> -f <span class="string">&quot;KEY_FILE&quot;</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p><code>.ssh</code> 디렉토리에 키 쌍 KEY_FILE 과 KEY_FILE.pub 이 생성된다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ ls -l .ssh</span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name</span><br><span class="line">----                 -------------         ------ ----</span><br><span class="line">-a---        2023-06-25  오후 6:11           3381 bitbucket_work</span><br><span class="line">-a---        2023-06-25  오후 6:11            744 bitbucket_work.pub</span><br><span class="line">-a---        2020-11-08 오전 12:12           1675 id_rsa</span><br><span class="line">-a---        2020-11-08 오전 12:12            404 id_rsa.pub</span><br></pre></td></tr></table></figure>

<p>이제 키 쌍를 SSH Agent 에 등록하자.</p>
<h2 id="SSH-Agent-에-키-등록-1"><a href="#SSH-Agent-에-키-등록-1" class="headerlink" title="SSH Agent 에 키 등록"></a>SSH Agent 에 키 등록</h2><p>키 파일을 SSH Agent 에 등록한다. KEY_FILE 은 비밀키 파일을 지정하면 된다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-add ~/.ssh/KEY_FILE</span><br></pre></td></tr></table></figure>

<p>그리고 명확하게 bitbucket 에 해당 키를 사용하도록 <code>~/.ssh/config</code> 에 아래 같이 등록한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Host github.com</span><br><span class="line">  AddKeysToAgent yes</span><br><span class="line">  IdentityFile ~/.ssh/KEY_FILE</span><br></pre></td></tr></table></figure>


<br>

<h1 id="github-에-public-key-등록하기"><a href="#github-에-public-key-등록하기" class="headerlink" title="github 에 public key 등록하기"></a>github 에 public key 등록하기</h1><p>github 계정의 SSH and GPG keys에서 등록해 주어야 한다. 키 쌍 중 공개키 KEY_FILE.pub 내용을 등록해 준다.</p>
<ol>
<li>Settings -&gt; Personal Settings</li>
</ol>
<img src='https://i.imgur.com/RGgEsIq.png' width=400>
' >

<p>cat 명령 등으로 내용을 복사한다. 사이트의 Add key 창에 붙여 넣는다.</p>
<img src='https://i.imgur.com/RVOEj5A.png' width=400>


<p>클라이언트에서 github SSH 접속이 가능한지 테스트한다. 단, 모든 SSH 연결은 최초 접속시 호스트 접속시 접속 여부를 묻는 다이얼로그가 나온다. </p>
<ul>
<li><a target="_blank" rel="noopener" href="https://docs.github.com/ko/authentication/connecting-to-github-with-ssh/testing-your-ssh-connection">https://docs.github.com/ko/authentication/connecting-to-github-with-ssh/testing-your-ssh-connection</a></li>
</ul>
<p>결과적으로 아래 같이 결과가 출력되면 성공한 상태다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ $ ssh -T git@github.com</span><br><span class="line"></span><br><span class="line">Hi USER! You<span class="string">&#x27;ve successfully authenticated, but GitHub does not provide shell access.</span></span><br></pre></td></tr></table></figure>

<p>이제 git 클라이언트에서 <code>HTTPS</code>, <code>SSH</code> 를 통해서 github 과 ssh 연결이 가능하다. git 클라이언트로 push, pull 등을 수행할 수 있다.</p>
<hr>
<h1 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h1><ol>
<li><a target="_blank" rel="noopener" href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh/about-ssh">Connect with SSH, github</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.github.com/ko/authentication/connecting-to-github-with-ssh/testing-your-ssh-connection">SSH 연결 테스트, github</a></li>
<li><a href="/2023/06/25/Programming/bitbucket-ssh_key%EB%93%B1%EB%A1%9D/">bitbucket 에 SSH key 등록하기</a></li>
</ol>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-05-14T12:00:00.000Z" title="5/14/2023, 9:00:00 PM">2023-05-14</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2023-06-20T02:39:28.664Z" title="6/20/2023, 11:39:28 AM">2023-06-20</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Programming/">Programming</a><span> / </span><a class="link-muted" href="/categories/Programming/Python/">Python</a></span><span class="level-item">1분안에 읽기 (약 223 단어)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/jupyterlab_extension_build_npm_error-1b7523ac01f3/">Jupyterlab 의 extension 을 설치하고 build 시 npm 에러.</a></p><div class="content"><p>jupyterlab 의 확장 모듈을 다운받아 설치시 nodejs 실행 환경이 제공되야 한다.</p>
<h1 id="jupyterlab-확장-build-error"><a href="#jupyterlab-확장-build-error" class="headerlink" title="jupyterlab 확장 build error"></a>jupyterlab 확장 build error</h1><p>jupyterlab 의 확장 모듈을 다운받아 설치하다 보면 npm 과 연계한 프로그램이 많다. 아래 같은 nodejs 관련 에러를 발생한다.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">daddy&gt; jupyter lab build</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">An error occurred.</span><br><span class="line">RuntimeError: npm dependencies failed to install</span><br><span class="line">See the log file <span class="keyword">for</span> details:  C:\Users\USERID\AppData\Local\Temp\jupyterlab<span class="literal">-debug-4kr1lkn1</span>.log</span><br></pre></td></tr></table></figure>

<p>결론으로 현재 jupyterlab 을 실행하는 환경에서</p>
<ol>
<li>nodejs 버전이 설치되어 있고</li>
<li>jupyterlab extensions가 활성화 되어 있다면</li>
</ol>
<p>해당 로그 파일을 확인해 보면 대부분 nodejs 버전이 일치하지 않아서 아래 같은 로그를 기록하고 있어 보인다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">error readable-stream@4.3.0: The engine &quot;node&quot; is incompatible with this module. Expected version &quot;^12.22.0 || ^14.17.0 || &gt;=16.0.0&quot;. Got &quot;14.15.0&quot;</span><br><span class="line">error Found incompatible module.</span><br></pre></td></tr></table></figure>

<p><u>nodejs 버전을 업그레이드</u> 하고 빌드를 수행하니 잘 된다.</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-05-14T00:00:00.000Z" title="5/14/2023, 9:00:00 AM">2023-05-14</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2023-11-02T00:29:33.846Z" title="11/2/2023, 9:29:33 AM">2023-11-02</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Programming/">Programming</a><span> / </span><a class="link-muted" href="/categories/Programming/Database/">Database</a></span><span class="level-item">8분안에 읽기 (약 1153 단어)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/mysql-admin-cli-c4134cfe1788/">MySqLI CLI 주요 명령</a></p><div class="content"><p>mysql CLI 에서 MySQL&#x2F;MariaDB 관리자로서 사용할 수 있는 명령을 요약한다. </p>
<ul>
<li>create user, grant, drop, delete, remove …</li>
</ul>
<h1 id="MySqLI-CLI-Client-로-접속하기"><a href="#MySqLI-CLI-Client-로-접속하기" class="headerlink" title="MySqLI CLI Client 로 접속하기"></a>MySqLI CLI Client 로 접속하기</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql [-h서버] -u아이디 -p 데이터베이스명</span><br></pre></td></tr></table></figure>


<h2 id="데이터베이스-스키마"><a href="#데이터베이스-스키마" class="headerlink" title="데이터베이스 스키마"></a>데이터베이스 스키마</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> DATABASES;</span><br></pre></td></tr></table></figure>


<p>use 명령을 사용하여 사용할 데이터베이스&#x2F;스키마를 선택</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> USE TESTDB;</span><br></pre></td></tr></table></figure>

<p>선택된 데이터베이스 안의 테이블 확인</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> TABLES;</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> TABLES <span class="keyword">LIKE</span> <span class="string">&#x27;t%&#x27;</span>; # t로 시작하는 테이블</span><br></pre></td></tr></table></figure>


<p>특정 스키마 혹은 테이블의 생성 쿼리를 출력</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> <span class="keyword">CREATE</span> DATABSE SAKILA;</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> STUDENTS;</span><br></pre></td></tr></table></figure>


<h2 id="데이터베이스의-생성-및-삭제"><a href="#데이터베이스의-생성-및-삭제" class="headerlink" title="데이터베이스의 생성 및 삭제"></a>데이터베이스의 생성 및 삭제</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> DATABASE testdb <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci;</span><br></pre></td></tr></table></figure>
<ul>
<li>utf8_general_ci 는 대소문자를 구분하지 않는다. </li>
<li>대소문자를 구분하려면 binary 타입으로 지정. 예) “utf8_bin”</li>
</ul>
<p>캐릭터셋과 COLLATE 를 생략하면 서버 설치시 지정한 기본 값으로 설정</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> DATABASE testdb;</span><br></pre></td></tr></table></figure>
<p>스키마 제거 </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">DROP</span> [SCHEMA]DATABASE testdb;</span><br></pre></td></tr></table></figure>





<h2 id="시스템-환경-확인"><a href="#시스템-환경-확인" class="headerlink" title="시스템 환경 확인"></a>시스템 환경 확인</h2><p>서버의 환경 변수</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 모든 변수</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> VARIABLES;</span><br></pre></td></tr></table></figure>

<p>DBMS 버전</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> @<span class="variable">@version</span>;       <span class="comment">-- DBMS version</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;version&#x27;</span>;</span><br></pre></td></tr></table></figure>


<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;innodb_%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>지원하는 문자세트 구성</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> <span class="type">CHARACTER</span> <span class="keyword">SET</span>;</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="keyword">LIKE</span> <span class="string">&#x27;utf%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>문자세트 확인</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 환경변수에서 확인</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;c%&#x27;</span>;</span><br></pre></td></tr></table></figure>


<p>지원하는 콜레이션</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> <span class="keyword">COLLATION</span>;</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> <span class="keyword">COLLATION</span> <span class="keyword">WHERE</span> Charset <span class="operator">=</span> <span class="string">&#x27;utf8mb4&#x27;</span>;</span><br></pre></td></tr></table></figure>




<h2 id="외부-파일-실행하기"><a href="#외부-파일-실행하기" class="headerlink" title="외부 파일 실행하기"></a>외부 파일 실행하기</h2><p>첫 번째는 mysql cli 에 지정하여 실행하는 방법</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ mysql -u dbuser -p testdb &lt; insert.sql</span><br><span class="line"></span><br><span class="line">Enter password: ****</span><br></pre></td></tr></table></figure>
<p>두 번째 방법을 mysql cli에서 source 명령을 사용</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> SOURCE C:\Users\USERID\insert.sql;</span><br></pre></td></tr></table></figure>



<br>
<br>

<h1 id="User-amp-Privileges"><a href="#User-amp-Privileges" class="headerlink" title="User &amp; Privileges"></a>User &amp; Privileges</h1><h2 id="사용자-db"><a href="#사용자-db" class="headerlink" title="사용자 db"></a>사용자 db</h2><p>mysql 스키마의 user 테이블을 사용한다.</p>
<p>SELECT Host,User,plugin,authentication_string FROM mysql.user;</p>
<h2 id="사용자-추가"><a href="#사용자-추가" class="headerlink" title="사용자 추가"></a>사용자 추가</h2><p>사용자를 생성시 호스트 주소에 ‘%’, ‘localhost’로 호스트 범위를 지정한다</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;USERID&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;password&#x27;</span>;</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;USERID&#x27;</span>@<span class="string">&#x27;%&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;password&#x27;</span>;</span><br><span class="line">mysql<span class="operator">&gt;</span> FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>

<h2 id="grant-명령-권한-부여"><a href="#grant-명령-권한-부여" class="headerlink" title="grant 명령: [권한 부여]"></a>grant 명령: <strong>[권한 부여]</strong></h2><p>사용자가 특정 자원에 접근하기 위해서  grant 명령 사용. </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> PRIVILEGES <span class="keyword">ON</span> DB이름.테이블이름 <span class="keyword">TO</span> 아이디@호스트 IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;비밀번호&#x27;</span> <span class="keyword">with</span> <span class="keyword">grant</span> option;</span><br><span class="line"></span><br><span class="line">    <span class="operator">-</span> <span class="keyword">ALL</span> PRIVILEGES : 모든 권한 추가 </span><br><span class="line">    <span class="operator">-</span> <span class="keyword">SELECT</span>, <span class="keyword">INSERT</span>, <span class="keyword">UPDATE</span>, <span class="keyword">DELETE</span>, ... : 권한을 일부분을 추가 </span><br><span class="line">    <span class="operator">-</span> <span class="keyword">with</span> <span class="keyword">grant</span> option : <span class="keyword">GRANT</span>를 사용할 수 있는 권한 추가 </span><br><span class="line">    <span class="operator">-</span> <span class="keyword">Grant</span> 로 주어지는 권한은 여기 [<span class="keyword">grant</span>: privilege<span class="operator">-</span>levels](https:<span class="operator">/</span><span class="operator">/</span>mariadb.com<span class="operator">/</span>kb<span class="operator">/</span>en<span class="operator">/</span><span class="keyword">grant</span><span class="operator">/</span>#privilege<span class="operator">-</span>levels) 명령에서 찾을 수 있다.</span><br></pre></td></tr></table></figure>


<p>아래는 userid 사용자가 특정 sampledb 에만 모든 권한을 부여하고 있다.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">GRANT</span> <span class="keyword">ALL</span> PRIVILEGES <span class="keyword">ON</span> sampledb.<span class="operator">*</span> <span class="keyword">TO</span> <span class="string">&#x27;USERID&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line">mysql<span class="operator">&gt;</span> FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>

<p>다음 GRANT 명령에서 <code>ALL PRIVILEGES ON *.*</code> 는  모든 권한(ALL PRIVILEGES)을 모든 스카마의 모든 테이블 <code>*.*</code> 에 준다는 의미. </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">GRANT</span> <span class="keyword">ALL</span> PRIVILEGES <span class="keyword">ON</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">TO</span> <span class="string">&#x27;USERID&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> <span class="keyword">WITH</span> <span class="keyword">GRANT</span> OPTION;</span><br><span class="line">mysql<span class="operator">&gt;</span> FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>WITH GRANT OPTION</code> 의 의미는 다른 사용자에게 자신이 가진 권한을 주거나 회수할 수 있다는 의미.</li>
<li><code>ALL PRIVILEGES</code> 부분에는 SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, INDEX, ALTER 등 권한 명칭을 콤마로 분리해서 나열하는 방식으로 특정 권한만을 줄 수도 있다.</li>
</ul>
<h3 id="권한-제거"><a href="#권한-제거" class="headerlink" title="[권한 제거]"></a><strong>[권한 제거]</strong></h3><p>권한을 없앨때는 REVOKE 명령을 사용한다. 두가지 형식을 사용한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">REVOKE priv_type ON db.tables FROM user[,user]  ...</span><br><span class="line"></span><br><span class="line">REVOKE ALL PRIVILEGES, GRANT OPTION FROM user [, user] ...</span><br></pre></td></tr></table></figure>

<p>아래 명령으로 ‘localhost’ 에서 접속가능한 ‘testdbuser’ 에게서 모든 권한을 제외한다.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">REVOKE</span> <span class="keyword">ALL</span> PRIVILEGES <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">FROM</span> <span class="string">&#x27;USERID&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>GRANT 명령과는 달리 <code>REVOKE</code> 명령은 모든 권한을 제거해도 mysql.user 테이블 사용자 정보는 완전히 삭제되지 않는다. </p>
<p>사용자 정보의 완전한 제거를 원한다면 DROP USER 명령을 사용한다.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">DROP</span> <span class="keyword">USER</span> <span class="string">&#x27;USERID&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br></pre></td></tr></table></figure>



<h2 id="권한-조회"><a href="#권한-조회" class="headerlink" title="권한 조회"></a>권한 조회</h2><p>사용자별 권한 확인</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> GRANTS <span class="keyword">FOR</span> <span class="string">&#x27;USERID&#x27;</span>@<span class="string">&#x27;HOST&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>접속된 계정 권한 확인</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> GRANTS <span class="keyword">FOR</span> <span class="built_in">CURRENT_USER</span>;</span><br></pre></td></tr></table></figure>

<br>
<br>

<h2 id="실행-프로세스-확인"><a href="#실행-프로세스-확인" class="headerlink" title="실행 프로세스 확인"></a>실행 프로세스 확인</h2><p>현재 접속자를 확인하고, lock 이 걸린 프로세스를 죽이거나 하는 작업</p>
<ul>
<li>프로세스 리스트보기</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> PROCESSLIST;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+-----------+----------------------+-----------+---------+------+---------------------------------+------------------------------------------------------------------------------------------------------+----------+</span></span><br><span class="line"><span class="operator">|</span> Id   <span class="operator">|</span> <span class="keyword">User</span>      <span class="operator">|</span> Host                 <span class="operator">|</span> db        <span class="operator">|</span> Command <span class="operator">|</span> <span class="type">Time</span> <span class="operator">|</span> State                           <span class="operator">|</span> Info</span><br><span class="line">                                                                    <span class="operator">|</span> Progress <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+-----------+----------------------+-----------+---------+------+---------------------------------+------------------------------------------------------------------------------------------------------+----------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1371</span> <span class="operator">|</span> dbkmart <span class="operator">|</span> <span class="number">205.22</span><span class="number">.168</span><span class="number">.143</span>:<span class="number">29762</span> <span class="operator">|</span> yourdb <span class="operator">|</span> Sleep   <span class="operator">|</span> <span class="number">2673</span> <span class="operator">|</span>                                 <span class="operator">|</span> <span class="keyword">NULL</span></span><br><span class="line">                                                                    <span class="operator">|</span>    <span class="number">0.000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span></span><br></pre></td></tr></table></figure>

<ul>
<li>프로세스 죽이기(프로세스 아이디는  리스트에 나오는 Id.)</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> kill 프로세스아이디</span><br></pre></td></tr></table></figure>


<h2 id="ex-DB-생성해-사용자-추가"><a href="#ex-DB-생성해-사용자-추가" class="headerlink" title="ex: DB 생성해 사용자 추가"></a>ex: DB 생성해 사용자 추가</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1. mysql/mariadb 데이터베이스 생성</span></span><br><span class="line"><span class="keyword">create</span> database webdb;</span><br><span class="line">	</span><br><span class="line"><span class="comment">-- 2. mysql/mariadb 계정 생성</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> <span class="string">&#x27;webdb&#x27;</span>@<span class="string">&#x27;192.168.1.%&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;webdb&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. 권한주기</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">all</span> privileges <span class="keyword">on</span> webdb.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;webdb&#x27;</span>@<span class="string">&#x27;192.168.1.%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 4. flush privileges;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 5. 사용자 계정 삭제</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">user</span> <span class="string">&#x27;webdb&#x27;</span>@<span class="string">&#x27;192.168.1.%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 6. 데이터베이스 삭제</span></span><br><span class="line"><span class="keyword">drop</span> database webdb;</span><br></pre></td></tr></table></figure>


<h1 id="—"><a href="#—" class="headerlink" title="—"></a>—</h1><ol>
<li><a name='footnote1'>grant: privilege-levels</a> : <a target="_blank" rel="noopener" href="https://mariadb.com/kb/en/grant/#privilege-levels">https://mariadb.com/kb/en/grant/#privilege-levels</a></li>
</ol>
</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/categories/Programming/">이전</a></div><div class="pagination-next"><a href="/categories/Programming/page/3/">다음</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/categories/Programming/">1</a></li><li><a class="pagination-link is-current" href="/categories/Programming/page/2/">2</a></li><li><a class="pagination-link" href="/categories/Programming/page/3/">3</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/categories/Programming/page/9/">9</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/images/qkboo_400.png" alt="Gangtai"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Gangtai</p><p class="is-size-6 is-block">Your title</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Paju, South Korea</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">포스트</p><a href="/archives"><p class="title">158</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">카테고리</p><a href="/categories"><p class="title">17</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">태그</p><a href="/tags"><p class="title">236</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/thinkbee" target="_blank" rel="noopener">팔로우</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/thinkbee"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/gangtaigoh"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">최근 글</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-10-25T00:40:00.000Z">2023-10-25</time></p><p class="title"><a href="/git-swallow-branch-e1aedce9cb6d/">[git] Swallow clone 과 브랜치</a></p><p class="categories"><a href="/categories/Programming/">Programming</a> / <a href="/categories/Programming/git/">git</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-10-21T00:00:00.000Z">2023-10-21</time></p><p class="title"><a href="/mariadb-json_datatype-4ec2cb4ce08f/">MariaDB - json_datatype 사용</a></p><p class="categories"><a href="/categories/Programming/">Programming</a> / <a href="/categories/Programming/Database/">Database</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-10-20T05:40:00.000Z">2023-10-20</time></p><p class="title"><a href="/git-clone-swallow-010171f10347/">[git] Swallow clone</a></p><p class="categories"><a href="/categories/Programming/">Programming</a> / <a href="/categories/Programming/git/">git</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-10-04T05:00:00.000Z">2023-10-04</time></p><p class="title"><a href="/understranding_unicode-f121f811ea9f/">유니코드 이해하기</a></p><p class="categories"><a href="/categories/Programming/">Programming</a> / <a href="/categories/Programming/Python/">Python</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-07-27T12:00:00.000Z">2023-07-27</time></p><p class="title"><a href="/jupyterlab_upgrade_3_to_4-10265c5617ef/">Jupyterlab 4 업그레이드 주의 사항.</a></p><p class="categories"><a href="/categories/Programming/">Programming</a> / <a href="/categories/Programming/Python/">Python</a></p></div></article></div></div><div class="card widget" data-type="adsense"><div class="card-content"><div class="menu"><h3 class="menu-label">광고</h3><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-1465716454138955" data-ad-slot="4441624809" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">카테고리</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/AI/"><span class="level-start"><span class="level-item">AI</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/ETC/"><span class="level-start"><span class="level-item">ETC</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/IT/"><span class="level-start"><span class="level-item">IT</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/OS/"><span class="level-start"><span class="level-item">OS</span></span><span class="level-end"><span class="level-item tag">52</span></span></a><ul><li><a class="level is-mobile" href="/categories/OS/Linux/"><span class="level-start"><span class="level-item">Linux</span></span><span class="level-end"><span class="level-item tag">28</span></span></a></li><li><a class="level is-mobile" href="/categories/OS/Raspberry-Pi/"><span class="level-start"><span class="level-item">Raspberry Pi</span></span><span class="level-end"><span class="level-item tag">21</span></span></a></li><li><a class="level is-mobile" href="/categories/OS/Windows/"><span class="level-start"><span class="level-item">Windows</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Programming/"><span class="level-start"><span class="level-item">Programming</span></span><span class="level-end"><span class="level-item tag">85</span></span></a><ul><li><a class="level is-mobile" href="/categories/Programming/Android/"><span class="level-start"><span class="level-item">Android</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/Angularjs/"><span class="level-start"><span class="level-item">Angularjs</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/C-C/"><span class="level-start"><span class="level-item">C/C++</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/Database/"><span class="level-start"><span class="level-item">Database</span></span><span class="level-end"><span class="level-item tag">19</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/Nodejs/"><span class="level-start"><span class="level-item">Nodejs</span></span><span class="level-end"><span class="level-item tag">20</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/Python/"><span class="level-start"><span class="level-item">Python</span></span><span class="level-end"><span class="level-item tag">27</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/R/"><span class="level-start"><span class="level-item">R</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/git/"><span class="level-start"><span class="level-item">git</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/github/"><span class="level-start"><span class="level-item">github</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li></ul></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/images/thinkbee_logo.png" alt="IT Tech blogging" height="28"></a><p class="is-size-7"><span>&copy; 2024 Gangtai Goh</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("ko");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="맨 위로" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-right",
        content: {
          message: "이 웹 사이트는 귀하의 경험을 향상시키기 위해 Cookie를 사용합니다.",
          dismiss: "무시",
          allow: "허용",
          deny: "거부",
          link: "더 알아보기",
          policy: "Cookie 정책",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="입력 하세요..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"입력 하세요...","untitled":"(제목 없음)","posts":"포스트","pages":"페이지","categories":"카테고리","tags":"태그"});
        });</script></body></html>